"use strict";(globalThis.webpackChunk_croquet_microverse=globalThis.webpackChunk_croquet_microverse||[]).push([[469],{8011:(it,rt,ot)=>{if(Object.defineProperty(rt,"__esModule",{value:!0}),void 0===globalThis.TextEncoder){globalThis.TextEncoder=function(){},TextEncoder.prototype.encode=function(t){for(var e,n=t.length,i=-1,r="undefined"==typeof Uint8Array?new Array(1.5*n):new Uint8Array(3*n),s=0,o=0;o!==n;){if(s=t.charCodeAt(o),o+=1,55296<=s&&s<=56319){if(o===n){r[i+=1]=239,r[i+=1]=191,r[i+=1]=189;break}if(!(56320<=(e=t.charCodeAt(o))&&e<=57343)){r[i+=1]=239,r[i+=1]=191,r[i+=1]=189;continue}if(o+=1,65535<(s=1024*(s-55296)+e-56320+65536)){r[i+=1]=240|s>>>18,r[i+=1]=128|s>>>12&63,r[i+=1]=128|s>>>6&63,r[i+=1]=128|63&s;continue}}s<=127?r[i+=1]=0|s:(s<=2047?r[i+=1]=192|s>>>6:(r[i+=1]=224|s>>>12,r[i+=1]=128|s>>>6&63),r[i+=1]=128|63&s)}return"undefined"!=typeof Uint8Array?r.subarray(0,i+1):(r.length=i+1,r)},TextEncoder.prototype.toString=function(){return"[object TextEncoder]"};try{Object.defineProperty(TextEncoder.prototype,"encoding",{get:function(){if(TextEncoder.prototype.isPrototypeOf(this))return"utf-8";throw TypeError("Illegal invocation")}})}catch(e){TextEncoder.prototype.encoding="utf-8"}"undefined"!=typeof Symbol&&(TextEncoder.prototype[Symbol.toStringTag]="TextEncoder")}function e(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function t(n){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e(Object(i),!0).forEach(function(t){!function c(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n,i,r,s,o){try{var a=t[s](o),c=a.value}catch(t){return n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function i(o){return function(){var t=this,s=arguments;return new Promise(function(e,n){var i=o.apply(t,s);function a(t){r(i,e,n,a,c,"next",t)}function c(t){r(i,e,n,a,c,"throw",t)}a(void 0)})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function f(t,e,n){return(f=h()?Reflect.construct:function(t,e,n){var i=[null],e=(i.push.apply(i,e),new(Function.bind.apply(t,i)));return n&&d(e,n.prototype),e}).apply(null,arguments)}function m(t){var e="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return f(t,arguments,u(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,t)}(t)}function b(n){var i=h();return function(){var t,e=u(n);return function y(t,e){if(!e||"object"!=typeof e&&"function"!=typeof e){if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(e=t))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}(this,i?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function v(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Z(t,e){return L(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}(t,e)||G(t,e)||S()}function X(t){return L(t)||x(t)||G(t)||S()}function w(t){return function(t){if(Array.isArray(t))return k(t)}(t)||x(t)||G(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t){if(Array.isArray(t))return t}function x(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function G(t,e){var n;if(t)return"string"==typeof t?k(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(t,e){var n,i,r,s,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return r=!(i=!0),{s:function(){o=o.call(t)},n:function(){var t=o.next();return i=t.done,t},e:function(t){r=!0,n=t},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw n}}};if(Array.isArray(t)||(o=G(t))||e&&t&&"number"==typeof t.length)return o&&(t=o),s=0,{s:e=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var ut="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==ot.g?ot.g:"undefined"!=typeof self?self:{},mt=function(o){var c,t=Object.prototype,h=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},s=e.iterator||"@@iterator",a=e.asyncIterator||"@@asyncIterator",m=e.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(o){l=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r,s,o,a,e=e&&e.prototype instanceof b?e:b,e=Object.create(e.prototype),i=new C(i||[]);return e._invoke=(r=t,s=n,o=i,a=p,function(t,e){if(a===y)throw new Error("Generator is already running");if(a===Z){if("throw"===t)throw e;return Y()}for(o.method=t,o.arg=e;;){var n=o.delegate;if(n){n=function k(t,e){var n=t.iterator[e.method];if(n===c){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=c,k(t,e),"throw"===e.method))return w;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}n=d(n,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,w;n=n.arg;return n?n.done?(e[t.resultName]=n.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=c),e.delegate=null,w):n:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,w)}(n,o);if(n){if(n===w)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(a===p)throw a=Z,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a=y;n=d(r,s,o);if("normal"===n.type){if(a=o.done?Z:f,n.arg===w)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(a=Z,o.method="throw",o.arg=n.arg)}}),e}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=u;var p="suspendedStart",f="suspendedYield",y="executing",Z="completed",w={};function b(){}function v(){}function g(){}var e={},X=(l(e,s,function(){return this}),Object.getPrototypeOf),X=X&&X(X(T([]))),L=(X&&X!==t&&h.call(X,s)&&(e=X),g.prototype=b.prototype=Object.create(e));function x(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function G(a,c){var t;this._invoke=function(r,s){function i(){return new c(function(t,e){!function r(t,e,i,s){var o,t=d(a[t],a,e);if("throw"!==t.type)return(e=(o=t.arg).value)&&"object"===n(e)&&h.call(e,"__await")?c.resolve(e.__await).then(function(t){r("next",t,i,s)},function(t){r("throw",t,i,s)}):c.resolve(e).then(function(t){o.value=t,i(o)},function(t){return r("throw",t,i,s)});s(t.arg)}(r,s,t,e)})}return t=t?t.then(i,i):i()}}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function W(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(t){if(t){var e,i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return e=-1,(i=function n(){for(;++e<t.length;)if(h.call(t,e))return n.value=t[e],n.done=!1,n;return n.value=c,n.done=!0,n}).next=i}return{next:Y}}function Y(){return{value:c,done:!0}}return l(L,"constructor",v.prototype=g),l(g,"constructor",v),v.displayName=l(g,m,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,m,"GeneratorFunction")),t.prototype=Object.create(L),t},o.awrap=function(t){return{__await:t}},x(G.prototype),l(G.prototype,a,function(){return this}),o.AsyncIterator=G,o.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var s=new G(u(t,e,n,i),r);return o.isGeneratorFunction(e)?s:s.next().then(function(t){return t.done?t.value:s.next()})},x(L),l(L,m,"Generator"),l(L,s,function(){return this}),l(L,"toString",function(){return"[object Generator]"}),o.keys=function(e){var t,i=[];for(t in e)i.push(t);return i.reverse(),function n(){for(;i.length;){var t=i.pop();if(t in e)return n.value=t,n.done=!1,n}return n.done=!0,n}},o.values=T,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(W),!t)for(var e in this)"t"===e.charAt(0)&&h.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function r(t,e){return s.type="throw",s.arg=n,i.next=t,e&&(i.method="next",i.arg=c),!!e}for(var t=this.tryEntries.length-1;0<=t;--t){var e=this.tryEntries[t],s=e.completion;if("root"===e.tryLoc)return r("end");if(e.tryLoc<=this.prev){var o=h.call(e,"catchLoc"),a=h.call(e,"finallyLoc");if(o&&a){if(this.prev<e.catchLoc)return r(e.catchLoc,!0);if(this.prev<e.finallyLoc)return r(e.finallyLoc)}else if(o){if(this.prev<e.catchLoc)return r(e.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return r(e.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&h.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,w):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),w},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),W(n),w}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,W(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=c),w}},o}({});try{globalThis.regeneratorRuntime=mt}catch(t){"object"===("undefined"==typeof globalThis?"undefined":n(globalThis))?globalThis.regeneratorRuntime=mt:Function("r","regeneratorRuntime = r")(mt)}var mt={COLOR:"1",CROQUET_VERSION:"1.1.0-14",EDITOR:"nano",HOME:"/Users/vanessa",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",HOMEBREW_PREFIX:"/opt/homebrew",HOMEBREW_REPOSITORY:"/opt/homebrew",INFOPATH:"/opt/homebrew/share/info:",INIT_CWD:"/Users/vanessa/wonderland/croquet/libraries/packages/croquet",LANG:"en_US.UTF-8",LESS:"-R",LOGNAME:"vanessa",LSCOLORS:"Gxfxcxdxbxegedabagacad",MANPATH:"/Users/vanessa/.nvm/versions/node/v16.18.0/share/man:/opt/homebrew/share/man::",NODE:"/Users/vanessa/.nvm/versions/node/v16.18.0/bin/node",NODE_ENV:"production",NVM_BIN:"/Users/vanessa/.nvm/versions/node/v16.18.0/bin",NVM_CD_FLAGS:"-q",NVM_DIR:"/Users/vanessa/.nvm",NVM_INC:"/Users/vanessa/.nvm/versions/node/v16.18.0/include/node",P9K_SSH:"0",P9K_TTY:"old",PAGER:"less",PATH:"/Users/vanessa/wonderland/croquet/libraries/packages/croquet/node_modules/.bin:/Users/vanessa/wonderland/croquet/libraries/packages/node_modules/.bin:/Users/vanessa/wonderland/croquet/libraries/node_modules/.bin:/Users/vanessa/wonderland/croquet/node_modules/.bin:/Users/vanessa/wonderland/node_modules/.bin:/Users/vanessa/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/vanessa/.nvm/versions/node/v16.18.0/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/vanessa/wonderland/docker/scripts:/Users/vanessa/.nvm/versions/node/v16.18.0/bin:/Users/vanessa/google-cloud-sdk/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin",PWD:"/Users/vanessa/wonderland/croquet/libraries/packages/croquet",SHELL:"/bin/zsh",SHLVL:"3",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.0s2LoQcSkQ/Listeners",TERM:"xterm-256color",TERM_PROGRAM:"Apple_Terminal",TERM_PROGRAM_VERSION:"445",TERM_SESSION_ID:"C3735642-A37D-4429-AB5A-ABC1054D4DD3",TMPDIR:"/var/folders/vt/36w8wg916qvblvg2k_y9dtvm0000gn/T/",USER:"vanessa",XPC_FLAGS:"0x0",XPC_SERVICE_NAME:"0",ZSH:"/Users/vanessa/.oh-my-zsh"},pt=window.location.hostname.endsWith("croquet.studio"),ft="",bt="";function K(t,e){if(e){var n,i=W(e.split("&"));try{for(i.s();!(n=i.n()).done;){var r=n.value.split("="),s=r[0],o=!0;if(1<r.length&&(o=decodeURIComponent(r.slice(1).join("="))).match(/^(true|false|null|[0-9.]*|["[{].*)$/))try{o=JSON.parse(o)}catch(t){"["===o[0]&&(o=o.slice(1,-1).split(","))}t[s]=o}}catch(t){i.e(t)}finally{i.f()}}}var M=new(function(){function e(){o(this,e),this.getSession(),K(this,window.location.search.slice(1)),K(this,pt?window.location.hash.slice(1):bt),0<=window.location.pathname.indexOf("/ar.html")&&(this.ar=!0)}return a(e,[{key:"has",value:function(t,e,n){"boolean"!=typeof n&&(n=this.isHost(n));var t=this[t];return"string"==typeof t&&(t=t.split(","),(e=!0===n?"no".concat(e):e).endsWith("s")&&(e=e.slice(0,-1)),t.includes(e)||t.includes("".concat(e,"s")))?!n:n}},{key:"getSession",value:function(){if(pt){var t=window.location.pathname.match(/^\/([^/]+)\/(.*)$/);if(t)return ft=t[1],t[2]}else{t=window.location.hash.match(/^#([^&]+)&?(.*)$/);if(t)return t[1].includes("=")?(bt="".concat(t[1],"&").concat(t[2]),""):(bt=t[2],t[1])}return"string"==typeof this.session?(bt=window.location.hash.slice(1),this.session):""}},{key:"setSession",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(null==pt&&this.getSession(),window.location),i=n.search,n=n.hash,i=pt?"/".concat(ft,"/").concat(t).concat(i).concat(n):"#".concat(t).concat(bt?"&"+bt:"");e?window.history.replaceState({},"",i):window.history.pushState({},"",i)}},{key:"isHost",value:function(t){var e=window.location.hostname;return e===t||"localhost"===t&&(!!e.endsWith(".ngrok.io")||!("croquet.io"!==e||!window.location.pathname.match(/^\/(dev|files)\//))||["127.0.0.1","[::1]"].includes(e))}},{key:"isLocalhost",value:function(){return this.isHost("localhost")}}]),e}()),R={exports:{}},P=ut,I=function(t){var s=function e(t){return new e.lib.init(t)};function r(t,e){return e.offset[t]?isNaN(e.offset[t])?e.offset[t]:e.offset[t]+"px":"0px"}function i(t,e){return!(!t||"string"!=typeof e||!(t.className&&-1<t.className.trim().split(/\s+/gi).indexOf(e)))}return s.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,style:{background:""}},s.lib=s.prototype={toastify:"1.11.2",constructor:s,init:function(t){return t=t||{},this.options={},this.toastElement=null,this.options.text=t.text||s.defaults.text,this.options.node=t.node||s.defaults.node,this.options.duration=0===t.duration?0:t.duration||s.defaults.duration,this.options.selector=t.selector||s.defaults.selector,this.options.callback=t.callback||s.defaults.callback,this.options.destination=t.destination||s.defaults.destination,this.options.newWindow=t.newWindow||s.defaults.newWindow,this.options.close=t.close||s.defaults.close,this.options.gravity="bottom"===t.gravity?"toastify-bottom":s.defaults.gravity,this.options.positionLeft=t.positionLeft||s.defaults.positionLeft,this.options.position=t.position||s.defaults.position,this.options.backgroundColor=t.backgroundColor||s.defaults.backgroundColor,this.options.avatar=t.avatar||s.defaults.avatar,this.options.className=t.className||s.defaults.className,this.options.stopOnFocus=(void 0===t.stopOnFocus?s.defaults:t).stopOnFocus,this.options.onClick=t.onClick||s.defaults.onClick,this.options.offset=t.offset||s.defaults.offset,this.options.escapeMarkup=(void 0!==t.escapeMarkup?t:s.defaults).escapeMarkup,this.options.style=t.style||s.defaults.style,t.backgroundColor&&(this.options.style.background=t.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var t,e,i,s,o=document.createElement("div");for(t in o.className="toastify on "+this.options.className,this.options.position?o.className+=" toastify-"+this.options.position:!0===this.options.positionLeft?(o.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):o.className+=" toastify-right",o.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.'),this.options.style)o.style[t]=this.options.style[t];return this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE?o.appendChild(this.options.node):(this.options.escapeMarkup?o.innerText=this.options.text:o.innerHTML=this.options.text,""!==this.options.avatar&&((s=document.createElement("img")).src=this.options.avatar,s.className="toastify-avatar","left"==this.options.position||!0===this.options.positionLeft?o.appendChild(s):o.insertAdjacentElement("afterbegin",s))),!0===this.options.close&&((s=document.createElement("span")).innerHTML="&#10006;",s.className="toast-close",s.addEventListener("click",function(t){t.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}.bind(this)),i=0<window.innerWidth?window.innerWidth:screen.width,("left"==this.options.position||!0===this.options.positionLeft)&&360<i?o.insertAdjacentElement("afterbegin",s):o.appendChild(s)),this.options.stopOnFocus&&0<this.options.duration&&(e=this,o.addEventListener("mouseover",function(t){window.clearTimeout(o.timeOutValue)}),o.addEventListener("mouseleave",function(){o.timeOutValue=window.setTimeout(function(){e.removeElement(o)},e.options.duration)})),void 0!==this.options.destination&&o.addEventListener("click",function(t){t.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination}.bind(this)),"function"==typeof this.options.onClick&&void 0===this.options.destination&&o.addEventListener("click",function(t){t.stopPropagation(),this.options.onClick()}.bind(this)),"object"===n(this.options.offset)&&(i=r("x",this.options),s=r("y",this.options),i="left"==this.options.position?i:"-"+i,s="toastify-top"==this.options.gravity?s:"-"+s,o.style.transform="translate("+i+","+s+")"),o},showToast:function(){var t,e;if(this.toastElement=this.buildToast(),t="string"==typeof this.options.selector?document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||"undefined"!=typeof ShadowRoot&&this.options.selector instanceof ShadowRoot?this.options.selector:document.body)return e=s.defaults.oldestFirst?t.firstChild:t.lastChild,t.insertBefore(this.toastElement,e),s.reposition(),0<this.options.duration&&(this.toastElement.timeOutValue=window.setTimeout(function(){this.removeElement(this.toastElement)}.bind(this),this.options.duration)),this;throw"Root element is not defined"},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(t){t.className=t.className.replace(" on",""),window.setTimeout(function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),t.parentNode&&t.parentNode.removeChild(t),this.options.callback.call(t),s.reposition()}.bind(this),400)}},s.reposition=function(){for(var t={top:15,bottom:15},e={top:15,bottom:15},n={top:15,bottom:15},r=document.getElementsByClassName("toastify"),s=0;s<r.length;s++){var o=!0===i(r[s],"toastify-top")?"toastify-top":"toastify-bottom",a=r[s].offsetHeight;o=o.substr(9,o.length-1),(0<window.innerWidth?window.innerWidth:screen.width)<=360?(r[s].style[o]=n[o]+"px",n[o]+=a+15):!0===i(r[s],"toastify-left")?(r[s].style[o]=t[o]+"px",t[o]+=a+15):(r[s].style[o]=e[o]+"px",e[o]+=a+15)}return this},s.lib.init.prototype=s.lib,s},vt=(R.exports?R.exports=I():P.Toastify=I(),R.exports),P={exports:{}};!function(t){var o,a="undefined"!=typeof self?self:ut,c=[],l=Math,u=256,m=l.pow(u,6),b=l.pow(2,52),v=2*b,g=255;function d(t,e,i){function a7(){for(var t=s.g(6),e=m,n=0;t<b;)t=(t+n)*u,e*=u,n=s.g(1);for(;v<=t;)t/=2,e/=2,n>>>=1;return(t+n)/e}var r=[],t=p(function m(t,e){var i,r=[],s=n(t);if(e&&"object"==s)for(i in t)try{r.push(m(t[i],e-1))}catch(t){}return r.length?r:"string"==s?t:t+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(c)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(u):(t=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(t)),y(t)}catch(t){var e=a.navigator,e=e&&e.plugins;return[+new Date,a,e,a.screen,y(c)]}}():t,3),r),s=new h(r);return a7.int32=function(){return 0|s.g(4)},a7.quick=function(){return s.g(4)/4294967296},a7.double=a7,p(y(s.S),c),(e.pass||i||function(t,e,n,i){return i&&(i.S&&f(i,s),t.state=function(){return f(s,{})}),n?(l.random=t,e):t})(a7,t,"global"in e?e.global:this==l,e.state)}function h(t){var e,n=t.length,o=this,i=0,r=o.i=o.j=0,s=o.S=[];for(n||(t=[n++]);i<u;)s[i]=i++;for(i=0;i<u;i++)s[i]=s[r=g&r+t[i%n]+(e=s[i])],s[r]=e;(o.g=function(t){for(var e,n=0,i=o.i,r=o.j,s=o.S;t--;)e=s[i=g&i+1],n=n*u+s[g&(s[i]=s[r=g&r+e])+(s[r]=e)];return o.i=i,o.j=r,n})(u)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,i=t+"",r=0;r<i.length;)e[g&r]=g&(n^=19*e[g&r])+i.charCodeAt(r++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(p(l.random(),c),t.exports){t.exports=d;try{o=void 0}catch(t){}}else l.seedrandom=d}(P);var gt,Zt=P.exports;!function(){function e(t){this.mode=s.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,n=this.data.length;e<n;e++){var i=[],r=this.data.charCodeAt(e);65536<r?(i[0]=240|(1835008&r)>>>18,i[1]=128|(258048&r)>>>12,i[2]=128|(4032&r)>>>6,i[3]=128|63&r):2048<r?(i[0]=224|(61440&r)>>>12,i[1]=128|(4032&r)>>>6,i[2]=128|63&r):128<r?(i[0]=192|(1984&r)>>>6,i[1]=128|63&r):i[0]=r,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},t.prototype={addData:function(t){t=new e(t);this.dataList.push(t),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[i][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),7<=this.typeNumber&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=v.getLostPoint(this);(0==n||i<t)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){var i=t.createEmptyMovieClip(e,n);this.make();for(var r=0;r<this.modules.length;r++)for(var s=+r,o=0;o<this.modules[r].length;o++){var a=+o;this.modules[r][o]&&(i.beginFill(0,100),i.moveTo(a,s),i.lineTo(1+a,s),i.lineTo(1+a,1+s),i.lineTo(a,1+s),i.endFill())}return i},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=v.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],r=t[n];if(null==this.modules[i][r])for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)this.modules[i+s][r+o]=-2==s||2==s||-2==o||2==o||0==s&&0==o}},setupTypeNumber:function(t){for(var e=v.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++)i=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i},setupTypeInfo:function(t,e){for(var e=this.errorCorrectLevel<<3|e,n=v.getBCHTypeInfo(e),i=0;i<15;i++){var r=!t&&1==(n>>i&1);i<6?this.modules[i][8]=r:i<8?this.modules[i+1][8]=r:this.modules[this.moduleCount-15+i][8]=r}for(i=0;i<15;i++)r=!t&&1==(n>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=r:i<9?this.modules[8][15-i-1+1]=r:this.modules[8][15-i-1]=r;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,r=7,s=0,o=this.moduleCount-1;0<o;o-=2)for(6==o&&o--;;){for(var a,c=0;c<2;c++)null==this.modules[i][o-c]&&(a=!1,s<t.length&&(a=1==(t[s]>>>r&1)),v.getMask(e,i,o-c)&&(a=!a),this.modules[i][o-c]=a,-1==--r)&&(s++,r=7);if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,i){for(var r=y.getRSBlocks(e,n),s=new b,o=0;o<i.length;o++){var a=i[o];s.put(a.mode,4),s.put(a.getLength(),v.getLengthInBits(a.mode,e)),a.write(s)}for(var c=0,o=0;o<r.length;o++)c+=r[o].dataCount;if(s.getLengthInBits()>8*c)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*c+")");for(s.getLengthInBits()+4<=8*c&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*c||(s.put(t.PAD0,8),s.getLengthInBits()>=8*c));)s.put(t.PAD1,8);return t.createBytes(s,r)},t.createBytes=function(t,e){for(var n=0,i=0,r=0,s=new Array(e.length),o=new Array(e.length),a=0;a<e.length;a++){var c=e[a].dataCount,l=e[a].totalCount-c,i=Math.max(i,c),r=Math.max(r,l);s[a]=new Array(c);for(var h=0;h<s[a].length;h++)s[a][h]=255&t.buffer[h+n];n+=c;var c=v.getErrorCorrectPolynomial(l),u=new p(s[a],c.getLength()-1).mod(c);for(o[a]=new Array(c.getLength()-1),h=0;h<o[a].length;h++){var d=h+u.getLength()-o[a].length;o[a][h]=0<=d?u.get(d):0}}for(var m=0,h=0;h<e.length;h++)m+=e[h].totalCount;var f=new Array(m),y=0;for(h=0;h<i;h++)for(a=0;a<e.length;a++)h<s[a].length&&(f[y++]=s[a][h]);for(h=0;h<r;h++)for(a=0;a<e.length;a++)h<o[a].length&&(f[y++]=o[a][h]);return f};for(var s={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},c={L:1,M:0,Q:3,H:2},v={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=v.getBCHDigit(e)-v.getBCHDigit(v.G15);)e^=v.G15<<v.getBCHDigit(e)-v.getBCHDigit(v.G15);return(t<<10|e)^v.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=v.getBCHDigit(e)-v.getBCHDigit(v.G18);)e^=v.G18<<v.getBCHDigit(e)-v.getBCHDigit(v.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return v.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return(e+n)%2==0;case 1:return e%2==0;case 2:return n%3==0;case 3:return(e+n)%3==0;case 4:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case 5:return e*n%2+e*n%3==0;case 6:return(e*n%2+e*n%3)%2==0;case 7:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new p([1],0),n=0;n<t;n++)e=e.multiply(new p([1,r.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case s.MODE_NUMBER:return 10;case s.MODE_ALPHA_NUM:return 9;case s.MODE_8BIT_BYTE:case s.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case s.MODE_NUMBER:return 12;case s.MODE_ALPHA_NUM:return 11;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case s.MODE_NUMBER:return 14;case s.MODE_ALPHA_NUM:return 13;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var r=0;r<e;r++){for(var s=0,o=t.isDark(i,r),a=-1;a<=1;a++)if(!(i+a<0||e<=i+a))for(var c=-1;c<=1;c++)r+c<0||e<=r+c||0==a&&0==c||o==t.isDark(i+a,r+c)&&s++;5<s&&(n+=3+s-5)}for(i=0;i<e-1;i++)for(r=0;r<e-1;r++){var l=0;t.isDark(i,r)&&l++,t.isDark(i+1,r)&&l++,t.isDark(i,r+1)&&l++,t.isDark(i+1,r+1)&&l++,0!=l&&4!=l||(n+=3)}for(i=0;i<e;i++)for(r=0;r<e-6;r++)t.isDark(i,r)&&!t.isDark(i,r+1)&&t.isDark(i,r+2)&&t.isDark(i,r+3)&&t.isDark(i,r+4)&&!t.isDark(i,r+5)&&t.isDark(i,r+6)&&(n+=40);for(r=0;r<e;r++)for(i=0;i<e-6;i++)t.isDark(i,r)&&!t.isDark(i+1,r)&&t.isDark(i+2,r)&&t.isDark(i+3,r)&&t.isDark(i+4,r)&&!t.isDark(i+5,r)&&t.isDark(i+6,r)&&(n+=40);for(var h=0,r=0;r<e;r++)for(i=0;i<e;i++)t.isDark(i,r)&&h++;return n+Math.abs(100*h/e/e-50)/5*10}},r={glog:function(t){if(t<1)throw new Error("glog("+t+")");return r.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return r.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},n=0;n<8;n++)r.EXP_TABLE[n]=1<<n;for(n=8;n<256;n++)r.EXP_TABLE[n]=r.EXP_TABLE[n-4]^r.EXP_TABLE[n-5]^r.EXP_TABLE[n-6]^r.EXP_TABLE[n-8];for(n=0;n<255;n++)r.LOG_TABLE[r.EXP_TABLE[n]]=n;function p(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function y(t,e){this.totalCount=t,this.dataCount=e}function b(){this.buffer=[],this.length=0}p.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=r.gexp(r.glog(this.get(n))+r.glog(t.get(i)));return new p(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=r.glog(this.get(0))-r.glog(t.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<t.getLength();i++)n[i]^=r.gexp(r.glog(t.get(i))+e);return new p(n,0).mod(t)}},y.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],y.getRSBlocks=function(t,e){var n=y.getRsBlockTable(t,e);if(null==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=n.length/3,r=[],s=0;s<i;s++)for(var o=n[3*s+0],a=n[3*s+1],c=n[3*s+2],l=0;l<o;l++)r.push(new y(a,c));return r},y.getRsBlockTable=function(t,e){switch(e){case c.L:return y.RS_BLOCK_TABLE[4*(t-1)+0];case c.M:return y.RS_BLOCK_TABLE[4*(t-1)+1];case c.Q:return y.RS_BLOCK_TABLE[4*(t-1)+2];case c.H:return y.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},b.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var l=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],i=(Rj.prototype.draw=function(t){var e=this._oContext,n=this._htOption,i=t.getModuleCount(),r=n.width/i,s=n.height/i,o=Math.round(r),a=Math.round(s);this.clear();for(var c=0;c<i;c++)for(var l=0;l<i;l++){var h=t.isDark(c,l),u=l*r,d=c*s;e.strokeStyle=h?n.colorDark:n.colorLight,e.lineWidth=1,e.fillStyle=h?n.colorDark:n.colorLight,e.fillRect(u,d,r,s),e.strokeRect(Math.floor(u)+.5,Math.floor(d)+.5,o,a),e.strokeRect(Math.ceil(u)-.5,Math.ceil(d)-.5,o,a)}this._bIsPainted=!0},Rj.prototype.isPainted=function(){return this._bIsPainted},Rj.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},Rj.prototype.round=function(t){return t&&Math.floor(1e3*t)/1e3},Rj);function Rj(t,e){this._bIsPainted=!1,this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null}(gt=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c.H},e="string"==typeof e?{text:e}:e)for(var n in e)this._htOption[n]=e[n];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(i=svgDrawer),this._el=t,this._oQRCode=null,this._oDrawing=new i(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(e){this._oQRCode=new t(function Z(t,e){for(var n,i=1,r=(t=t,(n=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a")).length+(n.length!=t?3:0)),s=0,o=l.length;s<=o;s++){var a=0;switch(e){case c.L:a=l[s][0];break;case c.M:a=l[s][1];break;case c.Q:a=l[s][2];break;case c.H:a=l[s][3]}if(r<=a)break;i++}if(l.length<i)throw new Error("Too long data");return i}(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode)},gt.prototype.clear=function(){this._oDrawing.clear()},gt.prototype.getCanvas=function(){for(var t=0;t<this._el.children.length;t++){var e=this._el.children[t];if("CANVAS"===e.tagName)return e}return null},gt.CorrectLevel=c}();var Xt=gt,kt=function(t,i){var r,l="boolean"==typeof(i="function"==typeof(i=i||{})?{cmp:i}:i).cycles&&i.cycles,h=i.cmp&&(r=i.cmp,function(n){return function(t,e){t={key:t,value:n[t]},e={key:e,value:n[e]};return r(t,e)}}),u=[];return function e(t){if(void 0!==(t=t&&t.toJSON&&"function"==typeof t.toJSON?t.toJSON():t)){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==n(t))return JSON.stringify(t);if(Array.isArray(t)){for(s="[",o=0;o<t.length;o++)o&&(s+=","),s+=e(t[o])||"null";return s+"]"}if(null===t)return"null";if(-1!==u.indexOf(t)){if(l)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}for(var i=u.push(t)-1,r=Object.keys(t).sort(h&&h(t)),s="",o=0;o<r.length;o++){var a=r[o],c=e(t[a]);c&&(s&&(s+=","),s+=JSON.stringify(a)+":"+c)}return u.splice(i,1),"{"+s+"}"}}(t)},I={exports:{}};I.exports=function(l){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),!(i=!(i=!(i="undefined"!=typeof globalThis&&globalThis.crypto?globalThis.crypto:i)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:i)&&void 0!==ut&&ut.crypto?ut.crypto:i))try{i=ot(3700)}catch(l){}var n=Object.create||function(t){return e.prototype=t,t=new e,e.prototype=null,t},t={},r=t.lib={},s=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},h=r.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(var a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=l.ceil(e/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new h.init(e,t)}}),o=t.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new h.init(n,e/2)}},c=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new h.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},d=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e,n=this._data,i=n.words,r=n.sigBytes,s=this.blockSize,o=r/(4*s),a=(t?l.ceil(o):l.max((0|o)-this._minBufferSize,0))*s,t=l.min(4*a,r);if(a){for(var c=0;c<a;c+=s)this._doProcessBlock(i,c);e=i.splice(0,a),n.sigBytes-=t}return new h.init(e,t)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});function e(){}r.Hasher=d.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new m.HMAC.init(n,e).finalize(t)}}});var m=t.algo={};return t}(Math);var Gt,St={exports:{}}.exports=(R=I.exports,"function"==typeof ArrayBuffer&&(P=R.lib.WordArray,Gt=P.init,(P.init=function(t){if((t=(t=t instanceof ArrayBuffer?new Uint8Array(t):t)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t)instanceof Uint8Array){for(var e=t.byteLength,n=[],i=0;i<e;i++)n[i>>>2]|=t[i]<<24-i%4*8;Gt.call(this,n,e)}else Gt.apply(this,arguments)}).prototype=P),R.lib.WordArray),Wt={exports:{}}.exports=function(t){var r=Math,i=t,s=(a=i.lib).WordArray,o=a.Hasher,a=i.algo,c=[],p=[];function n(t){return 4294967296*(t-(0|t))|0}for(var l=2,h=0;h<64;)!function e(t){for(var n=r.sqrt(t),i=2;i<=n;i++)if(!(t%i))return;return 1}(l)||(h<8&&(c[h]=n(r.pow(l,.5))),p[h]=n(r.pow(l,1/3)),h++),l++;var f=[],a=a.SHA256=o.extend({_doReset:function(){this._hash=new s.init(c.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],c=n[5],l=n[6],h=n[7],u=0;u<64;u++){f[u]=u<16?0|t[e+u]:(((d=f[u-15])<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+f[u-7]+(((d=f[u-2])<<15|d>>>17)^(d<<13|d>>>19)^d>>>10)+f[u-16];var d=i&r^i&s^r&s,m=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&l)+p[u]+f[u],h=l,l=c,c=a,a=o+m|0,o=s,s=r,r=i,i=m+(((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+d)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(64+i>>>9<<4)]=r.floor(n/4294967296),e[15+(64+i>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});return i.SHA256=o._createHelper(a),i.HmacSHA256=o._createHmacHelper(a),t.SHA256}(I.exports),Tt=["hashOverride"],Ct="node"===mt.CROQUET_PLATFORM;function ne(t){for(var e=t.sigBytes,n=t.words,i=new Uint8Array(e),r=0,s=0;r<e;){var o=n[s++];if(i[r++]=(4278190080&o)>>>24,r===e)break;if(i[r++]=(16711680&o)>>>16,r===e)break;if(i[r++]=(65280&o)>>>8,r===e)break;i[r++]=255&o}return i}function re(e){function t(t){var e,n=t.indexOf("{"),i=t.lastIndexOf("}");return-1===n||-1===i||i<n?t:(e=t.slice(0,n).replace(/\s+/g," ").replace(/\s\(/,"("),t=t.slice(n+1,i),"".concat(e.trim(),"{").concat(t.trim(),"}"))}var n,i=t(""+e);return i.startsWith("class")||(n=e.prototype)&&(i+=Object.getOwnPropertyNames(n).map(function(e){return"".concat(e,":").concat(t(""+n[e]))}).join("")),i}function ie(t){return btoa(String.fromCharCode.apply(String,w(new Uint8Array(t)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function se(){return(se=i(regeneratorRuntime.mark(function e(n){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===n.length)return t.abrupt("return","47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU");t.next=2;break;case 2:return t.next=4,Mt("SHA-256",n);case 4:return i=t.sent,t.abrupt("return",ie(i));case 6:case"end":return t.stop()}},e)}))).apply(this,arguments)}function ae(){return M.has("debug","hashing",!1)}var Mt=globalThis.crypto&&globalThis.crypto.subtle&&"function"==typeof globalThis.crypto.subtle.digest?globalThis.crypto.subtle.digest.bind(globalThis.crypto.subtle):function(t,e){if("SHA-256"!==t)throw Error("Croquet: only SHA-256 available");t=St.create(e);return ne(Wt(t)).buffer},Rt={},Yt=new TextEncoder;function ue(){return de.apply(this,arguments)}function de(){return(de=i(regeneratorRuntime.mark(function e(n){var i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=Yt.encode(n),t.next=3,function oe(){return se.apply(this,arguments)}(i);case 3:return r=t.sent,ae()&&(Rt[r]={string:n,buffer:i}),t.abrupt("return",r);case 6:case"end":return t.stop()}},e)}))).apply(this,arguments)}var Kt=[],Pt={};function pe(){return(pe=i(regeneratorRuntime.mark(function e(n,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ue(n+kt(i)));case 1:case"end":return t.stop()}},e)}))).apply(this,arguments)}var It=new Set;function ve(){return(ve=i(regeneratorRuntime.mark(function e(n,i,r,s){var o,a,c,l,h,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(l=Pt[n],c="",l)?(o=l.codeHashes,a=l.computedCodeHash,c=" (code hashing from cache)",e.next=15):e.next=8;break;case 8:return e.next=10,Promise.all(Kt);case 10:return o=e.sent,e.next=13,ue([s].concat(w(o)).join("|"));case 13:a=e.sent,Pt[n]={codeHashes:o,computedCodeHash:a};case 15:return l=r.hashOverride,u=function p(t,e){if(null==t)return{};var n,i=function(t,e){if(null==t)return{};for(var n,i={},r=Object.keys(t),s=0;s<r.length;s++)n=r[s],0<=e.indexOf(n)||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),s=0;s<r.length;s++)n=r[s],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n]);return i}(r,Tt),h=l||a,e.next=19,ue(n+"|"+i+kt(u)+h);case 19:return u=e.sent,ae()&&!It.has(u)&&(Ct||w(document.getElementsByTagName("meta")).find(function(t){return t.getAttribute("charset")})||console.warn('Croquet: Missing <meta charset="..."> declaration. Croquet model code hashing might differ between browsers.'),Rt[a].what="Version ID",Rt[n].what="Persistent ID",Rt[u].what="Session ID",h!==a&&(o.push(a),Rt[a].what="Computed Version ID (replaced by overrideHash)",Rt[h]={what:"Version ID (as specified by overrideHash)"}),d=[].concat(w(o),[h,n,u]).map(function(e){return t({hash:e},Rt[e])}),console.log("Croquet: Debug Hashing for session ".concat(u).concat(c),d),It.add(u)),e.abrupt("return",{id:u,persistentId:n,codeHash:h,computedCodeHash:a});case 22:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Vt=Date.now();"undefined"==typeof performance&&(window.performance={now:function(){return Date.now()-Vt}});var _t,Nt,Ft=["simulate","update","render","snapshot"],Ht={total:"black",update:"blue",render:"magenta",simulate:"yellow",snapshot:"green",backlog:"red",network:"lightgray"},zt=null,V=null,_=null,Et=0,N=null,jt=null;var Jt=[],Ut=!1,F=He(0),Qt={},Dt=1e3/60;function Me(t){return 20*(1-t/Dt)+60}function He(t){return{start:t,total:0,items:{},users:0,backlog:0,network:0,latency:0,activity:1e3,connected:Ut}}function Fe(t){F.total=t-F.start;var e=Math.min(120,window.innerWidth);if(e<=Jt.length&&Jt.splice(0,Jt.length-e+1),Jt.push(F),!(Jt.length<=1)&&zt&&0!==zt.offsetHeight){var n,e=Jt.slice(1).filter(function(t){return t.total}),i=e.map(function(t){return t.total}).reduce(function(t,e){return t+e},0)/e.length,r=Math.max.apply(Math,w(e.map(function(t){return t.total}))),e=(Math.max.apply(Math,w(e.map(function(t){return Math.max(t.backlog,t.network)}))),i),i=r,r=(jt.globalCompositeOperation="copy",jt.fillStyle="rgb(255, 255, 255, 0)",jt.fillRect(0,0,N.width,N.height),jt.fillStyle="rgb(0, 0, 0, 1)",jt.globalCompositeOperation="source-over",e="".concat(F.users," users, ").concat(Math.round(1e3/e)," fps"),70<i&&(e+=" ".concat(Math.ceil(i).toLocaleString(),"ms")),jt.fillText(e,2,15),e=F.backlog<100&&F.activity<1e3?"latency: ".concat(F.latency," ms"):"backlog: ".concat(F.backlog<100?"0.0":(F.backlog/1e3).toFixed(1)," s"),jt.fillText(e,2,33),_t||function Ne(t){var e;t=t,(e=document.createElement("canvas")).width=t.width,e.height=t.height,e.style.width="100%",e.style.position="absolute",e.style.left="0px",zt.querySelector("#innerDiv").appendChild(e),(Nt=(_t=e).getContext("2d")).strokeStyle="rgba(255, 255, 255, 0.5)";for(var n=0;n<60;n+=Dt){var i=Me(n);Nt.moveTo(0,i),Nt.lineTo(_t.width,i),Nt.stroke()}}(V),Et===V.width?(_.globalCompositeOperation="copy",_.drawImage(V,1,0,V.width-1,V.height,0,0,V.width-1,V.height),_.globalCompositeOperation="source-over",_.fillStyle="transparent",_.fillRect(V.width-1,0,1,V.height)):Et++,function(t){return Me(t/1e3*-2*Dt)+5}),s=Jt[Jt.length-1],o=Et-.5,a=Me(0),c=(_.beginPath(),_.moveTo(o,a),_.lineTo(o,Me(s.total)),_.strokeStyle=Ht[s.connected?"total":"network"],_.stroke(),_.beginPath(),_.moveTo(o,a),Me(s.total),0),l=W(Ft);try{for(l.s();!(n=l.n()).done;){var h=n.value;s.items[h]&&(a=Me(c+=s.items[h]),_.lineTo(o,a),_.strokeStyle=Ht[h],_.stroke(),_.beginPath(),_.moveTo(o,a))}}catch(t){l.e(t)}finally{l.f()}s.network&&(_.beginPath(),_.moveTo(o,r(0)),_.lineTo(o,r(s.network)),_.strokeStyle=Ht.network,_.stroke())}}var Ot=[],H={animationFrame:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fe(t),F=He(t);for(var n=0,i=Object.entries(e);n<i.length;n++){var r=Z(i[n],2),s=r[0],r=r[1];this[s](r)}},begin:function(t){var e=performance.now(),n=(F.items[t]=(F.items[t]||0)-e,Ot[Ot.length-1]);return n&&(F.items[n]+=e),Ot.push(t),e},end:function(t){var e=performance.now(),n=(F.items[t]+=e,Ot.pop());if(n!==t)throw Error('Unmatched stats calls: expected end("'.concat(n,'"), got end("').concat(t,'")'));n=Ot[Ot.length-1];return n&&(F.items[n]-=e),e},backlog:function(t){F.backlog=Math.max(t,F.backlog)},network:function(t){F.network=t},starvation:function(t){F.network=t},latency:function(t){F.latency=t},activity:function(t){F.activity=t},users:function(t){F.users=t},connected:function(t){var e=Ut;F.connected=Ut=t,e&&!Ut&&_t&&(_t.remove(),Nt=null)},perSecondTally:function(){if(window.logMessageStats)for(var t=0,e=Object.entries(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});t<e.length;t++){var n=Z(e[t],2),i=n[0],n=n[1];Qt[i]=(Qt[i]||0)+n}},stepSession:function(e){var n,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=Math.floor(Date.now()/1e3);return window.logMessageStats?(n=null,r!==Qt.second&&(Qt.second&&i&&(Qt.requestedMessages||Qt.sentMessagesTotal)&&(n=t({},Qt),1!=(i=r-Qt.second)&&(n.sampleSeconds=i),n.sentBundles&&(n.averageDelay=Math.round(10*n.sendDelay/n.sentMessagesTotal)/10,n.averageBundlePayload=Math.round(n.sentBundlePayload/n.sentBundles)),delete n.second,delete n.sendDelay,delete n.sentBundlePayload),Qt={second:r}),n):(Qt={second:r},null)}},Bt="ontouchstart"in document.documentElement,At=window.parent!==window,qt=Bt?20:12,$t=Bt?0:15,te=!1;var ee,ce=!1,le=!1;function qe(e,n){return e&&E.showMessage(e,t(t({},1<arguments.length&&void 0!==n?n:{}),{},{level:"warning"}))}function $e(e,n){return e&&E.showMessage(e,t(t({},1<arguments.length&&void 0!==n?n:{}),{},{level:"status"}))}function et(t,e,n){var n=2<arguments.length&&void 0!==n?n:"error",i=(console.error("Error during ".concat(t),e),(e.stack||"").split("\n").filter(function(t){return!t.match(/croquet-.*\.min.js/)}).join("\n"));E.showMessage("Error during ".concat(t,": ").concat(e.message,"\n\n").concat(i),{level:n,duration:"error"===n?1e4:void 0,stopOnFocus:!0})}try{if(((ee=window.localStorage)["croquet-debug-persist-allowed"]="true")!==ee["croquet-debug-persist-allowed"])throw Error("localStorage not persisted");delete ee["croquet-debug-persist-allowed"]}catch(id){console.warn("localStorage not allowed"),ee={}}function Va(t){t.preventDefault(),t.stopPropagation()}var he,fe,z={get pinned(){return"true"===ee[window.location.pathname+"/croquet-debug-ui-pinned"]},set pinned(t){ee[window.location.pathname+"/croquet-debug-ui-pinned"]=!!t},get activePage(){return ee[window.location.pathname+"/croquet-debug-ui-activePage"]},set activePage(t){ee[window.location.pathname+"/croquet-debug-ui-activePage"]=t}};function st(t,e,n){function lp(t){t.preventDefault(),t.stopPropagation(),n()}var i=document.createElement("canvas"),r=i.width=40*qt/12,s=(i.height=60,i.getContext("2d")),s=(s.font="36px Arial",s.textAlign="center",s.textBaseline="middle",s.fillStyle="black",s.fillText(t,r/2,33),document.createElement("button"));s.id=e,s.className="croquet_dock_button";return Bt?(s.ontouchstart=lp,s.ontouchend=Va):s.onclick=lp,s.onpointerdown=Va,s.onpointerup=Va,s.appendChild(i),s}function ct(e,n,i){for(i=2<arguments.length&&void 0!==i?i:{};e.firstChild;)e.removeChild(e.firstChild);return new Xt(e,t({text:n,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Xt.CorrectLevel.L},i))}var ye=0;function ht(t,e){if(!1===t)return!1;if(t instanceof Element)return t;if("string"==typeof t){t=document.getElementById(t);if(t)return t}return e?e():null}var ge=new Set,E={sessionURL:function(){var t,e=null,n=W(document.getElementsByTagName("link"));try{for(n.s();!(t=n.n()).done;){var i=t.value;if("canonical"===i.getAttribute("rel")){e=i.getAttribute("href");break}}}catch(t){n.e(t)}finally{n.f()}return e||window.location.href}(),root:null,sync:!0,messages:!1,badge:!1,stats:!1,qrcode:!1,makeWidgetDock:function(){var t,n,i,r,s,o,e,a,c,l,h,u,d,m,p,f,y,b,v=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!M.nodock&&(t=v.debug||M.debug,(e=document.getElementById("croquet_dock"))&&e.parentElement.removeChild(e),e=ht(E.root,function(){return document.body}))&&(function Oe(){var t,e;te||(te=!0,t="\n        #croquet_dock { position: fixed; z-index: 2; border: 3px solid white; bottom: 6px; left: 6px; width: 36px; height: 36px; box-sizing: border-box; background: white; opacity: 0.4; transition: all ".concat(.3,"s ease; }\n        #croquet_dock.active { opacity: 0.95; border-radius: 12px; }\n        #croquet_dock.debug { width: 84px; }\n        #croquet_dock_bar { position: absolute; border: 3px solid white; width: 100%; height: 30px; box-sizing: border-box; background: white; }\n\n        #croquet_badge { position: absolute; width: 72px; height: 24px; top: 50%; transform: translate(0px, -50%); cursor: none; }\n        #croquet_dock.active #croquet_badge { left: 2%; }\n        #croquet_dock:not(.debug) #croquet_badge { display: none; }\n\n        .croquet_dock_button { position: absolute; width: ").concat(qt,"%; height: 90%; top: 50%; transform: translate(0px, -50%); border-radius: 20%; }\n        .croquet_dock_button:focus { outline: 0; }\n        .croquet_dock_button canvas { position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; }\n        #croquet_dock:not(.active) .croquet_dock_button { display: none; }\n        #croquet_dock_left { right: ").concat(2+$t+qt+2,"% }\n        #croquet_dock:not(.debug) #croquet_dock_left { display: none; }\n        #croquet_dock_right { right: ").concat(2+$t,"%; }\n        #croquet_dock:not(.debug) #croquet_dock_right { display: none; }\n        #croquet_dock_pin { right: ").concat(2,"%; }\n        #croquet_dock_pin.pinned { background: #cce6ff; }\n\n        #croquet_dock_content { position: absolute; left: ").concat(2,"px; top: ").concat(2,"px; right: ").concat(2,"px; bottom: ").concat(2,"px; background: white; overflow: hidden; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content { display: none; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content div { display: none; }\n\n        #croquet_qrcode { position: absolute; width: 100%; height: 100%;box-sizing: border-box; cursor: crosshair; }\n        #croquet_dock.active #croquet_qrcode { border: 6px solid white; }\n        #croquet_dock.debug #croquet_qrcode:not(.active) { display: none; }\n        #croquet_qrcode canvas { image-rendering: pixelated; }\n\n        #croquet_stats { position: absolute; width: 70%; height: 90%; left: 15%; top: 5%; opacity: 0.8; font-family: sans-serif; }\n        #croquet_stats:not(.active) { display: none; }\n"),(e=document.createElement("style")).innerHTML=t,document.head.insertBefore(e,document.head.getElementsByTagName("style")[0]))}(),(n=document.createElement("div")).id="croquet_dock",t&&n.classList.add("debug"),At&&!v.iframe&&(n.style.display="none"),e.appendChild(n),(r=document.createElement("div")).id="croquet_dock_bar",n.appendChild(r),!1!==v.badge&&((i=document.createElement("div")).id="croquet_badge",r.appendChild(i),E.badge=i),(s=document.createElement("div")).id="croquet_dock_content",n.appendChild(s),!(a=[])!==v.qrcode&&E.sessionURL&&((o=document.createElement("div")).id="croquet_qrcode",s.appendChild(o),a.push(o.id),E.qrcode=o,t||(z.activePage=o.id)),!1!==v.stats&&((e=document.createElement("div")).id="croquet_stats",s.appendChild(e),a.push(e.id),E.stats=e),a.length&&(c=function(t){var e,n=a.length,i=0;z.activePage&&(0<=(r=a.indexOf(z.activePage))?(i=r,e=document.getElementById(z.activePage)):z.activePage=null);var r=a[(i+n+t)%n],i=r===z.activePage?e:(e&&e.classList.remove("active"),document.getElementById(r));i&&i.classList.add("active"),z.activePage=r},1<a.length&&(r.appendChild(st("<","croquet_dock_left",function(){c(-1)})),r.appendChild(st(">","croquet_dock_right",function(){c(1)}))),c(0)),Bt||v.alwaysPinned||(l=st("","croquet_dock_pin",function(){z.pinned=!z.pinned,h()}),(h=function(){z.pinned?l.classList.add("pinned"):l.classList.remove("pinned")})(),r.appendChild(l)),u=200,d=8,m=function(t){n.style.width="".concat(t,"px");n.style.height="".concat(1.18*t,"px");var e=18*t/100;r.style.height="".concat(e,"px"),s.style.top="".concat(2+e,"px"),i&&(i.style.height="".concat(.9*e,"px"),i.style.width="".concat(.9*e*3,"px")),o&&(o.style.border="".concat(d*t/u,"px solid white"))},p=v.fixedSize||u,f=function(){n.classList.add("active"),m(p),setTimeout(function(){return n.style.transition="none"},300)},y=function(){n.style.transition="",n.classList.remove("active"),n.style.width=n.style.height="",r.style.height="",s.style.top="",i&&(i.style.height=i.style.width=""),o&&(o.style.border="")},Bt?(y(),n.ontouchstart=function(t){t.preventDefault(),t.stopPropagation(),(n.classList.contains("active")?y:f)()},n.ontouchend=Va,n.onpointerdown=Va,n.onpointerup=Va):(v.alwaysPinned?f():((z.pinned?f:y)(),n.onmouseenter=f,n.onmouseleave=function(){z.pinned||y()}),v.fixedSize||(b=0,n.addEventListener("wheel",function(t){t.stopPropagation();var e=Date.now();e-b<100||(b=e,e=t.deltaY,e=Math.sign(e)*Math.min(5,Math.abs(e)),t=.8*Math.min(window.innerWidth,window.innerHeight),p=Math.max(166,Math.min(t,n.offsetWidth/Math.pow(1.05,e))),m(p))},{passive:!0}))))},makeSessionWidgets:function(t){var e;(t=t)&&!1!==E.root&&(e=ht(E.badge))&&function at(t,r){if(!1!==E.badge){var e=function(){for(var t=new Zt(r),e=["bcdfghjklmnpqrstvwxyz","aeiou"],n="",i=0;i<5;i++)n+=e[i%2][t.quick()*e[i%2].length|0];return n}();for(document.title=document.title.replace(/:.*/,""),document.title+=":"+e;t.firstChild;)t.removeChild(t.firstChild);var n=document.createElement("canvas"),n=(n.width=120,n.height=40,n.style.width="100%",t.appendChild(n),n.getContext("2d")),i=function(t,e){for(var n=1<arguments.length&&void 0!==e?e:1,i=new Zt(t),r=[],s=0;s<n;s++)r.push("hsl(".concat(360*i.quick(),", 50%, 70%)"));return r}(r,2);n.fillStyle=i[0],n.beginPath(),n.moveTo(0,0),n.lineTo(0,40),n.lineTo(120,0),n.closePath(),n.fill(),n.fillStyle=i[1],n.beginPath(),n.moveTo(120,40),n.lineTo(120,0),n.lineTo(0,40),n.closePath(),n.fill(),n.font="30px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="black",n.fillText(e,60,20)}}(e,t),function lt(){var e,t;!1===E.root||!1===E.qrcode||M.noqr||((e=E.sessionURL)?(t=ht(E.qrcode))&&(Bt||(t.onclick=function(t){t.preventDefault(),t.stopPropagation(),t.shiftKey?(t=document.getElementById("croquet_dock"))&&t.classList.toggle("debug"):window.open(e)}),ct(t,e).getCanvas().style.width="100%"):console.warn("App.sessionURL is not set"))}(),!1===E.root||M.nostats||(e=ht(E.stats))&&function Te(t){for(zt=t;t.firstChild;)t.removeChild(t.firstChild);t.style.background="#faf0dc",N=document.createElement("canvas"),jt=N.getContext("2d"),N.id="text_stats",N.width=Math.min(140,window.innerWidth),N.height=36,N.style.width=N.width,N.style.height=N.height,jt.font="9.5pt sans-serif",t.appendChild(N),t.title=Object.entries(Ht).map(function(t){var t=Z(t,2),e=t[0],t=t[1];return"".concat(t,": ").concat(e)}).join("\n"),(V=document.createElement("canvas")).width=Math.min(125,window.innerWidth),V.height=125,V.style.width="100%";var e=document.createElement("div");e.id="innerDiv",t.appendChild(e),e.appendChild(V),_=V.getContext("2d")}(e)},makeQRCanvas:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return E.sessionURL?(t=ct(document.createElement("div"),E.sessionURL,t))&&t.getCanvas():null},clearSessionMoniker:function(){!1!==E.badge&&(document.title=document.title.replace(/:.*/,""))},showSyncWait:function(t){!1===E.root?t=!1:he=he||function dt(){ce||(ce=!0,t="\n        ".concat(At?"body { min-height: 100vh }":"","\n        #croquet_spinnerOverlay {\n            z-index: 1000;\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color:#333;\n            opacity:0.9;\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            transition: opacity 1.0s ease-out;\n        }\n        /* https://github.com/lukehaas/css-loaders */\n        @keyframes croquet_dots {\n            0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em; }\n            40% { box-shadow: 0 2.5em 0 0; }\n        }\n        #croquet_loader,\n        #croquet_loader::before,\n        #croquet_loader::after {\n          border-radius: 50%;\n          width: 2.5em;\n          height: 2.5em;\n          animation: croquet_dots 1.8s infinite ease-in-out;\n        }\n        #croquet_loader {\n          color: #fff;\n          font-size: 10px;\n          margin: 80px auto;\n          position: relative;\n          text-indent: -9999em;\n          animation-delay: -0.16s;\n        }\n        #croquet_loader::before,\n        #croquet_loader::after {\n          content: '';\n          position: absolute;\n          top: 0;\n        }\n        #croquet_loader::before { left: -3.5em; animation-delay: -0.32s; }\n        #croquet_loader::after { left: 3.5em; }\n        #croquet_spinnerOverlay.croquet_error>*,\n        #croquet_spinnerOverlay.croquet_error>*::before,\n        #croquet_spinnerOverlay.croquet_error>*::after {\n            color: #f00;\n        }\n        #croquet_spinnerOverlay.croquet_fatal>*,\n        #croquet_spinnerOverlay.croquet_fatal>*::before,\n        #croquet_spinnerOverlay.croquet_fatal>*::after {\n            color: #f00;\n            box-shadow: 0 2.5em 0 0 !important;\n            animation: none !important;\n        }\n"),(e=document.createElement("style")).innerHTML=t,document.head.insertBefore(e,document.head.getElementsByTagName("style")[0]));var t=document.createElement("div"),e=(t.id="croquet_spinnerOverlay",document.createElement("div"));return e.id="croquet_loader",e.innerText="Catching up...",t.appendChild(e),t}(),fe===(t=t)||"string"==typeof fe&&!0===t||(!1===E.sync&&(t=!1),(fe=t)?(clearTimeout(ye),ye=setTimeout(function(){fe&&(ht(E.root,function(){return document.body}).appendChild(he),he.style.opacity=.9,he.className="error"===fe?"croquet_error":"fatal"===fe?"croquet_fatal":"")},500)):he&&(clearTimeout(ye),he.style.opacity=0,he.className="",ye=setTimeout(function(){fe||he.parentElement&&he.parentElement.removeChild(he)},500)))},messageFunction:function(e){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=i.level;return"error"===r?(n="orangered,red",console.error(e)):"warning"===r?(n="gold,orange",console.warn(e)):n="silver,gray",function tt(e,n){var i=ht(E.root,function(){return document.body});if(!1===i)return null;le||(le=!0,(s=document.createElement("style")).innerHTML="/*!\n        * Toastify js 1.5.0\n        * https://github.com/apvarun/toastify-js\n        * @license MIT licensed\n        *\n        * Copyright (C) 2018 Varun A P\n        */\n        .toastify {\n            padding: 12px 20px;\n            color: #ffffff;\n            display: inline-block;\n            box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);\n            background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);\n            background: linear-gradient(135deg, #73a5ff, #5477f5);\n            position: fixed;\n            opacity: 0;\n            transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n            border-radius: 2px;\n            cursor: pointer;\n            text-decoration: none;\n            max-width: calc(50% - 20px);\n            z-index: 2147483647;\n        }\n        .toastify.on {\n            opacity: 1;\n        }\n        .toast-close {\n            opacity: 0.4;\n            padding: 0 5px;\n        }\n        .toastify-right {\n            right: 15px;\n        }\n        .toastify-left {\n            left: 15px;\n        }\n        .toastify-top {\n            top: -150px;\n        }\n        .toastify-bottom {\n            bottom: -150px;\n        }\n        .toastify-rounded {\n            border-radius: 25px;\n        }\n        .toastify-avatar {\n            width: 1.5em;\n            height: 1.5em;\n            margin: 0 5px;\n            border-radius: 2px;\n        }\n        @media only screen and (max-width: 360px) {\n            .toastify-right, .toastify-left {\n                margin-left: auto;\n                margin-right: auto;\n                left: 0;\n                right: 0;\n                max-width: fit-content;\n            }\n        }\n\n        .toastify {\n            font-family: sans-serif;\n            border-radius: 8px;\n        }\n\n        .toastify-center {\n            margin-left: auto;\n            margin-right: auto;\n            left: 0;\n            right: 0;\n            max-width: fit-content;\n            max-width: -moz-fit-content;\n        }\n",document.head.insertBefore(s,document.head.getElementsByTagName("style")[0]));var r,s=t({text:e,duration:3e3,gravity:"bottom",position:"right",stopOnFocus:!0},n);return i instanceof Element&&i!==document.body?(r=i.id)||(i.id=r="_croquetToastParent"):"string"==typeof i&&(r=i),r&&(s.selector=r),vt(s).showToast()}(e,t({style:{background:"linear-gradient(90deg,".concat(n,")")}},i))},showMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("once"===e.only){if(ge.has(t))return null;ge.add(t)}return"fatal"===e.level&&(e.level="error",e.showSyncWait="fatal"),e.showSyncWait&&("fatal"!==e.showSyncWait||e.duration||(e.duration=-1),E.showSyncWait(e.showSyncWait)),M.nomessages||!1===E.root||!1===E.messages||!E.messageFunction?("warning"===e.level&&console.warn(t),"error"===e.level&&console.error(t),null):E.messageFunction(t,e)},isCroquetHost:function(t){return t.endsWith("croquet.io")||["localhost","127.0.0.1","[::1]"].includes(t)||t.endsWith("ngrok.io")},referrerURL:function(){var t=new URL(E.sessionURL),e=this.isCroquetHost(t.hostname);return"".concat(t.origin).concat(t.pathname).concat(e?t.search:"")},autoSession:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{key:"q"},e=(t=(t="string"==typeof t?{key:t}:t)||{}).key||"q",n=new URL(E.sessionURL),i="",r=n.search.slice(1).split("&"),s=r.find(function(t){return t.split("=")[0]===e});if(s?i=s.replace(/[^=]*=/,""):(i=r.find(function(t){return!t.includes("=")}))||(i=n.hash.slice(1))&&(n.hash="",n.search?n.searchParams.set(e,i):n.search=i),i)try{i=decodeURIComponent(i)}catch(t){}else i=Math.floor(Math.random()*Math.pow(36,10)).toString(36),n.searchParams.set(e,i);s=n.toString(""),window.location.href!==s&&(window.history.replaceState({},"",s),E.sessionURL=s),M.has("debug","session")&&console.log('Croquet.App.autoSession: "'.concat(i,'"')),r=Promise.resolve(i);return r[Symbol.toPrimitive]=function(){return console.warn("Deprecated: Croquet.App.autoSession() return value used directly. It returns a promise now!"),i},r},autoPassword:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{key:"pw",scrub:!1,keyless:!1},n=e.key||"pw",i=e.scrub&&!M.has("debug","password"),r=e.keyless,s=new URL(E.sessionURL),o="",a=s.hash.slice(1);if(a&&((t=(c=a.split("&")).find(function(t){return t.split("=")[0]===n}))?(o=t.replace(/[^=]*=/,""))&&i&&(s.hash=c.filter(function(t){return t.split("=")[0]!==n}).join("&")):r&&(o=c.find(function(t){return!t.includes("=")}))&&i&&(s.hash=c.filter(function(t){return t!==o}).join("&"))),o||(t=new Uint8Array(16),window.crypto.getRandomValues(t),o=ie(t.buffer),s.hash=a?"".concat(a,"&").concat(n,"=").concat(o):r?o:"".concat(n,"=").concat(o),E.sessionURL=s.href,i&&(s.hash=a)),M.has("debug","session")&&console.log("Croquet.App.sessionUrl: ".concat(E.sessionURL)),window.location.href!==s.href&&window.history.replaceState({},"",s.href),o)try{o=decodeURIComponent(o)}catch(e){}M.has("debug","session")&&console.log('Croquet.App.autoPassword: "'.concat(o,'"'));var c=Promise.resolve(o);return c[Symbol.toPrimitive]=function(){return console.warn("Deprecated: Croquet.App.autoPassword() return value used directly. It returns a promise now!"),o},c}};function yt(t,s,e){var o=2<arguments.length&&void 0!==e?e:null;function r(t){var e,n=W(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;(null!==o&&i.unbound===o||null===o&&i.for===s)&&t.delete(i)}}catch(t){n.e(t)}finally{n.f()}}return r(t.immediate),r(t.oncePerFrame),r(t.oncePerFrameWhileSynced),r(t.queued),t.immediate.size+t.queued.size+t.oncePerFrame.size+t.oncePerFrameWhileSynced.size}var j=new(function(){function e(){var n;o(this,e),this.subscriptions={},this.queuedEvents=[],this.perFrameEvents=new Map,this.perSyncedFrameEvents=new Map,this.id=(n=function(){return crypto.getRandomValues(new Uint8Array(1))[0]},([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^n()&15>>t/4).toString(16)})),this.lastId=0}return a(e,[{key:"register",value:function(t){return"V"+ ++this.lastId}},{key:"deregister",value:function(t){}},{key:"addSubscription",value:function(t,e,n,i,r){if("vote"!==r){var s=t+":"+e,o=i,a=(o.for=n,this.subscriptions[s]);if(!(a=a||(this.subscriptions[s]={immediate:new Set,queued:new Set,oncePerFrame:new Set,oncePerFrameWhileSynced:new Set}))[r])throw Error('Unknown subscribe() option: handling="'.concat(r,'"'));a[r].add(o)}else this.addSubscription(t,e+"#__vote",n,i,"immediate")}},{key:"removeSubscription",value:function(t,e,n){var i=t+":"+e,r=this.subscriptions[i];r&&0===yt(r,n,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null)&&delete this.subscriptions[i],e.endsWith("#__vote")||this.removeSubscription(t,e+"#__vote",n)}},{key:"removeAllSubscriptionsFor",value:function(t){for(var e="".concat(t,":"),n=0,i=Object.entries(this.subscriptions);n<i.length;n++){var r=Z(i[n],2),s=r[0],r=r[1];(s.startsWith(e)||0===yt(r,t))&&delete this.subscriptions[s]}}},{key:"handleEvent",value:function(i,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t){return t()},s=this.subscriptions[i];s&&(0<s.queued.size&&this.queuedEvents.push({topic:i,data:r}),0<s.oncePerFrame.size&&this.perFrameEvents.set(i,r),0<s.oncePerFrameWhileSynced.size&&this.perSyncedFrameEvents.set(i,r),0<s.immediate.size)&&t(function(){var t,e=W(s.immediate);try{for(e.s();!(t=e.n()).done;){var n=t.value;try{n(r)}catch(t){console.error(t),console.warn('Croquet: error "'.concat(t.message,'" in "immediate" subscription ').concat(i))}}}catch(t){e.e(t)}finally{e.f()}})}},{key:"processFrameEvents",value:function(t,e){function ns(t,e,n){var i=a.subscriptions[t];if(i){var r,s=W(i[n]);try{for(s.s();!(r=s.n()).done;){var o=r.value;try{o(e)}catch(e){console.error(e),console.warn('Croquet: error "'.concat(e.message,'" in "').concat(n,'" subscription ').concat(t))}c++}}catch(t){s.e(t)}finally{s.f()}}}var n,a=this,c=0,i=W(this.queuedEvents);try{for(i.s();!(n=i.n()).done;){var r=n.value;ns(r.topic,r.data,"queued")}}catch(t){i.e(t)}finally{i.f()}if(this.queuedEvents.length=0,t){var s,o=W(this.perFrameEvents);try{for(o.s();!(s=o.n()).done;){var l=Z(s.value,2);ns(l[0],l[1],"oncePerFrame")}}catch(t){o.e(t)}finally{o.f()}if(this.perFrameEvents.clear(),e){var h,u=W(this.perSyncedFrameEvents);try{for(u.s();!(h=u.n()).done;){var d=Z(h.value,2);ns(d[0],d[1],"oncePerFrameWhileSynced")}}catch(t){u.e(t)}finally{u.f()}this.perSyncedFrameEvents.clear()}var m,p=W(this.queuedEvents);try{for(p.s();!(m=p.n()).done;){var f=m.value;ns(f.topic,f.data,"queued")}}catch(t){p.e(t)}finally{p.f()}this.queuedEvents.length=0}return c}}]),e}()),Ze={get subscribe(){return(Ze={subscribe:M.has("debug","subscribe",!1)}).subscribe}},we=function(){function e(t){o(this,e),this.vm=t}return a(e,[{key:"register",value:function(t){return this.vm.registerModel(t)}},{key:"deregister",value:function(t){this.vm.deregisterModel(t.id)}},{key:"publish",value:function(t,e,n){this.vm.publishFromModel(n,t,e)}},{key:"subscribe",value:function(t,e,n,i){return Ze.subscribe&&console.log('Model.subscribe("'.concat(e,":").concat(n,'", ').concat(t," ").concat((""+i).replace(/\([\s\S]*/,""),")")),this.vm.addSubscription(t,e,n,i)}},{key:"unsubscribe",value:function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"*";Ze.subscribe&&console.log("Model.unsubscribe(".concat(e,":").concat(n,'", ').concat(t," ").concat((""+i).replace(/\([\s\S]*/,""),")")),this.vm.removeSubscription(t,e,n,i)}},{key:"unsubscribeAll",value:function(t){Ze.subscribe&&console.log("Model.unsubscribeAll(".concat(t," ").concat(t.id,")")),this.vm.removeAllSubscriptionsFor(t)}},{key:"future",value:function(t,e,n,i){if(Le&&Le.equal(this))return this.vm.future(t,e,n,i);throw Error("Model.future() called from outside: ".concat(t))}},{key:"random",value:function(){return this.vm.random()}},{key:"now",value:function(){return this.vm.time}},{key:"equal",value:function(t){return t instanceof e&&t.vm===this.vm}},{key:"isViewRealm",value:function(){return!1}}]),e}(),Xe=function(){function e(t){o(this,e),this.vm=t}return a(e,[{key:"register",value:function(t){return j.register(t)}},{key:"deregister",value:function(t){j.deregister(t)}},{key:"publish",value:function(t,e,n){this.vm.publishFromView(n,t,e)}},{key:"subscribe",value:function(t,e,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"queued";Ze.subscribe&&console.log('View.subscribe("'.concat(i,":").concat(t,'", ').concat(e," ").concat(n?n.name||(""+n).replace(/\([\s\S]*/,""):""+n," [").concat(r,"])")),j.addSubscription(i,t,e,n,r)}},{key:"unsubscribe",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length?arguments[3]:void 0;Ze.subscribe&&console.log('View.unsubscribe("'.concat(i,":").concat(t,'", ').concat(e," ").concat(n?n.name||(""+n).replace(/\([\s\S]*/,""):"*",")")),j.removeSubscription(i,t,e,n)}},{key:"unsubscribeAll",value:function(t){Ze.subscribe&&console.log("View.unsubscribeAll(".concat(t,")")),j.removeAllSubscriptionsFor(t)}},{key:"future",value:function(r,s){var o=this.vm;return new Proxy(r,{get:function(t,i){if("function"==typeof r[i])return new Proxy(r[i],{apply:function(t,e,n){setTimeout(function(){r.id&&xt(o,function(){return r[i].apply(r,w(n))},!0)},s)}});throw Error("Tried to call "+i+"() on future of "+Object.getPrototypeOf(r).constructor.name+" which is not a function")}})}},{key:"random",value:function(){return Math.random()}},{key:"now",value:function(){return this.vm.time}},{key:"externalNow",value:function(){return this.vm.controller.reflectorTime}},{key:"extrapolatedNow",value:function(){return this.vm.controller.extrapolatedTime}},{key:"isSynced",value:function(){return!!this.vm.controller.synced}},{key:"equal",value:function(t){return t instanceof e&&t.vm===this.vm}},{key:"isViewRealm",value:function(){return!0}}]),e}(),Le=null;function wt(t){t=0<arguments.length&&void 0!==t?t:"Tried to execute code that requires realm outside of realm.";if(!Le&&t)throw Error(t);return Le}function Lt(t,e){if(null!==Le)throw Error("Can't switch realms from inside realm");try{return Le=new we(t),e()}finally{Le=null}}function xt(t,e,n){if(null!==Le&&!(2<arguments.length&&void 0!==n&&n))throw Error("Can't switch realms from inside realm");n=Le;try{return Le=new Xe(t),e()}finally{Le=n}}function j0(t){var e,n,i,r,s;if(J(t))return NaN;if(1<(i=0<t?t:(e=!0,-t)))return NaN;if(.625<i)r=(n=1-i)*Se(n),n=xe(n+n),s=ke-n,s=(s-=n=n*r-6123233995736766e-32)+ke;else{if(i<1e-8)return t;s=i*(s=(n=i*i)*Ge(n))+i}return e?-s:s}function kb(t){var e,n,i,r,s,o,a;if(t<-1||J(t))return NaN;if(-1===t)return nn;if(t===en)return t;if(0===t)return t;if(a=1,(n=t<0?-t:t)<.41421356237309503){if(n<1.862645149230957e-9)return n<5551115123125783e-32?t:t-t*t*.5;-.2928932188134525<t&&(a=0,i=t,e=1)}return 0!==a&&(n<9007199254740992?(r=0<(a=((e=D(o=1+t))>>20)-1023)?1-(o-t):t-(o-1),r/=o):(a=((e=D(o=t))>>20)-1023,r=0),(e&=1048575)<434334?o=tn(o,1072693248|e):(a+=1,o=tn(o,1071644672|e),e=1048576-e>>2),i=o-1),n=.5*i*i,0===e?0===i?a*sn+(r+a*on):a*sn-((s=n*(1-.6666666666666666*i))-(a*on+r)-i):(s=(o=(t=i/(2+i))*t)*rn(o),0===a?i-(n-t*(n+s)):a*sn-(n-(t*(n+s)+(a*on+r))-i))}function tb(t){return t===en||t===nn}function yb(t){var e,n,i,r;return J(t)||0===t?t:t===en?un:t===nn?-un:(t<0&&(n=!0,t=-t),e=0,2.414213562373095<t?(i=un,t=-(e=1)/t):t<=.66?i=0:(i=ke,e=2,t=(t-1)/(t+1)),r=t*(r=(r=t*t)*dn(r)/mn(r))+t,2===e?r+=3061616997868383e-32:1===e&&(r+=6123233995736766e-32),i+=r,n?-i:i)}function Tb(t,e){return Zn(Gn,t),t=Gn[0],t&=2147483647,e=D(e),kn(t|=e&=2147483648,Gn[1])}function Xb(t,e){return J(e)||J(t)?NaN:tb(e)?e===en?tb(t)?Tb(Sn/4,t):Tb(0,t):tb(t)?Tb(3*Sn/4,t):Tb(Sn,t):tb(t)?Tb(Sn/2,t):0===t?0<=e&&!(D(e)>>>31)?Tb(0,t):Tb(Sn,t):0===e?Tb(Sn/2,t):(t=yb(t/e),e<0?t<=0?t+Sn:t-Sn:t)}function _b(t){var e,n,i,r;return J(t)||tb(t)||0===t?t:(n=-2147483648&(r=D(t)),r&=2147483647,i=0,i=t<Wn?(i=0x40000000000000,e=D(i*=t),kn(n|(e=(2147483647&e)/3+696219795),0)):tn(i,n|(e=r/3+715094163)),i*=0===(r=n=i*i*(i/t))?1.87595182427177:1.87595182427177+r*(r*(1.6214297201053545+r*(.14599619288661245*r-.758397934778766))-1.8849797954337717),e=D(i),(i=kn(e+1,0))+i*(((n=t/(i*i))-i)/(i+i+n)))}function c1(t,e){var n,i,r=(i=t*t)*i,s=i*Tn(i);return s+=r*r*Cn(i),(r=1-(n=.5*i))+(1-r-n+(i*s-t*e))}function e1(t,e){var n,i=.00833333333332249+(n=t*t)*(27557313707070068e-22*n-.0001984126982985795)+n*n*n*(1.58969099521155e-10*n-2.5050760253406863e-8),r=n*t;return 0===e?t+r*(Mn+n*i):t-(n*(.5*e-r*i)-e-r*Mn)}function k1(t){return t<0?-t:0===t?0:t}var J=function(t){return t!=t},xe=Math.sqrt,ke=.7853981633974483,Ge=function(t){var e;return 0===t?.16666666666666713:(t=(t<0?-t:t)<=1?(e=t*(19.562619833175948+t*(t*(5.444622390564711+t*(.004253011369004428*t-.6019598008014124))-16.262479672107002))-8.198089802484825,t*(139.51056146574857+t*(t*(70.49610280856842+t*(+t-14.740913729888538))-147.1791292232726))-49.18853881490881):(e=.004253011369004428+(t=1/t)*(t*(5.444622390564711+t*(t*(19.562619833175948+-8.198089802484825*t)-16.262479672107002))-.6019598008014124),1+t*(t*(70.49610280856842+t*(t*(139.51056146574857+-49.18853881490881*t)-147.1791292232726))-14.740913729888538)),e/t)},Se=function(t){var e;return 0===t?.08333333333333809:(t=(t<0?-t:t)<=1?(e=28.536655482610616+t*(t*(6.968710824104713+t*(.002967721961301243*t-.5634242780008963))-25.56901049652825),342.43986579130785+t*(t*(147.0656354026815+t*(+t-21.947795316429207))-383.8770957603691)):(e=.002967721961301243+(t=1/t)*(t*(6.968710824104713+t*(28.536655482610616*t-25.56901049652825))-.5634242780008963),1+t*(t*(147.0656354026815+t*(342.43986579130785*t-383.8770957603691))-21.947795316429207)),e/t)},P="function"==typeof Symbol&&"symbol"===n(Symbol("foo")),We=Object.prototype.toString,Ce=Object.prototype.hasOwnProperty,Re="function"==typeof Symbol?Symbol.toStringTag:"",Ye=P&&"symbol"===n(Symbol.toStringTag)?function(t){var e,n,i,r;if(null==t)return We.call(t);n=t[Re],r=Re,e=null!=(i=t)&&Ce.call(i,r);try{t[Re]=void 0}catch(e){return We.call(t)}return i=We.call(t),e?t[Re]=n:delete t[Re],i}:function(t){return We.call(t)},Ke="function"==typeof Uint32Array,Pe="function"==typeof Uint32Array?Uint32Array:null,R="function"==typeof Uint32Array?Uint32Array:null,P=function(){var t,e,n;if("function"!=typeof Pe)return!1;try{e=new Pe([1,3.14,-3.14,4294967296,4294967297]),n=e,t=(Ke&&n instanceof Uint32Array||"[object Uint32Array]"===Ye(n))&&1===e[0]&&3===e[1]&&4294967293===e[2]&&0===e[3]&&1===e[4]}catch(e){t=!1}return t}()?R:function(){throw new Error("not implemented")},Ie="function"==typeof Float64Array,Ve="function"==typeof Float64Array?Float64Array:null,R="function"==typeof Float64Array?Float64Array:null,R=function(){var t,e,n;if("function"!=typeof Ve)return!1;try{e=new Ve([1,3.14,-3.14,NaN]),n=e,t=(Ie&&n instanceof Float64Array||"[object Float64Array]"===Ye(n))&&1===e[0]&&3.14===e[1]&&-3.14===e[2]&&e[3]!=e[3]}catch(e){t=!1}return t}()?R:function(){throw new Error("not implemented")},_e="function"==typeof Uint8Array,ze="function"==typeof Uint8Array?Uint8Array:null,U="function"==typeof Uint8Array?Uint8Array:null,U=function(){var t,e,n;if("function"!=typeof ze)return!1;try{e=new ze([1,3.14,-3.14,256,257]),n=e,t=(_e&&n instanceof Uint8Array||"[object Uint8Array]"===Ye(n))&&1===e[0]&&3===e[1]&&253===e[2]&&0===e[3]&&1===e[4]}catch(e){t=!1}return t}()?U:function(){throw new Error("not implemented")},Ee="function"==typeof Uint16Array,je="function"==typeof Uint16Array?Uint16Array:null,Q="function"==typeof Uint16Array?Uint16Array:null,Q={uint16:function(){var t,e,n;if("function"!=typeof je)return!1;try{e=new je([1,3.14,-3.14,65536,65537]),n=e,t=(Ee&&n instanceof Uint16Array||"[object Uint16Array]"===Ye(n))&&1===e[0]&&3===e[1]&&65533===e[2]&&0===e[3]&&1===e[4]}catch(e){t=!1}return t}()?Q:function(){throw new Error("not implemented")},uint8:U},Q=((U=new Q.uint16(1))[0]=4660,52===new Q.uint8(U.buffer)[0]),Je=!0==Q?1:0,Ue=new R(1),Qe=new P(Ue.buffer),D=function(t){return Ue[0]=t,Qe[Je]},De=!0==Q?1:0,Be=new R(1),Ae=new P(Be.buffer),tn=function(t,e){return Be[0]=t,Ae[De]=e>>>0,Be[0]},en=Number.POSITIVE_INFINITY,nn=Number.NEGATIVE_INFINITY,rn=function(t){return 0===t?.6666666666666735:.6666666666666735+t*(.3999999999940942+t*(.2857142874366239+t*(.22222198432149784+t*(.1818357216161805+t*(.15313837699209373+.14798198605116586*t)))))},sn=.6931471803691238,on=1.9082149292705877e-10,an=.6931471805599453,cn=.6931471803691238,ln=1.9082149292705877e-10,hn=function(t){var e,n,i,r,s,o,a,c;return 0===t?nn:J(t)||t<0?NaN:(n=0,(e=D(t))<1048576&&(n-=54,e=D(t*=0x40000000000000)),2146435072<=e?t+t:(n=n+((e>>20)-1023|0)+((r=614244+(e&=1048575)&1048576|0)>>20|0),t=(t=tn(t,e|1072693248^r))-1,(1048575&2+e)<3?0==t?0===n?0:n*cn+n*ln:(i=t*t*(.5-.3333333333333333*t),0===n?t-i:n*cn-(i-n*ln-t)):(r=e-398458|0,c=(o=(a=(s=t/(2+t))*s)*a)*(0===(c=o)?.3999999999940942:.3999999999940942+c*(.22222198432149784+.15313837699209373*c)),i=a*(0===(a=o)?.6666666666666735:.6666666666666735+a*(.2857142874366239+a*(.1818357216161805+.14798198605116586*a)))+c,0<(r|=440401-e|0)?(o=.5*t*t,0===n?t-(o-s*(o+i)):n*cn-(o-(s*(o+i)+n*ln)-t)):0===n?t-s*(t-i):n*cn-(s*(t-i)-n*ln-t))))},un=1.5707963267948966,dn=function(t){return 0===t?-64.85021904942025:t*(t*(t*(-.8750608600031904*t-16.157537187333652)-75.00855792314705)-122.88666844901361)-64.85021904942025},mn=function(t){return 0===t?194.5506571482614:194.5506571482614+t*(485.3903996359137+t*(432.88106049129027+t*(165.02700983169885+t*(+t+24.858464901423062))))},U=!0==Q?(pn=1,0):(pn=0,1),pn={HIGH:pn,LOW:U},fn=new R(1),yn=new P(fn.buffer),bn=pn.HIGH,vn=pn.LOW,gn=function(t,e){return fn[0]=e,t[0]=yn[bn],t[1]=yn[vn],t},Zn=function(t,e){return 1===arguments.length?gn([0,0],t):gn(t,e)},U=!0==Q?(wi=1,0):(wi=0,1),pn={HIGH:wi,LOW:U},wn=new R(1),Xn=new P(wn.buffer),Ln=pn.HIGH,xn=pn.LOW,kn=function(t,e){return Xn[Ln]=t,Xn[xn]=e,wn[0]},Gn=[0,0],Sn=3.141592653589793,Wn=22250738585072014e-324,Tn=function(t){return 0===t?.0416666666666666:.0416666666666666+t*(2480158728947673e-20*t-.001388888888887411)},Cn=function(t){return 0===t?-2.7557314351390663e-7:t*(2.087572321298175e-9+-11359647557788195e-27*t)-2.7557314351390663e-7},Mn=-.16666666666666632,Rn=!0==Q?0:1,Yn=new R(1),Kn=new P(Yn.buffer),Pn=Math.floor,In=function(t,e){return!J(e)&&!tb(e)&&0!==e&&k1(e)<Wn?(t[0]=4503599627370496*e,t[1]=-52):(t[0]=e,t[1]=0),t},Vn=function(t){t=D(t);return((2146435072&t)>>>20)-1023|0},_n=[0,0],Nn=[0,0],Fn=function(t,e){var n;return 0===t||J(t)||tb(t)?t:(function(t,e){1===arguments.length?In([0,0],t):In(t,e)}(_n,t),(e=(e+=_n[1])+Vn(t=_n[0]))<-1074?Tb(0,t):1023<e?t<0?nn:en:(n=e<=-1023?(e+=52,2220446049250313e-31):1,Zn(Nn,t),n*kn(Nn[0]&2148532223|e+1023<<20,Nn[1])))},Hn=[10680707,7228996,1387004,2578385,16069853,12639074,9804092,4427841,16666979,11263675,12935607,2387514,4345298,14681673,3074569,13734428,16653803,1880361,10960616,8533493,3062596,8710556,7349940,6258241,3772886,3769171,3798172,8675211,12450088,3874808,9961438,366607,15675153,9132554,7151469,3571407,2607881,12013382,4155038,6285869,7677882,13102053,15825725,473591,9065106,15363067,6271263,9264392,5636912,4652155,7056368,13614112,10155062,1944035,9527646,15080200,6658437,6231200,6832269,16767104,5075751,3212806,1398474,7579849,6349435,12618859],zn=[1.570796251296997,7.549789415861596e-8,5390302529957765e-30,3282003415807913e-37,1270655753080676e-44,12293330898111133e-52,27337005381646456e-60,21674168387780482e-67],En=5.960464477539063e-8,jn=Or(new Array(20)),Jn=Or(new Array(20)),Un=Or(new Array(20)),O=Or(new Array(20));function Or(t){for(var e=t.length,n=0;n<e;n++)t[n]=0;return t}function A1(t,e,n,i){for(var r,s,o=n-24*((n=(n=(n-3)/24|0)<0?0:n)+1),a=n-(s=i-1),c=4+s,l=0;l<=c;l++)jn[l]=a<0?0:Hn[a],a+=1;for(l=0;l<=4;l++){for(a=r=0;a<=s;a++)r+=t[a]*jn[l-a+s];Jn[l]=r}return function Dr(t,e,n,i,r,s,o,a,c){for(var l,h,u,d,m,p=s,f=i[n],y=n,b=0;0<y;b++)O[b]=f-16777216*(h=En*f|0)|0,f=i[y-1]+h,--y;if(f=Fn(f,r),f=(f-=8*Pn(.125*f))-(m=0|f),(u=0)<r?(m+=b=O[n-1]>>24-r,O[n-1]-=b<<24-r,u=O[n-1]>>23-r):0===r?u=O[n-1]>>23:.5<=f&&(u=2),0<u){for(m+=1,b=l=0;b<n;b++)y=O[b],0===l?0!==y&&(l=1,O[b]=16777216-y):O[b]=16777215-y;if(0<r)switch(r){case 1:O[n-1]&=8388607;break;case 2:O[n-1]&=4194303}2===u&&(f=1-f,0!==l)&&(f-=Fn(1,r))}if(0===f){for(y=0,b=n-1;s<=b;b--)y|=O[b];if(0===y){for(d=1;0===O[s-d];d++);for(b=n+1;b<=n+d;b++){for(c[a+b]=Hn[o+b],y=h=0;y<=a;y++)h+=t[y]*c[a+(b-y)];i[b]=h}return Dr(t,e,n+=d,i,r,s,o,a,c)}}if(0===f)for(--n,r-=24;0===O[n];)--n,r-=24;else 16777216<=(f=Fn(f,-r))?(O[n]=f-16777216*(h=En*f|0)|0,r+=24,O[n+=1]=h):O[n]=0|f;for(h=Fn(1,r),b=n;0<=b;b--)i[b]=h*O[b],h*=En;for(b=n;0<=b;b--){for(d=h=0;d<=p&&d<=n-b;d++)h+=zn[d]*i[b+d];Un[n-b]=h}for(h=0,b=n;0<=b;b--)h+=Un[b];for(e[0]=0===u?h:-h,h=Un[0]-h,b=1;b<=n;b++)h+=Un[b];return e[1]=0===u?h:-h,7&m}(t,e,4,Jn,o,4,n,s,jn)}function C1(t,e,n){var i=t-1.5707963267341256*(t=Qn(.6366197723675814*t)),r=6077100506506192e-26*t,e=e>>20|0;return n[0]=i-r,16<e-(D(n[0])>>20&2047)&&(r=20222662487959506e-37*t-(i-(i=i-(r=6077100506303966e-26*t))-r),n[0]=i-r,49<e-(D(n[0])>>20&2047))&&(r=84784276603689e-45*t-(i-(i=i-(r=20222662487111665e-37*t))-r),n[0]=i-r),n[1]=i-n[0]-r,t}function R1(t){var e;return J(t)||t===en?t:t===nn?0:709.782712893384<t?en:t<-745.1332191019411?0:-3.725290298461914e-9<t&&t<3.725290298461914e-9?1+t:(e=ii(t<0?1.4426950408889634*t-.5:1.4426950408889634*t+.5),ri(t-.6931471803691238*e,1.9082149292705877e-10*e,e))}function fc(t){var e,n,i,r,s,o,a,c;return J(t)||t<0?NaN:0===t?nn:(n=0,(e=D(t))<1048576&&(n-=54,e=D(t*=0x40000000000000)),2146435072<=e?t+t:(n+=(e>>20)-1023|0,t=tn(t,(e&=1048575)|1072693248^(e=e+614244&1048576|0)),e=n+=e>>20|0,c=(n=t)-1,n=3694239077158931e-28*e+25082946711645275e-27*(--t+(i=(1048575&2+(n=D(n)))<3?0==c?0:c*c*(.3333333333333333*c-.5):(a=(n&=1048575)-398458|0,n=440401-n|0,i=(o=(s=(r=c/(2+c))*r)*s)*ui(o),s=s*di(o)+i,0<(a|=n)?r*((o=.5*c*c)+s)-o:r*(s-c)))),(n+=.4342944818781689*(t-(a=hi(t,0))+i)+.4342944818781689*a)+.30102999566361177*e))}function oc(t){var e,n,i,r,s,o,a,c;if(J(t)||t<0)return NaN;if(Zn(fi,t),(n=fi[e=0])<1048576){if(0==(2147483647&n|fi[1]))return nn;e-=54,n=D(t*=0x40000000000000)}return 2146435072<=n?t+t:(e+=(n>>20)-1023|0,t=tn(t,(n&=1048575)|1072693248^(n=n+614244&1048576|0)),e+=n>>20|0,c=(n=t)-1,1.6751713164886512e-10*(--t+(i=(1048575&2+(n=D(n)))<3?0==c?0:c*c*(.3333333333333333*c-.5):(a=(n&=1048575)-398458|0,n=440401-n|0,i=(o=(s=(r=c/(2+c))*r)*s)*mi(o),s=s*pi(o)+i,0<(a|=n)?r*((o=.5*c*c)+s)-o:r*(s-c))))+1.4426950407214463*(t-(n=hi(t,0))+i)+1.4426950407214463*n+e)}function xc(t,e,n){var i,r,s,o,a,c;return 1072010280<=(s=2147483647&(i=D(t))|0)&&(t<0&&(t=-t,e=-e),t=(c=.7853981633974483-t)+(a=3061616997868383e-32-e),e=0),e=e+(c=t*t)*((r=c*t)*(bi(a=c*c)+(o=c*vi(a)))+e),a=t+(e+=.3333333333333341*r),1072010280<=s?(1-(i>>30&2))*((o=n)-2*(t-(a*a/(a+o)-e))):1===n?a:(hi(c=a,0),o=e-(c-t),hi(s=r=-1/a,0),s+r*(1+s*c+s*o))}var Qn=Math.round,Dn=1.5707963267341256,On=6077100506506192e-26,Bn=2*On,An=4*On,qn=new Array(3),$n=new Array(2),ti=function(t,e){var n,i,r,s,o;if((n=2147483647&D(t)|0)<=1072243195)return e[0]=t,e[1]=0;if(n<=1074752122)return 598523==(1048575&n)?C1(t,n,e):n<=1073928572?0<t?(e[0]=(o=t-Dn)-On,e[1]=o-e[0]-On,1):(e[0]=(o=t+Dn)+On,e[1]=o-e[0]+On,-1):0<t?(e[0]=(o=t-2*Dn)-Bn,e[1]=o-e[0]-Bn,2):(e[0]=(o=t+2*Dn)+Bn,e[1]=o-e[0]+Bn,-2);if(n<=1075594811)return n<=1075183036?1074977148==n?C1(t,n,e):0<t?(e[0]=(o=t-3*Dn)-1.8231301519518578e-10,e[1]=o-e[0]-1.8231301519518578e-10,3):(e[0]=(o=t+3*Dn)+1.8231301519518578e-10,e[1]=o-e[0]+1.8231301519518578e-10,-3):1075388923==n?C1(t,n,e):0<t?(e[0]=(o=t-4*Dn)-An,e[1]=o-e[0]-An,4):(e[0]=(o=t+4*Dn)+An,e[1]=o-e[0]+An,-4);if(n<1094263291)return C1(t,n,e);if(2146435072<=n)return e[0]=NaN,e[1]=NaN,0;for(Yn[0]=t,s=Kn[Rn],o=kn(n-((n=(n>>20)-1046)<<20|0),s),r=0;r<2;r++)qn[r]=0|o,o=16777216*(o-qn[r]);for(qn[2]=o,i=3;0===qn[i-1];)--i;return s=A1(qn,$n,n,i),t<0?(e[0]=-$n[0],e[1]=-$n[1],-s):(e[0]=$n[0],e[1]=$n[1],s)},ei=[0,0],ni=Math.ceil,ii=function(t){return(t<0?ni:Pn)(t)},ri=function(t,e,n){var i,r=(i=t-e)-(r=i*i)*(0===(r=r)?.16666666666666602:.16666666666666602+r*(r*(6613756321437934e-20+r*(4.1381367970572385e-8*r-16533902205465252e-22))-.0027777777777015593));return Fn(1-(e-i*r/(2-r)-t),n)},si=.6931471803691238,oi=1.9082149292705877e-10,ai=!0==Q?0:1,ci=new R(1),li=new P(ci.buffer),hi=function(t,e){return ci[0]=t,li[ai]=e>>>0,ci[0]},ui=function(t){return 0===t?.3999999999940942:.3999999999940942+t*(.22222198432149784+.15313837699209373*t)},di=function(t){return 0===t?.6666666666666735:.6666666666666735+t*(.2857142874366239+t*(.1818357216161805+.14798198605116586*t))},mi=function(t){return 0===t?.3999999999940942:.3999999999940942+t*(.22222198432149784+.15313837699209373*t)},pi=function(t){return 0===t?.6666666666666735:.6666666666666735+t*(.2857142874366239+t*(.1818357216161805+.14798198605116586*t))},fi=[0,0],yi=[0,0],bi=function(t){return 0===t?.13333333333320124:.13333333333320124+t*(.021869488294859542+t*(.0035920791075913124+t*(.0005880412408202641+t*(7817944429395571e-20+-18558637485527546e-21*t))))},vi=function(t){return 0===t?.05396825397622605:.05396825397622605+t*(.0088632398235993+t*(.0014562094543252903+t*(.0002464631348184699+t*(7140724913826082e-20+2590730518636337e-20*t))))},gi=[0,0],Zi=(void 0===globalThis.CroquetMath&&(globalThis.CroquetMath={}),Object.assign(globalThis.CroquetMath,{acos:function(t){return J(t)||t<-1||1<t?NaN:.5<t?2*j0(xe(.5-.5*t)):(t=ke-j0(t),(t+=6123233995736766e-32)+ke)},acosh:function(t){return J(t)||t<1?NaN:1===t?0:268435456<=t?hn(t)+an:2<t?hn(2*t-1/(t+xe(t*t-1))):kb((t=t-1)+xe(2*t+t*t))},asin:j0,asinh:function(t){var e;return J(t)||tb(t)?t:(t<0&&(t=-t,e=!0),t=t<3.725290298461914e-9?t:268435456<t?hn(t)+an:2<t?hn(2*t+1/(xe(t*t+1)+t)):kb(t+(t=t*t)/(1+xe(1+t))),e?-t:t)},atan:yb,atanh:function(t){var e,n;return J(t)||t<-1||1<t?NaN:1===t?en:-1===t?nn:(t<0&&(e=!0,t=-t),t<3.725290298461914e-9?e?-t:t:(n=t<.5?.5*kb((n=t+t)+n*t/(1-t)):.5*kb((t+t)/(1-t)),e?-n:n))},atan2:Xb,cbrt:_b,cos:function(t){var e=D(t);if((e&=2147483647)<=1072243195)return e<1044381696?1:c1(t,0);if(2146435072<=e)return NaN;switch(3&ti(t,ei)){case 0:return c1(ei[0],ei[1]);case 1:return-e1(ei[0],ei[1]);case 2:return-c1(ei[0],ei[1]);default:return e1(ei[0],ei[1])}},cosh:function(t){return J(t)?t:21<(t=t<0?-t:t)?R1(t)/2:(R1(t)+R1(-t))/2},exp:R1,expm1:function(t){var e,n,i,r,s,o,a,c;if(t===en||J(t))return t;if(t===nn)return-1;if(0===t)return t;if(38.816242111356935<=(i=t<0?(e=!0,-t):(e=!1,t))){if(e)return-1;if(709.782712893384<=i)return en}if(r=0|D(i),.34657359027997264<i)i<1.0397207708399179?a=e?(n=t+si,s=-oi,-1):(n=t-si,s=oi,1):(a=e?1.4426950408889634*t-.5:1.4426950408889634*t+.5,n=t-(o=a|=0)*si,s=o*oi),s=n-(t=n-s)-s;else{if(r<1016070144)return t;a=0}return c=(r=t*(e=.5*t))*(((c=1+r*(0===(c=r)?-.03333333333333313:c*(.0015873015872548146+c*(c*(4008217827329362e-21+-2.0109921818362437e-7*c)-793650757867488e-19))-.03333333333333313))-(o=3-c*e))/(6-t*o)),0===a?t-(t*c-r):(c=t*(c-s)-s,c-=r,-1===a?.5*(t-c)-.5:1===a?t<-.25?-2*(c-(t+.5)):1+2*(t-c):a<=-2||56<a?(n=D(i=1-(c-t))+(a<<20)|0,tn(i,n)-1):(o=1,a<20?i=(o=tn(o,n=1072693248-(2097152>>a)|0))-(c-t):(i=t-(c+(o=tn(o,n=1023-a<<20|0))),i+=1),n=D(i)+(a<<20)|0,tn(i,n)))},log:hn,log1p:kb,log10:fc,log2:oc,sin:function(t){var e=D(t);if((e&=2147483647)<=1072243195)return e<1045430272?t:e1(t,0);if(2146435072<=e)return NaN;switch(3&ti(t,yi)){case 0:return e1(yi[0],yi[1]);case 1:return c1(yi[0],yi[1]);case 2:return-e1(yi[0],yi[1]);default:return-c1(yi[0],yi[1])}},sinh:function(t){var e,n;return 0===t?t:(e=k1(t),710.4758600739439<t||t<-709.089565712824?0<t?en:nn:1<e?(709.0895657128241<=e?(e=R1(.5*e),e*=.5*e):e=.5*(e=R1(e))-.5/e,e=t<0?-e:e):t+t*(e*=e)*(0===(t=e)?.16666666666666666:(t=(t<0?-t:t)<=1?(n=t*(t*(-.789474443963537*t-163.72585752598383)-11561.443576500522)-351754.9648081514,t*(36157.827983443196+t*(+t-277.7110814206028))-2110529.7888489086):(n=(t=1/t)*(t*(-351754.9648081514*t-11561.443576500522)-163.72585752598383)-.789474443963537,1+t*(t*(36157.827983443196+-2110529.7888489086*t)-277.7110814206028)),n/t)))},tan:function(t){var e=D(t);return(e&=2147483647)<=1072243195?e<1044381696?t:xc(t,0,1):2146435072<=e?NaN:(e=ti(t,gi),xc(gi[0],gi[1],1-((1&e)<<1)))},tanh:function(t){var e,n,i;if(44.014845965556525<(n=k1(t)))return t<0?-1:1;if(.625<=n)n=1-2/((e=R1(2*n))+1),t<0&&(n=-n);else{if(0===t)return t;n=t+t*(e=t*t)*(0===(t=e)?-.3333333333333332:(t=(t<0?-t:t)<=1?(i=t*(t*(0*t-.9643991794250523)-99.28772310019185)-1614.6876844170845,4844.063053251255+t*(2235.4883906010045+t*(+t+112.81167849163293))):(i=0+(t=1/t)*(t*(-1614.6876844170845*t-99.28772310019185)-.9643991794250523),1+t*(112.81167849163293+t*(2235.4883906010045+4844.063053251255*t))),i/t))}return n}}),Math.pow);function Qi(t){return t===1/0||t===-1/0}globalThis.CroquetMath.pow=function(t,e){var n;return isNaN(t)||isNaN(e)?NaN:Qi(t)||Qi(e)||0===t||0===e?Zi(t,e):t<0&&!Number.isInteger(e)?NaN:1===e?t:2===e?t*t:3===e?t*t*t:4===e?t*t*t*t:(n=1,t<0&&(t*=-1,n=Zi(-1,e)),globalThis.CroquetMath.exp(globalThis.CroquetMath.log(t)*e)*n)};function Fc(t,e){return t<e}function Di(t){if(!(this instanceof Di))return new Di(t);this.array=[],this.size=0,this.compare=t||Fc}Di.prototype.clone=function(){var t=new Di(this.compare);return t.size=this.size,t.array=this.array.slice(0,this.size),t},Di.prototype.add=function(t){var e,n,i=this.size;for(this.array[this.size]=t,this.size+=1;0<i&&(n=this.array[e=i-1>>1],this.compare(t,n));)this.array[i]=n,i=e;this.array[i]=t},Di.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;0<=e;e--)this._percolateDown(e)},Di.prototype._percolateUp=function(t,e){for(var n,i,r=this.array[t];0<t&&(i=this.array[n=t-1>>1],e||this.compare(r,i));)this.array[t]=i,t=n;this.array[t]=r},Di.prototype._percolateDown=function(t){for(var e,n,i,r=this.size,s=this.size>>>1,o=this.array[t];t<s&&(n=1+(e=1+(t<<1)),i=this.array[e],n<r&&this.compare(this.array[n],i)&&(i=this.array[e=n]),this.compare(i,o));)this.array[t]=i,t=e;this.array[t]=o},Di.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},Di.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},Di.prototype.removeOne=function(t){if("function"==typeof t)for(var e=0;e<this.size;e++)if(t(this.array[e]))return this._removeAt(e)},Di.prototype.removeMany=function(t,e){if("function"!=typeof t||this.size<1)return[];e=e?Math.min(e,this.size):this.size;for(var n=0,i=new Array(e),r=0,s=new Array(this.size);n<e&&!this.isEmpty();){var o=this.poll();t(o)?i[n++]=o:s[r++]=o}i.length=n;for(var a=0;a<r;)this.add(s[a++]);return i},Di.prototype.peek=function(){if(0!=this.size)return this.array[0]},Di.prototype.poll=function(){var t;if(0!=this.size)return t=this.array[0],1<this.size?(this.array[0]=this.array[--this.size],this._percolateDown(0)):--this.size,t},Di.prototype.replaceTop=function(t){var e;if(0!=this.size)return e=this.array[0],this.array[0]=t,this._percolateDown(0),e},Di.prototype.trim=function(){this.array=this.array.slice(0,this.size)},Di.prototype.isEmpty=function(){return 0===this.size},Di.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,n=this.clone();!n.isEmpty();)t(n.poll(),e++)},Di.prototype.kSmallest=function(t){if(0==this.size)return[];t=Math.min(this.size,t);var e=new Di(this.compare),n=Math.min((0<t?Math.pow(2,t-1):0)+1,this.size);e.size=n,e.array=this.array.slice(0,n);for(var i=new Array(t),r=0;r<t;r++)i[r]=e.poll();return i};var wi,Xi,Li,xi,ki,Gi,Si,Wi,Ti,Ci,Mi,Ri=Di,Yi=function(){l(n,Ri);var t=b(n);function n(){return o(this,n),t.apply(this,arguments)}return a(n,[{key:"poll",value:function(){var t=g(u(n.prototype),"poll",this).call(this);return this.array[this.size]=null,t}},{key:"asArray",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"asUnsortedArray",value:function(){return this.array.slice(0,this.size)}}]),n}(),Ki={exports:{}}.exports=(Xi=(wi=I.exports).lib.WordArray,wi.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],s=0;s<n;s+=3)for(var o=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<n;a++)r.push(i.charAt(o>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(t){var e=t.length,n=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],r=0;r<n.length;r++)i[n.charCodeAt(r)]=r;var s=n.charAt(64);return s&&-1!==(s=t.indexOf(s))&&(e=s),function r(t,e,n){for(var i,s=[],o=0,a=0;a<e;a++)a%4&&(i=n[t.charCodeAt(a-1)]<<a%4*2|n[t.charCodeAt(a)]>>>6-a%4*2,s[o>>>2]|=i<<24-o%4*8,o++);return Xi.create(s,o)}(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},wi.enc.Base64),Pi={exports:{}}.exports=I.exports.enc.Utf8,Ii=(Q=(pn=U=I.exports).lib,Li=Q.WordArray,xi=Q.Hasher,Q=pn.algo,ki=[],Q=Q.SHA1=xi.extend({_doReset:function(){this._hash=new Li.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],c=0;c<80;c++){ki[c]=c<16?0|t[e+c]:(l=ki[c-3]^ki[c-8]^ki[c-14]^ki[c-16])<<1|l>>>31;var l=(i<<5|i>>>27)+a+ki[c];l+=c<20?1518500249+(r&s|~r&o):c<40?1859775393+(r^s^o):c<60?(r&s|r&o|s&o)-1894007588:(r^s^o)-899497514,a=o,o=s,s=r<<30|r>>>2,r=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(64+i>>>9<<4)]=Math.floor(n/4294967296),e[15+(64+i>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=xi.clone.call(this);return t._hash=this._hash.clone(),t}}),pn.SHA1=xi._createHelper(Q),pn.HmacSHA1=xi._createHmacHelper(Q),U.SHA1,P=(R=I.exports).lib.Base,Gi=R.enc.Utf8,R.algo.HMAC=P.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=Gi.parse(e));var n=t.blockSize,i=4*n;(e=e.sigBytes>i?t.finalize(e):e).clamp();for(var t=this._oKey=e.clone(),e=this._iKey=e.clone(),r=t.words,s=e.words,o=0;o<n;o++)r[o]^=1549556828,s[o]^=909522486;t.sigBytes=e.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,t=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(t))}}),{exports:{}}.exports=(R=(U=Q=I.exports).lib,P=R.Base,Si=R.WordArray,R=U.algo,A=R.SHA1,Wi=R.HMAC,Ti=R.PBKDF2=P.extend({cfg:P.extend({keySize:4,hasher:A,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=Wi.create(n.hasher,t),r=Si.create(),s=Si.create([1]),o=r.words,a=s.words,c=n.keySize,l=n.iterations;o.length<c;){var h=i.update(e).finalize(s);i.reset();for(var u=h.words,d=u.length,m=h,p=1;p<l;p++){m=i.finalize(m),i.reset();for(var f=m.words,y=0;y<d;y++)u[y]^=f[y]}r.concat(h),a[0]++}return r.sigBytes=4*c,r}}),U.PBKDF2=function(t,e,n){return Ti.create(n).compute(t,e)},Q.PBKDF2)),Vi=(function(t){for(var c=Math,e=t,n=(r=e.lib).WordArray,i=r.Hasher,r=e.algo,C=[],s=0;s<64;s++)C[s]=4294967296*c.abs(c.sin(s+1))|0;function l(t,e,n,i,r,s,o){t=t+(e&n|~e&i)+r+o;return(t<<s|t>>>32-s)+e}function u(t,e,n,i,r,s,o){t=t+(e&i|n&~i)+r+o;return(t<<s|t>>>32-s)+e}function d(t,e,n,i,r,s,o){t=t+(e^n^i)+r+o;return(t<<s|t>>>32-s)+e}function h(t,e,n,i,r,s,o){t=t+(n^(e|~i))+r+o;return(t<<s|t>>>32-s)+e}r=r.MD5=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var i=e+n,r=t[i];t[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s=this._hash.words,o=t[e+0],a=t[e+1],c=t[e+2],m=t[e+3],p=t[e+4],f=t[e+5],y=t[e+6],b=t[e+7],v=t[e+8],g=t[e+9],Z=t[e+10],w=t[e+11],X=t[e+12],L=t[e+13],x=t[e+14],k=t[e+15],G=l(s[0],T=s[1],W=s[2],S=s[3],o,7,C[0]),S=l(S,G,T,W,a,12,C[1]),W=l(W,S,G,T,c,17,C[2]),T=l(T,W,S,G,m,22,C[3]);G=l(G,T,W,S,p,7,C[4]),S=l(S,G,T,W,f,12,C[5]),W=l(W,S,G,T,y,17,C[6]),T=l(T,W,S,G,b,22,C[7]),G=l(G,T,W,S,v,7,C[8]),S=l(S,G,T,W,g,12,C[9]),W=l(W,S,G,T,Z,17,C[10]),T=l(T,W,S,G,w,22,C[11]),G=l(G,T,W,S,X,7,C[12]),S=l(S,G,T,W,L,12,C[13]),W=l(W,S,G,T,x,17,C[14]),G=u(G,T=l(T,W,S,G,k,22,C[15]),W,S,a,5,C[16]),S=u(S,G,T,W,y,9,C[17]),W=u(W,S,G,T,w,14,C[18]),T=u(T,W,S,G,o,20,C[19]),G=u(G,T,W,S,f,5,C[20]),S=u(S,G,T,W,Z,9,C[21]),W=u(W,S,G,T,k,14,C[22]),T=u(T,W,S,G,p,20,C[23]),G=u(G,T,W,S,g,5,C[24]),S=u(S,G,T,W,x,9,C[25]),W=u(W,S,G,T,m,14,C[26]),T=u(T,W,S,G,v,20,C[27]),G=u(G,T,W,S,L,5,C[28]),S=u(S,G,T,W,c,9,C[29]),W=u(W,S,G,T,b,14,C[30]),G=d(G,T=u(T,W,S,G,X,20,C[31]),W,S,f,4,C[32]),S=d(S,G,T,W,v,11,C[33]),W=d(W,S,G,T,w,16,C[34]),T=d(T,W,S,G,x,23,C[35]),G=d(G,T,W,S,a,4,C[36]),S=d(S,G,T,W,p,11,C[37]),W=d(W,S,G,T,b,16,C[38]),T=d(T,W,S,G,Z,23,C[39]),G=d(G,T,W,S,L,4,C[40]),S=d(S,G,T,W,o,11,C[41]),W=d(W,S,G,T,m,16,C[42]),T=d(T,W,S,G,y,23,C[43]),G=d(G,T,W,S,g,4,C[44]),S=d(S,G,T,W,X,11,C[45]),W=d(W,S,G,T,k,16,C[46]),G=h(G,T=d(T,W,S,G,c,23,C[47]),W,S,o,6,C[48]),S=h(S,G,T,W,b,10,C[49]),W=h(W,S,G,T,x,15,C[50]),T=h(T,W,S,G,f,21,C[51]),G=h(G,T,W,S,X,6,C[52]),S=h(S,G,T,W,m,10,C[53]),W=h(W,S,G,T,Z,15,C[54]),T=h(T,W,S,G,a,21,C[55]),G=h(G,T,W,S,v,6,C[56]),S=h(S,G,T,W,k,10,C[57]),W=h(W,S,G,T,y,15,C[58]),T=h(T,W,S,G,L,21,C[59]),G=h(G,T,W,S,p,6,C[60]),S=h(S,G,T,W,w,10,C[61]),W=h(W,S,G,T,c,15,C[62]),T=h(T,W,S,G,g,21,C[63]),s[0]=s[0]+G|0,s[1]=s[1]+T|0,s[2]=s[2]+W|0,s[3]=s[3]+S|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes,r=(e[i>>>5]|=128<<24-i%32,c.floor(n/4294967296));e[15+(64+i>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e[14+(64+i>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process();for(var r=this._hash,s=r.words,o=0;o<4;o++){var a=s[o];s[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return r},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}}),e.MD5=i._createHelper(r),e.HmacMD5=i._createHmacHelper(r),t.MD5}(I.exports),A=(P=R=I.exports).lib,U=A.Base,Ci=A.WordArray,A=P.algo,Q=A.MD5,Mi=A.EvpKDF=U.extend({cfg:U.extend({keySize:4,hasher:Q,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n,i=this.cfg,r=i.hasher.create(),s=Ci.create(),o=s.words,a=i.keySize,c=i.iterations;o.length<a;){n&&r.update(n),n=r.update(t).finalize(e),r.reset();for(var l=1;l<c;l++)n=r.finalize(n),r.reset();s.concat(n)}return s.sigBytes=4*a,s}}),P.EvpKDF=function(t,e,n){return Mi.create(n).compute(t,e)},R.EvpKDF,function(t){function e(t){return"string"==typeof t?p:m}function n(t,e,n){var i,r=this._iv;r?(i=r,this._iv=void 0):i=this._prevBlock;for(var s=0;s<n;s++)t[e+s]^=i[s]}var i,r,o,s,a,c,l,h,u,d,m,p;t.lib.Cipher||(i=(t=t).lib,r=i.Base,o=i.WordArray,s=i.BufferedBlockAlgorithm,(a=t.enc).Utf8,c=a.Base64,l=t.algo.EvpKDF,h=i.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(r){return{encrypt:function(t,n,i){return e(n).encrypt(r,t,n,i)},decrypt:function(t,n,i){return e(n).decrypt(r,t,n,i)}}}}),i.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),a=t.mode={},u=i.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),u=a.CBC=((a=u.extend()).Encryptor=a.extend({processBlock:function(t,e){var i=this._cipher,r=i.blockSize;n.call(this,t,e,r),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),a.Decryptor=a.extend({processBlock:function(t,e){var i=this._cipher,r=i.blockSize,s=t.slice(e,e+r);i.decryptBlock(t,e),n.call(this,t,e,r),this._prevBlock=s}}),a),a=(t.pad={}).Pkcs7={pad:function(t,e){for(var e=4*e,n=e-t.sigBytes%e,i=n<<24|n<<16|n<<8|n,r=[],s=0;s<n;s+=4)r.push(i);e=o.create(r,n);t.concat(e)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:u,padding:a}),reset:function(){h.reset.call(this);var t,e=this.cfg,n=e.iv,e=e.mode;this._xformMode==this._ENC_XFORM_MODE?t=e.createEncryptor:(t=e.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,n&&n.words):(this._mode=t.call(e,this,n&&n.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t,e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:4}),d=i.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),u=(t.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,t=t.salt;return(t?o.create([1398893684,1701076831]).concat(t).concat(e):e).toString(c)},parse:function(t){var e,t=c.parse(t),n=t.words;return 1398893684==n[0]&&1701076831==n[1]&&(e=o.create(n.slice(2,4)),n.splice(0,4),t.sigBytes-=16),d.create({ciphertext:t,salt:e})}},m=i.SerializableCipher=r.extend({cfg:r.extend({format:u}),encrypt:function(t,e,n,i){i=this.cfg.extend(i);var r=t.createEncryptor(n,i),e=r.finalize(e),r=r.cfg;return d.create({ciphertext:e,key:n,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(n,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),a=(t.kdf={}).OpenSSL={execute:function(t,e,n,i){i=i||o.random(8);t=l.create({keySize:e+n}).compute(t,i),n=o.create(t.words.slice(e),4*n);return t.sigBytes=4*e,d.create({key:t,iv:n,salt:i})}},p=i.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:a}),encrypt:function(t,e,n,i){n=(i=this.cfg.extend(i)).kdf.execute(n,t.keySize,t.ivSize),i.iv=n.iv,t=m.encrypt.call(this,t,e,n.key,i);return t.mixIn(n),t},decrypt:function(t,e,n,i){i=this.cfg.extend(i),e=this._parse(e,i.format);n=i.kdf.execute(n,t.keySize,t.ivSize,e.salt);return i.iv=n.iv,m.decrypt.call(this,t,e,n.key,i)}}))}(I.exports),{exports:{}}.exports=function(t){for(var e=t,n=e.lib.BlockCipher,i=e.algo,l=[],r=[],s=[],o=[],a=[],c=[],h=[],u=[],d=[],m=[],p=[],f=0;f<256;f++)p[f]=f<128?f<<1:f<<1^283;for(var y=0,b=0,f=0;f<256;f++){var v=b^b<<1^b<<2^b<<3^b<<4,g=(l[y]=v=v>>>8^255&v^99,p[r[v]=y]),Z=p[g],w=p[Z],X=257*p[v]^16843008*v;s[y]=X<<24|X>>>8,o[y]=X<<16|X>>>16,a[y]=X<<8|X>>>24,c[y]=X,h[v]=(X=16843009*w^65537*Z^257*g^16843008*y)<<24|X>>>8,u[v]=X<<16|X>>>16,d[v]=X<<8|X>>>24,m[v]=X,y?(y=g^p[p[p[w^g]]],b^=p[p[b]]):y=b=1}var L=[0,1,2,4,8,16,32,64,128,27,54],i=i.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,n=t.sigBytes/4,i=4*(1+(this._nRounds=6+n)),r=this._keySchedule=[],s=0;s<i;s++)s<n?r[s]=e[s]:(c=r[s-1],s%n?6<n&&s%n==4&&(c=l[c>>>24]<<24|l[c>>>16&255]<<16|l[c>>>8&255]<<8|l[255&c]):(c=l[(c=c<<8|c>>>24)>>>24]<<24|l[c>>>16&255]<<16|l[c>>>8&255]<<8|l[255&c],c^=L[s/n|0]<<24),r[s]=r[s-n]^c);for(var o=this._invKeySchedule=[],a=0;a<i;a++){var s=i-a,c=a%4?r[s]:r[s-4];o[a]=a<4||s<=4?c:h[l[c>>>24]]^u[l[c>>>16&255]]^d[l[c>>>8&255]]^m[l[255&c]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,c,l)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,h,u,d,m,r),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,i,r,s,o,a){for(var c=this._nRounds,l=t[e]^n[0],h=t[e+1]^n[1],u=t[e+2]^n[2],d=t[e+3]^n[3],m=4,p=1;p<c;p++)var f=i[l>>>24]^r[h>>>16&255]^s[u>>>8&255]^o[255&d]^n[m++],y=i[h>>>24]^r[u>>>16&255]^s[d>>>8&255]^o[255&l]^n[m++],b=i[u>>>24]^r[d>>>16&255]^s[l>>>8&255]^o[255&h]^n[m++],v=i[d>>>24]^r[l>>>16&255]^s[h>>>8&255]^o[255&u]^n[m++],l=f,h=y,u=b,d=v;f=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^n[m++],y=(a[h>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^n[m++],b=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[m++],v=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&u])^n[m++],t[e]=f,t[e+1]=y,t[e+2]=b,t[e+3]=v},keySize:8});return e.AES=n._createHelper(i),t.AES}(I.exports)),_i={exports:{}}.exports=I.exports.HmacSHA256;function mo(t){for(var e=t.length;0<=--e;)t[e]=0}var Ni=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Fi=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Hi=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),zi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ei=new Array(576),ji=(mo(Ei),new Array(60)),Ji=(mo(ji),new Array(512)),Ui=(mo(Ji),new Array(256)),Oi=(mo(Ui),new Array(29));mo(Oi);var Bi,Ai,qi,$i=new Array(30);function Wo(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function Co(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}mo($i);function u2(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function w2(t){for(var e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function x2(t){8<t.bi_valid?er(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function y2(t,e,n,i){var r=2*e,s=2*n;return t[r]<t[s]||t[r]===t[s]&&i[e]<=i[n]}function A2(t,e,n){var i,r,s,o,a=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*a]<<8|t.pending_buf[t.d_buf+2*a+1],r=t.pending_buf[t.l_buf+a],a++,0==i?nr(t,r,e):(s=Ui[r],nr(t,s+256+1,e),0!==(o=Ni[s])&&(r-=Oi[s],B(t,r,o)),s=tr(--i),nr(t,s,n),0!==(o=Fi[s])&&(i-=$i[s],B(t,i,o))),a<t.last_lit;);nr(t,256,e)}function B2(t,e){var n,i,r,s=e.dyn_tree,o=e.stat_desc.static_tree,a=e.stat_desc.has_stree,c=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<c;n++)0!==s[2*n]?(t.heap[++t.heap_len]=l=n,t.depth[n]=0):s[2*n+1]=0;for(;t.heap_len<2;)s[2*(r=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[r]=0,t.opt_len--,a&&(t.static_len-=o[2*r+1]);for(e.max_code=l,n=t.heap_len>>1;1<=n;n--)rr(t,s,n);for(r=c;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],rr(t,s,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,s[2*r]=s[2*n]+s[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,s[2*n+1]=s[2*i+1]=r,t.heap[1]=r++,rr(t,s,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1];for(var h,u,d,m,p,f=t,y=e.dyn_tree,b=e.max_code,v=e.stat_desc.static_tree,g=e.stat_desc.has_stree,Z=e.stat_desc.extra_bits,w=e.stat_desc.extra_base,X=e.stat_desc.max_length,L=0,x=0;x<=15;x++)f.bl_count[x]=0;for(y[2*f.heap[f.heap_max]+1]=0,h=f.heap_max+1;h<573;h++)(x=y[2*y[2*(u=f.heap[h])+1]+1]+1)>X&&(x=X,L++),y[2*u+1]=x,b<u||(f.bl_count[x]++,m=0,w<=u&&(m=Z[u-w]),p=y[2*u],f.opt_len+=p*(x+m),g&&(f.static_len+=p*(v[2*u+1]+m)));if(0!==L){do{for(x=X-1;0===f.bl_count[x];)x--}while(f.bl_count[x]--,f.bl_count[x+1]+=2,f.bl_count[X]--,0<(L-=2));for(x=X;0!==x;x--)for(u=f.bl_count[x];0!==u;)(d=f.heap[--h])>b||(y[2*d+1]!==x&&(f.opt_len+=(x-y[2*d+1])*y[2*d],y[2*d+1]=x),u--)}ir(s,l,t.bl_count)}function C2(t,e,n){var i,r,s=-1,o=e[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=e[2*(i+1)+1],++a<c&&r===o||(a<l?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=r,l=(a=0)===o?(c=138,3):r===o?(c=6,3):(c=7,4))}function D2(t,e,n){var i,r,s=-1,o=e[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),i=0;i<=n;i++)if(r=o,o=e[2*(i+1)+1],!(++a<c&&r===o)){if(a<l)for(;nr(t,r,t.bl_tree),0!=--a;);else 0!==r?(r!==s&&(nr(t,r,t.bl_tree),a--),nr(t,16,t.bl_tree),B(t,a-3,2)):a<=10?(nr(t,17,t.bl_tree),B(t,a-3,3)):(nr(t,18,t.bl_tree),B(t,a-11,7));s=r,l=(a=0)===o?(c=138,3):r===o?(c=6,3):(c=7,4)}}function F2(t,e,n,i){B(t,0+(i?1:0),3),i=e,e=n,x2(n=t),er(n,e),er(n,~e),n.pending_buf.set(n.window.subarray(i,i+e),n.pending),n.pending+=e}function I2(t,e,n,i){for(var r=65535&t|0,s=t>>>16&65535|0,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;s=s+(r=r+e[i++]|0)|0,--o;);r%=65521,s%=65521}return r|s<<16|0}function K2(t,e,n,i){var r=or,s=i+n;t^=-1;for(var o=i;o<s;o++)t=t>>>8^r[255&(t^e[o])];return-1^t}function id(t,e){return t.msg=ar[e],e}function jd(t){return(t<<1)-(4<t?9:0)}function ld(t,e,n){return(e<<t.hash_shift^n)&t.hash_mask}function md(t){var e=t.state,n=e.pending;0!==(n=n>t.avail_out?t.avail_out:n)&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending)&&(e.pending_out=0)}function nd(t,e){hr(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,md(t.strm)}function od(t,e){t.pending_buf[t.pending++]=e}function pd(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function qd(t,e){var n,i,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,l=t.window,h=t.w_mask,u=t.prev,d=t.strstart+258,m=l[s+o-1],p=l[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(l[(n=e)+o]===p&&l[n+o-1]===m&&l[n]===l[s]&&l[++n]===l[s+1]){for(s+=2,n++;l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<d;);if(i=258-(d-s),s=d-258,o<i){if(t.match_start=e,a<=(o=i))break;m=l[s+o-1],p=l[s+o]}}}while((e=u[e&h])>c&&0!=--r);return o<=t.lookahead?o:t.lookahead}function rd(t){var e,n,i,r,s,o,a,c,l,h=t.w_size;do{if(c=t.window_size-t.lookahead-t.strstart,t.strstart>=h+(h-262)){for(t.window.set(t.window.subarray(h,h+h),0),t.match_start-=h,t.strstart-=h,t.block_start-=h,e=n=t.hash_size;i=t.head[--e],t.head[e]=h<=i?i-h:0,--n;);for(e=n=h;i=t.prev[--e],t.prev[e]=h<=i?i-h:0,--n;);c+=h}if(0===t.strm.avail_in)break;if(s=t.strm,o=t.window,a=t.strstart+t.lookahead,c=c,l=void 0,n=0===(l=(l=s.avail_in)>c?c:l)?0:(s.avail_in-=l,o.set(s.input.subarray(s.next_in,s.next_in+l),a),1===s.state.wrap?s.adler=I2(s.adler,o,l,a):2===s.state.wrap&&(s.adler=K2(s.adler,o,l,a)),s.next_in+=l,s.total_in+=l,l),t.lookahead+=n,3<=t.lookahead+t.insert)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=ld(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=ld(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function sd(t,e){for(var n,i;;){if(t.lookahead<262){if(rd(t),t.lookahead<262&&e===mr)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=ld(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=qd(t,n)),3<=t.match_length)if(i=ur(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&3<=t.lookahead){for(t.match_length--;t.strstart++,t.ins_h=ld(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ld(t,t.ins_h,t.window[t.strstart+1]);else i=ur(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(nd(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===yr?(nd(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(nd(t,!1),0===t.strm.avail_out)?1:2}function td(t,e){for(var n,i,r;;){if(t.lookahead<262){if(rd(t),t.lookahead<262&&e===mr)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=ld(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=qd(t,n),t.match_length<=5)&&(t.strategy===xr||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2),3<=t.prev_length&&t.match_length<=t.prev_length){for(r=t.strstart+t.lookahead-3,i=ur(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=r&&(t.ins_h=ld(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(nd(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=ur(t,0,t.window[t.strstart-1]))&&nd(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=ur(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===yr?(nd(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(nd(t,!1),0===t.strm.avail_out)?1:2}var tr=function(t){return t<256?Ji[t]:Ji[256+(t>>>7)]},er=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},B=function(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,er(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},nr=function(t,e,n){B(t,n[2*e],n[2*e+1])},ir=function(t,e,n){for(var i,r=new Array(16),s=0,o=1;o<=15;o++)r[o]=s=s+n[o-1]<<1;for(i=0;i<=e;i++){var a=t[2*i+1];0!==a&&(t[2*i]=u2(r[a]++,a))}},rr=function(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&y2(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!y2(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},sr=!1,A=function(t){if(!sr){for(var e,n,i,r=new Array(16),s=0,o=0;o<28;o++)for(Oi[o]=s,e=0;e<1<<Ni[o];e++)Ui[s++]=o;for(Ui[s-1]=o,o=i=0;o<16;o++)for($i[o]=i,e=0;e<1<<Fi[o];e++)Ji[i++]=o;for(i>>=7;o<30;o++)for($i[o]=i<<7,e=0;e<1<<Fi[o]-7;e++)Ji[256+i++]=o;for(n=0;n<=15;n++)r[n]=0;for(e=0;e<=143;)Ei[2*e+1]=8,e++,r[8]++;for(;e<=255;)Ei[2*e+1]=9,e++,r[9]++;for(;e<=279;)Ei[2*e+1]=7,e++,r[7]++;for(;e<=287;)Ei[2*e+1]=8,e++,r[8]++;for(ir(Ei,287,r),e=0;e<30;e++)ji[2*e+1]=5,ji[2*e]=u2(e,5);Bi=new Wo(Ei,Ni,257,286,15),Ai=new Wo(ji,Fi,0,30,15),qi=new Wo(new Array(0),Hi,0,19,7),sr=!0}t.l_desc=new Co(t.dyn_ltree,Bi),t.d_desc=new Co(t.dyn_dtree,Ai),t.bl_desc=new Co(t.bl_tree,qi),t.bi_buf=0,t.bi_valid=0,w2(t)},U=F2,Q=function(t,e,n,i){var r,s,o,a=0;if(0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,n=0;n<=31;n++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*n])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==t.dyn_ltree[2*n])return 1;return 0}(t)),B2(t,t.l_desc),B2(t,t.d_desc),a=function(t){var e;for(C2(t,t.dyn_ltree,t.l_desc.max_code),C2(t,t.dyn_dtree,t.d_desc.max_code),B2(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*zi[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==e)F2(t,e,n,i);else if(4===t.strategy||s===r)B(t,2+(i?1:0),3),A2(t,Ei,ji);else{B(t,4+(i?1:0),3);var c=t,l=(e=t.l_desc.max_code+1,n=t.d_desc.max_code+1,a+1);for(B(c,e-257,5),B(c,n-1,5),B(c,l-4,4),o=0;o<l;o++)B(c,c.bl_tree[2*zi[o]+1],3);D2(c,c.dyn_ltree,e-1),D2(c,c.dyn_dtree,n-1),A2(t,t.dyn_ltree,t.dyn_dtree)}w2(t),i&&x2(t)},P=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(Ui[n]+256+1)]++,t.dyn_dtree[2*tr(e)]++),t.last_lit===t.lit_bufsize-1},R=function(t){B(t,2,3),nr(t,256,Ei),16===(t=t).bi_valid?(er(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},or=new Uint32Array(function(){for(var t=[],e=0;e<256;e++){for(var n=e,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}()),ar={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},I={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},cr=A,lr=U,hr=Q,ur=P,dr=R,mr=I.Z_NO_FLUSH,pr=I.Z_PARTIAL_FLUSH,fr=I.Z_FULL_FLUSH,yr=I.Z_FINISH,br=I.Z_BLOCK,vr=I.Z_OK,gr=I.Z_STREAM_END,Zr=I.Z_STREAM_ERROR,wr=I.Z_DATA_ERROR,Xr=I.Z_BUF_ERROR,Lr=I.Z_DEFAULT_COMPRESSION,xr=I.Z_FILTERED,kr=I.Z_HUFFMAN_ONLY,Gr=I.Z_RLE,Sr=I.Z_FIXED,Wr=I.Z_UNKNOWN,Tr=I.Z_DEFLATED,Cr=function(t){for(var e=t.length;0<=--e;)t[e]=0};function Vs(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}var Mr=[new Vs(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(rd(t),0===t.lookahead&&e===mr)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,nd(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(nd(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===yr?(nd(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(nd(t,!1),t.strm.avail_out),1)}),new Vs(4,4,8,4,sd),new Vs(4,5,16,8,sd),new Vs(4,6,32,32,sd),new Vs(4,4,16,16,td),new Vs(8,16,32,32,td),new Vs(8,16,128,128,td),new Vs(8,32,128,256,td),new Vs(32,128,258,1024,td),new Vs(32,258,258,4096,td)];function Is(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Tr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Cr(this.dyn_ltree),Cr(this.dyn_dtree),Cr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Cr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Cr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function wd(t){var e=Rr(t);return e===vr&&((t=t.state).window_size=2*t.w_size,Cr(t.head),t.max_lazy_match=Mr[t.level].max_lazy,t.good_match=Mr[t.level].good_length,t.nice_match=Mr[t.level].nice_length,t.max_chain_length=Mr[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),e}function xd(t,e,n,i,r,s){if(!t)return Zr;var o=1;if(e===Lr&&(e=6),i<0?(o=0,i=-i):15<i&&(o=2,i-=16),r<1||9<r||n!==Tr||i<8||15<i||e<0||9<e||s<0||Sr<s)return id(t,Zr);8===i&&(i=9);var a=new Is;return(t.state=a).strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=+a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=s,a.method=n,wd(t)}function Ad(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!==n(i))throw new TypeError(i+"must be non-object");for(var r in i)_r(i,r)&&(t[r]=i[r])}}return t}function Bd(t){for(var e=0,n=0,i=t.length;n<i;n++)e+=t[n].length;for(var r=new Uint8Array(e),s=0,o=0,a=t.length;s<a;s++){var c=t[s];r.set(c,o),o+=c.length}return r}var Rr=function(t){if(!t||!t.state)return id(t,Zr);t.total_in=t.total_out=0,t.data_type=Wr;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=mr,cr(e),vr},Yr=xd,Kr=function(t,e){return!t||!t.state||2!==t.state.wrap?Zr:(t.state.gzhead=e,vr)},Pr=function(t,e){var n,i;if(!t||!t.state||br<e||e<0)return t?id(t,Zr):Zr;var r=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===r.status&&e!==yr)return id(t,0===t.avail_out?Xr:Zr);r.strm=t;var s=r.last_flush;if(r.last_flush=e,42===r.status&&(2===r.wrap?(t.adler=0,od(r,31),od(r,139),od(r,8),r.gzhead?(od(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),od(r,255&r.gzhead.time),od(r,r.gzhead.time>>8&255),od(r,r.gzhead.time>>16&255),od(r,r.gzhead.time>>24&255),od(r,9===r.level?2:r.strategy>=kr||r.level<2?4:0),od(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(od(r,255&r.gzhead.extra.length),od(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=K2(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(od(r,0),od(r,0),od(r,0),od(r,0),od(r,0),od(r,9===r.level?2:r.strategy>=kr||r.level<2?4:0),od(r,3),r.status=113)):(o=Tr+(r.w_bits-8<<4)<<8,o|=(r.strategy>=kr||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(o|=32),o+=31-o%31,r.status=113,pd(r,o),0!==r.strstart&&(pd(r,t.adler>>>16),pd(r,65535&t.adler)),t.adler=1)),69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),md(t),n=r.pending,r.pending!==r.pending_buf_size));)od(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),md(t),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}}while(i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,od(r,i),0!==i);r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),md(t),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}}while(i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,od(r,i),0!==i);r.gzhead.hcrc&&r.pending>n&&(t.adler=K2(t.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&md(t),r.pending+2<=r.pending_buf_size&&(od(r,255&t.adler),od(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(md(t),0===t.avail_out)return r.last_flush=-1,vr}else if(0===t.avail_in&&jd(e)<=jd(s)&&e!==yr)return id(t,Xr);if(666===r.status&&0!==t.avail_in)return id(t,Xr);if(0!==t.avail_in||0!==r.lookahead||e!==mr&&666!==r.status){var o=r.strategy===kr?function(t,e){for(var n;;){if(0===t.lookahead&&(rd(t),0===t.lookahead)){if(e===mr)return 1;break}if(t.match_length=0,n=ur(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(nd(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===yr?(nd(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(nd(t,!1),0===t.strm.avail_out)?1:2}(r,e):r.strategy===Gr?function(t,e){for(var n,i,r,s,o=t.window;;){if(t.lookahead<=258){if(rd(t),t.lookahead<=258&&e===mr)return 1;if(0===t.lookahead)break}if(t.match_length=0,3<=t.lookahead&&0<t.strstart&&(i=o[r=t.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){for(s=t.strstart+258;i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s;);t.match_length=258-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(3<=t.match_length?(n=ur(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=ur(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(nd(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===yr?(nd(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(nd(t,!1),0===t.strm.avail_out)?1:2}(r,e):Mr[r.level].func(r,e);if(3!==o&&4!==o||(r.status=666),1===o||3===o)return 0===t.avail_out&&(r.last_flush=-1),vr;if(2===o&&(e===pr?dr(r):e!==br&&(lr(r,0,0,!1),e===fr)&&(Cr(r.head),0===r.lookahead)&&(r.strstart=0,r.block_start=0,r.insert=0),md(t),0===t.avail_out))return r.last_flush=-1,vr}return e!==yr||!(r.wrap<=0)&&(2===r.wrap?(od(r,255&t.adler),od(r,t.adler>>8&255),od(r,t.adler>>16&255),od(r,t.adler>>24&255),od(r,255&t.total_in),od(r,t.total_in>>8&255),od(r,t.total_in>>16&255),od(r,t.total_in>>24&255)):(pd(r,t.adler>>>16),pd(r,65535&t.adler)),md(t),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending)?vr:gr},Ir=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?id(t,Zr):(t.state=null,113===e?id(t,wr):vr):Zr},Vr=function(t,e){var n=e.length;if(!t||!t.state)return Zr;var i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Zr;1===r&&(t.adler=I2(t.adler,e,n,0)),i.wrap=0,n>=i.w_size&&(0===r&&(Cr(i.head),i.strstart=0,i.block_start=0,i.insert=0),(s=new Uint8Array(i.w_size)).set(e.subarray(n-i.w_size,n),0),e=s,n=i.w_size);var s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,rd(i);3<=i.lookahead;){for(var c=i.strstart,l=i.lookahead-2;i.ins_h=ld(i,i.ins_h,i.window[c+3-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++,--l;);i.strstart=c,i.lookahead=2,rd(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,i.wrap=r,vr},_r=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Nr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Nr=!1}for(var Fr=new Uint8Array(256),Hr=0;Hr<256;Hr++)Fr[Hr]=252<=Hr?6:248<=Hr?5:240<=Hr?4:224<=Hr?3:192<=Hr?2:1;Fr[254]=Fr[254]=1;function Fd(t){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);for(var e,n,i,r,s=t.length,o=0,a=0;a<s;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),a=r=0;r<o;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?e[r++]=n:(n<2048?e[r++]=192|n>>>6:(n<65536?e[r++]=224|n>>>12:(e[r++]=240|n>>>18,e[r++]=128|n>>>12&63),e[r++]=128|n>>>6&63),e[r++]=128|63&n);return e}function Id(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zr=Object.prototype.toString,Er=I.Z_NO_FLUSH,jr=I.Z_SYNC_FLUSH,Jr=I.Z_FULL_FLUSH,Ur=I.Z_FINISH,Qr=I.Z_OK,Br=I.Z_STREAM_END,Ar=I.Z_DEFAULT_COMPRESSION,qr=I.Z_DEFAULT_STRATEGY,$r=I.Z_DEFLATED;function aa(t){this.options=Ad({level:Ar,method:$r,chunkSize:16384,windowBits:15,memLevel:8,strategy:qr},t||{});var t=this.options,e=(t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Id,this.strm.avail_out=0,Yr(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy));if(e!==Qr)throw new Error(ar[e]);if(t.header&&Kr(this.strm,t.header),t.dictionary){t="string"==typeof t.dictionary?Fd(t.dictionary):"[object ArrayBuffer]"===zr.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary;if((e=Vr(this.strm,t))!==Qr)throw new Error(ar[e]);this._dict_set=!0}}function ca(t,e){e=new aa(e);if(e.push(t,!0),e.err)throw e.msg||ar[e.err];return e.result}aa.prototype.push=function(t,e){var n,i,r=this.strm,s=this.options.chunkSize;if(this.ended)return!1;for(i=e===~~e?e:!0===e?Ur:Er,"string"==typeof t?r.input=Fd(t):"[object ArrayBuffer]"===zr.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(i===jr||i===Jr)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(Pr(r,i)===Br)return 0<r.next_out&&this.onData(r.output.subarray(0,r.next_out)),n=Ir(this.strm),this.onEnd(n),this.ended=!0,n===Qr;if(0!==r.avail_out){if(0<i&&0<r.next_out)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},aa.prototype.onData=function(t){this.chunks.push(t)},aa.prototype.onEnd=function(t){t===Qr&&(this.result=Bd(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function j3(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}var A={Deflate:aa,deflate:ca,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ca(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ca(t,e)},constants:I},ts=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),es=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),is=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rs=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ss=function(t,e,n,i,r,s,o,a){for(var c,l,h,u,d,m,p,f,y,b=a.bits,v=0,g=0,Z=0,w=0,X=0,L=0,x=0,k=0,G=0,S=0,W=null,T=0,C=new Uint16Array(16),M=new Uint16Array(16),R=null,Y=0,v=0;v<=15;v++)C[v]=0;for(g=0;g<i;g++)C[e[n+g]]++;for(X=b,w=15;1<=w&&0===C[w];w--);if(w<X&&(X=w),0===w)r[s++]=20971520,r[s++]=20971520,a.bits=1;else{for(Z=1;Z<w&&0===C[Z];Z++);for(X<Z&&(X=Z),v=k=1;v<=15;v++)if((k=(k<<1)-C[v])<0)return-1;if(0<k&&(0===t||1!==w))return-1;for(M[1]=0,v=1;v<15;v++)M[v+1]=M[v]+C[v];for(g=0;g<i;g++)0!==e[n+g]&&(o[M[e[n+g]]++]=g);if(m=0===t?(W=R=o,19):1===t?(W=ts,T-=257,R=es,Y-=257,256):(W=is,R=rs,-1),v=Z,d=s,x=g=S=0,h=-1,u=(G=1<<(L=X))-1,1===t&&852<G||2===t&&592<G)return 1;for(;;){for(y=o[g]<m?(f=0,o[g]):o[g]>m?(f=R[Y+o[g]],W[T+o[g]]):(f=96,0),c=1<<(p=v-x),Z=l=1<<L;r[d+(S>>x)+(l-=c)]=p<<24|f<<16|y|0,0!==l;);for(c=1<<v-1;S&c;)c>>=1;if(0!==c?S=(S&c-1)+c:S=0,g++,0==--C[v]){if(v===w)break;v=e[n+o[g]]}if(X<v&&(S&u)!==h){for(d+=Z,k=1<<(L=v-(x=0===x?X:x));L+x<w&&!((k-=C[L+x])<=0);)L++,k<<=1;if(G+=1<<L,1===t&&852<G||2===t&&592<G)return 1;r[h=S&u]=X<<24|L<<16|d-s|0}}0!==S&&(r[d+S]=v-x<<24|64<<16|0),a.bits=X}return 0},os=I.Z_FINISH,as=I.Z_BLOCK,cs=I.Z_TREES,ls=I.Z_OK,hs=I.Z_STREAM_END,us=I.Z_NEED_DICT,ds=I.Z_STREAM_ERROR,ms=I.Z_DATA_ERROR,ps=I.Z_MEM_ERROR,fs=I.Z_BUF_ERROR,ys=I.Z_DEFLATED;function Wa(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function m3(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,ls):ds}function n3(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,m3(t)):ds}function o3(t,e){var n,i;return!t||!t.state||(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e))?ds:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,n3(t))}function p3(t,e){var n;return t?(n=new Wa,(t.state=n).window=null,(n=o3(t,e))!==ls&&(t.state=null),n):ds}function s3(t,e,n,i){var r;return null===(t=t.state).window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new Uint8Array(t.wsize)),i>=t.wsize?(t.window.set(e.subarray(n-t.wsize,n),0),t.wnext=0,t.whave=t.wsize):((r=t.wsize-t.wnext)>i&&(r=i),t.window.set(e.subarray(n-i,n-i+r),t.wnext),(i-=r)?(t.window.set(e.subarray(n-i,n),0),t.wnext=i,t.whave=t.wsize):(t.wnext+=r,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=r))),0}function v3(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var bs,vs,gs=!0,Zs=n3,ws=p3,Xs=function(t,I){var e,n,V,i,r,s,o,a,c,_,l,h,N,F,u,d,m,p,H,z,f,y,b,v,g=0,Z=new Uint8Array(4),E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return ds;12===(e=t.state).mode&&(e.mode=13),r=t.next_out,V=t.output,o=t.avail_out,i=t.next_in,n=t.input,s=t.avail_in,a=e.hold,c=e.bits,_=s,l=o,y=ls;t:for(;;)switch(e.mode){case 1:if(0===e.wrap)e.mode=13;else{for(;c<16;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(2&e.wrap&&35615===a)Z[e.check=0]=255&a,Z[1]=a>>>8&255,e.check=K2(e.check,Z,2,0),c=a=0,e.mode=2;else if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&a)<<8)+(a>>8))%31)t.msg="incorrect header check",e.mode=30;else if((15&a)!==ys)t.msg="unknown compression method",e.mode=30;else{if(c-=4,f=8+(15&(a>>>=4)),0===e.wbits)e.wbits=f;else if(f>e.wbits){t.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,t.adler=e.check=1,e.mode=512&a?10:12,c=a=0}}break;case 2:for(;c<16;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(e.flags=a,(255&e.flags)!==ys){t.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=a>>8&1),512&e.flags&&(Z[0]=255&a,Z[1]=a>>>8&255,e.check=K2(e.check,Z,2,0)),c=a=0,e.mode=3;case 3:for(;c<32;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.head&&(e.head.time=a),512&e.flags&&(Z[0]=255&a,Z[1]=a>>>8&255,Z[2]=a>>>16&255,Z[3]=a>>>24&255,e.check=K2(e.check,Z,4,0)),c=a=0,e.mode=4;case 4:for(;c<16;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.head&&(e.head.xflags=255&a,e.head.os=a>>8),512&e.flags&&(Z[0]=255&a,Z[1]=a>>>8&255,e.check=K2(e.check,Z,2,0)),c=a=0,e.mode=5;case 5:if(1024&e.flags){for(;c<16;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.length=a,e.head&&(e.head.extra_len=a),512&e.flags&&(Z[0]=255&a,Z[1]=a>>>8&255,e.check=K2(e.check,Z,2,0)),c=a=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&((h=(h=e.length)>s?s:h)&&(e.head&&(f=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(n.subarray(i,i+h),f)),512&e.flags&&(e.check=K2(e.check,n,h,i)),s-=h,i+=h,e.length-=h),e.length))break t;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===s)break t;for(h=0;f=n[i+h++],e.head&&f&&e.length<65536&&(e.head.name+=String.fromCharCode(f)),f&&h<s;);if(512&e.flags&&(e.check=K2(e.check,n,h,i)),s-=h,i+=h,f)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===s)break t;for(h=0;f=n[i+h++],e.head&&f&&e.length<65536&&(e.head.comment+=String.fromCharCode(f)),f&&h<s;);if(512&e.flags&&(e.check=K2(e.check,n,h,i)),s-=h,i+=h,f)break t}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;c<16;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(a!==(65535&e.check)){t.msg="header crc mismatch",e.mode=30;break}c=a=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=12;break;case 10:for(;c<32;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}t.adler=e.check=j3(a),c=a=0,e.mode=11;case 11:if(0===e.havedict)return t.next_out=r,t.avail_out=o,t.next_in=i,t.avail_in=s,e.hold=a,e.bits=c,us;t.adler=e.check=1,e.mode=12;case 12:if(I===as||I===cs)break t;case 13:if(e.last)a>>>=7&c,c-=7&c,e.mode=27;else{for(;c<3;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}switch(e.last=1&a,--c,3&(a>>>=1)){case 0:e.mode=14;break;case 1:X=void 0;var w=e;if(gs){bs=new Int32Array(512),vs=new Int32Array(32);for(var X=0;X<144;)w.lens[X++]=8;for(;X<256;)w.lens[X++]=9;for(;X<280;)w.lens[X++]=7;for(;X<288;)w.lens[X++]=8;for(ss(1,w.lens,0,288,bs,0,w.work,{bits:9}),X=0;X<32;)w.lens[X++]=5;ss(2,w.lens,0,32,vs,0,w.work,{bits:5}),gs=!1}if(w.lencode=bs,w.lenbits=9,w.distcode=vs,w.distbits=5,e.mode=20,I!==cs)break;a>>>=2,c-=2;break t;case 2:e.mode=17;break;case 3:t.msg="invalid block type",e.mode=30}a>>>=2,c-=2}break;case 14:for(a>>>=7&c,c-=7&c;c<32;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if((65535&a)!=(a>>>16^65535)){t.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&a,c=a=0,e.mode=15,I===cs)break t;case 15:e.mode=16;case 16:if(h=e.length){if(0===(h=o<(h=s<h?s:h)?o:h))break t;V.set(n.subarray(i,i+h),r),s-=h,i+=h,o-=h,r+=h,e.length-=h}else e.mode=12;break;case 17:for(;c<14;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(e.nlen=257+(31&a),a>>>=5,c-=5,e.ndist=1+(31&a),a>>>=5,c-=5,e.ncode=4+(15&a),a>>>=4,c-=4,286<e.nlen||30<e.ndist){t.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;c<3;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.lens[E[e.have++]]=7&a,a>>>=3,c-=3}for(;e.have<19;)e.lens[E[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,b={bits:e.lenbits},y=ss(0,e.lens,0,19,e.lencode,0,e.work,b),e.lenbits=b.bits,y){t.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;d=(g=e.lencode[a&(1<<e.lenbits)-1])>>>16&255,m=65535&g,!((u=g>>>24)<=c);){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(m<16)a>>>=u,c-=u,e.lens[e.have++]=m;else{if(16===m){for(v=u+2;c<v;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(a>>>=u,c-=u,0===e.have){t.msg="invalid bit length repeat",e.mode=30;break}f=e.lens[e.have-1],h=3+(3&a),a>>>=2,c-=2}else if(17===m){for(v=u+3;c<v;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}f=0,h=3+(7&(a>>>=u)),a>>>=3,c=c-u-3}else{for(v=u+7;c<v;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}f=0,h=11+(127&(a>>>=u)),a>>>=7,c=c-u-7}if(e.have+h>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=30;break}for(;h--;)e.lens[e.have++]=f}}if(30===e.mode)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,b={bits:e.lenbits},y=ss(1,e.lens,0,e.nlen,e.lencode,0,e.work,b),e.lenbits=b.bits,y){t.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,b={bits:e.distbits},y=ss(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,b),e.distbits=b.bits,y){t.msg="invalid distances set",e.mode=30;break}if(e.mode=20,I===cs)break t;case 20:e.mode=21;case 21:if(6<=s&&258<=o){t.next_out=r,t.avail_out=o,t.next_in=i,t.avail_in=s,e.hold=a,e.bits=c,C=Y=J=W=S=G=k=x=L=it=nt=et=tt=P=K=$=q=A=B=O=D=Q=R=U=M=void 0;var L,x,k,G,S,W,T=t,j=l,C=T.state,M=T.next_in,J=T.input,U=M+(T.avail_in-5),R=T.next_out,Y=T.output,Q=R-(j-T.avail_out),D=R+(T.avail_out-257),O=C.dmax,B=C.wsize,A=C.whave,q=C.wnext,$=C.window,K=C.hold,P=C.bits,tt=C.lencode,et=C.distcode,nt=(1<<C.lenbits)-1,it=(1<<C.distbits)-1;e:do{for(P<15&&(K+=J[M++]<<P,P+=8,K+=J[M++]<<P,P+=8),L=tt[K&nt];;){if(K>>>=x=L>>>24,P-=x,0==(x=L>>>16&255))Y[R++]=65535&L;else{if(!(16&x)){if(0==(64&x)){L=tt[(65535&L)+(K&(1<<x)-1)];continue}if(32&x){C.mode=12;break e}T.msg="invalid literal/length code",C.mode=30;break e}for(k=65535&L,(x&=15)&&(P<x&&(K+=J[M++]<<P,P+=8),k+=K&(1<<x)-1,K>>>=x,P-=x),P<15&&(K+=J[M++]<<P,P+=8,K+=J[M++]<<P,P+=8),L=et[K&it];;){if(K>>>=x=L>>>24,P-=x,!(16&(x=L>>>16&255))){if(0==(64&x)){L=et[(65535&L)+(K&(1<<x)-1)];continue}T.msg="invalid distance code",C.mode=30;break e}if(G=65535&L,P<(x&=15)&&(K+=J[M++]<<P,(P+=8)<x)&&(K+=J[M++]<<P,P+=8),(G+=K&(1<<x)-1)>O){T.msg="invalid distance too far back",C.mode=30;break e}if(K>>>=x,P-=x,G>(x=R-Q)){if((x=G-x)>A&&C.sane){T.msg="invalid distance too far back",C.mode=30;break e}if(W=$,(S=0)===q){if(S+=B-x,x<k){for(k-=x;Y[R++]=$[S++],--x;);S=R-G,W=Y}}else if(q<x){if(S+=B+q-x,(x-=q)<k){for(k-=x;Y[R++]=$[S++],--x;);if(S=0,q<k){for(k-=x=q;Y[R++]=$[S++],--x;);S=R-G,W=Y}}}else if(S+=q-x,x<k){for(k-=x;Y[R++]=$[S++],--x;);S=R-G,W=Y}for(;2<k;)Y[R++]=W[S++],Y[R++]=W[S++],Y[R++]=W[S++],k-=3;k&&(Y[R++]=W[S++],1<k)&&(Y[R++]=W[S++])}else{for(S=R-G;Y[R++]=Y[S++],Y[R++]=Y[S++],Y[R++]=Y[S++],2<(k-=3););k&&(Y[R++]=Y[S++],1<k)&&(Y[R++]=Y[S++])}break}}break}}while(M<U&&R<D);M-=k=P>>3,K&=(1<<(P-=k<<3))-1,T.next_in=M,T.next_out=R,T.avail_in=M<U?U-M+5:5-(M-U),T.avail_out=R<D?D-R+257:257-(R-D),C.hold=K,C.bits=P,r=t.next_out,V=t.output,o=t.avail_out,i=t.next_in,n=t.input,s=t.avail_in,a=e.hold,c=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;d=(g=e.lencode[a&(1<<e.lenbits)-1])>>>16&255,m=65535&g,!((u=g>>>24)<=c);){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(d&&0==(240&d)){for(p=u,H=d,z=m;d=(g=e.lencode[z+((a&(1<<p+H)-1)>>p)])>>>16&255,m=65535&g,!(p+(u=g>>>24)<=c);){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}a>>>=p,c-=p,e.back+=p}if(a>>>=u,c-=u,e.back+=u,e.length=m,0===d){e.mode=26;break}if(32&d){e.back=-1,e.mode=12;break}if(64&d){t.msg="invalid literal/length code",e.mode=30;break}e.extra=15&d,e.mode=22;case 22:if(e.extra){for(v=e.extra;c<v;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.length+=a&(1<<e.extra)-1,a>>>=e.extra,c-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;d=(g=e.distcode[a&(1<<e.distbits)-1])>>>16&255,m=65535&g,!((u=g>>>24)<=c);){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(0==(240&d)){for(p=u,H=d,z=m;d=(g=e.distcode[z+((a&(1<<p+H)-1)>>p)])>>>16&255,m=65535&g,!(p+(u=g>>>24)<=c);){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}a>>>=p,c-=p,e.back+=p}if(a>>>=u,c-=u,e.back+=u,64&d){t.msg="invalid distance code",e.mode=30;break}e.offset=m,e.extra=15&d,e.mode=24;case 24:if(e.extra){for(v=e.extra;c<v;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}e.offset+=a&(1<<e.extra)-1,a>>>=e.extra,c-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===o)break t;if(e.offset>(h=l-o)){if((h=e.offset-h)>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=30;break}N=h>e.wnext?(h-=e.wnext,e.wsize-h):e.wnext-h,h>e.length&&(h=e.length),F=e.window}else F=V,N=r-e.offset,h=e.length;for(o-=h=o<h?o:h,e.length-=h;V[r++]=F[N++],--h;);0===e.length&&(e.mode=21);break;case 26:if(0===o)break t;V[r++]=e.length,o--,e.mode=21;break;case 27:if(e.wrap){for(;c<32;){if(0===s)break t;s--,a|=n[i++]<<c,c+=8}if(l-=o,t.total_out+=l,e.total+=l,l&&(t.adler=e.check=(e.flags?K2:I2)(e.check,V,l,r-l)),l=o,(e.flags?a:j3(a))!==e.check){t.msg="incorrect data check",e.mode=30;break}c=a=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;c<32;){if(0===s)break t;s--,a+=n[i++]<<c,c+=8}if(a!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=30;break}c=a=0}e.mode=29;case 29:y=hs;break t;case 30:y=ms;break t;case 31:return ps;default:return ds}return t.next_out=r,t.avail_out=o,t.next_in=i,t.avail_in=s,e.hold=a,e.bits=c,(e.wsize||l!==t.avail_out&&e.mode<30&&(e.mode<27||I!==os))&&s3(t,t.output,t.next_out,l-t.avail_out),_-=t.avail_in,l-=t.avail_out,t.total_in+=_,t.total_out+=l,e.total+=l,e.wrap&&l&&(t.adler=e.check=(e.flags?K2:I2)(e.check,V,l,t.next_out-l)),t.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),y=(0==_&&0===l||I===os)&&y===ls?fs:y},Ls=function(t){var e;return t&&t.state?((e=t.state).window&&(e.window=null),t.state=null,ls):ds},xs=function(t,e){return!t||!t.state||0==(2&(t=t.state).wrap)?ds:((t.head=e).done=!1,ls)},ks=function(t,e){var n,i=e.length;return!t||!t.state||0!==(n=t.state).wrap&&11!==n.mode?ds:11===n.mode&&I2(1,e,i,0)!==n.check?ms:s3(t,e,i,i)?(n.mode=31,ps):(n.havedict=1,ls)},Gs=Object.prototype.toString,Ss=I.Z_NO_FLUSH,Ws=I.Z_FINISH,Ts=I.Z_OK,Cs=I.Z_STREAM_END,Ms=I.Z_NEED_DICT,Rs=I.Z_STREAM_ERROR,Ys=I.Z_DATA_ERROR,Ks=I.Z_MEM_ERROR;function Ba(t){this.options=Ad({chunkSize:65536,windowBits:15,to:""},t||{});var e=this.options,t=(e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits)&&(e.windowBits=-15),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Id,this.strm.avail_out=0,ws(this.strm,e.windowBits));if(t!==Ts)throw new Error(ar[t]);if(this.header=new v3,xs(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Fd(e.dictionary):"[object ArrayBuffer]"===Gs.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw)&&(t=ks(this.strm,e.dictionary))!==Ts)throw new Error(ar[t])}function Aa(t,e){e=new Ba(e);if(e.push(t),e.err)throw e.msg||ar[e.err];return e.result}Ba.prototype.push=function(t,e){var n,i,r=this.strm,s=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(i=e===~~e?e:!0===e?Ws:Ss,"[object ArrayBuffer]"===Gs.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(n=Xs(r,i))===Ms&&o&&((n=ks(r,o))===Ts?n=Xs(r,i):n===Ys&&(n=Ms));0<r.avail_in&&n===Cs&&0<r.state.wrap&&0!==t[r.next_in];)Zs(r),n=Xs(r,i);switch(n){case Rs:case Ys:case Ms:case Ks:return this.onEnd(n),!(this.ended=!0)}var a,c,l,h=r.avail_out;if(!r.next_out||0!==r.avail_out&&n!==Cs||("string"===this.options.to?(a=function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0||0===n)&&n+Fr[t[n]]>e?n:e}(r.output,r.next_out),c=r.next_out-a,l=function(t,e){var n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));for(var i=new Array(2*n),r=0,s=0;s<n;){var o=t[s++];if(o<128)i[r++]=o;else{var a=Fr[o];if(4<a)i[r++]=65533,s+=a-1;else{for(o&=2===a?31:3===a?15:7;1<a&&s<n;)o=o<<6|63&t[s++],a--;1<a?i[r++]=65533:o<65536?i[r++]=o:(o-=65536,i[r++]=55296|o>>10&1023,i[r++]=56320|1023&o)}}}var c=i,l=r;if(l<65534&&c.subarray&&Nr)return String.fromCharCode.apply(null,c.length===l?c:c.subarray(0,l));for(var h="",u=0;u<l;u++)h+=String.fromCharCode(c[u]);return h}(r.output,a),r.next_out=c,r.avail_out=s-c,c&&r.output.set(r.output.subarray(a,a+c),0),this.onData(l)):this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out))),n!==Ts||0!==h){if(n===Cs)return n=Ls(this.strm),this.onEnd(n),this.ended=!0;if(0===r.avail_in)break}}return!0},Ba.prototype.onData=function(t){this.chunks.push(t)},Ba.prototype.onEnd=function(t){t===Ts&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Bd(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var U={Inflate:Ba,inflate:Aa,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Aa(t,e)},ungzip:Aa,constants:I},Ps={Deflate:A.Deflate,deflate:A.deflate,deflateRaw:A.deflateRaw,gzip:A.gzip,Inflate:U.Inflate,inflate:U.inflate,inflateRaw:U.inflateRaw,ungzip:U.ungzip,constants:I};var _s,Ns=mt.CROQUET_VERSION,Fs="node"===mt.CROQUET_PLATFORM,Hs=(Fs||window.location.hostname.match(/co?de?pe?n\.io/)?console.log("Croquet "+Ns):console.log("%cCroquet%c %c"+Ns,"color:#F0493E","color:inherit","color:".concat(Ns.includes("+")?"#909":"inherit")),!Fs&&!!window.location.hostname.match(/^(.*\.)?croquet\.io$/i)&&window.location.pathname.startsWith("/dev/")),zs=!Fs&&!!window.location.hostname.match(/^(.*\.)?croquet\.dev$/i);function uc(t){var e,n=t.lastIndexOf(":"),i=-1===n?t:t.slice(n+1),t=-1===n?"":t.slice(0,n),r=M.backend||t,n=M.reflector&&M.reflector.match(/^wss?:/);if("none"===r||n)return{apiKey:i,signServer:"none",reflector:"overridden"};if(!r&&!Fs)switch(window.location.hostname){case"croquet.dev":r="dev";break;case"staging.croquet.io":r="staging"}switch(r){case"":case"prod":e="croquet.io";break;case"staging":e="staging.croquet.io";break;case"dev":e="croquet.dev";break;default:e="".concat(r,".croquet.dev")}return{apiKey:i,signServer:"https://api.".concat(e,"/sign"),reflector:"wss://api.".concat(e,"/reflector/v").concat(1)}}var Es,q=null,js=M.nocheat,Js=[0],Us=new function(t){return _s=_s||function ec(s,t,e){var t=void 0===t?null:t,n=(e=function(t){var e=atob(s);if(t){for(var n=new Uint8Array(e.length),i=0,r=e.length;i<r;++i)n[i]=e.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return e}(void 0!==e&&e)).indexOf("\n",10)+1,e=e.substring(n)+(t?"//# sourceMappingURL="+t:""),n=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(n)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwovKioKICogQ29weXJpZ2h0IENyb3F1ZXQgQ29ycG9yYXRpb24gMjAyMgogKiBCdW5kbGUgb2YgQGNyb3F1ZXQvY3JvcXVldAogKiBEYXRlOiAyMDIyLTExLTI4CiAqIFZlcnNpb246IDEuMS4wLTE0CiAqLwoKIWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHQoZSl7cmV0dXJuIHQ9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmInN5bWJvbCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/InN5bWJvbCI6dHlwZW9mIHR9LHQoZSl9ZnVuY3Rpb24gZSh0LGUscixuLGEsaSxvKXt0cnl7dmFyIHM9dFtpXShvKSxjPXMudmFsdWV9Y2F0Y2godCl7cmV0dXJuIHZvaWQgcih0KX1zLmRvbmU/ZShjKTpQcm9taXNlLnJlc29sdmUoYykudGhlbihuLGEpfWZ1bmN0aW9uIHIodCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHI9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKGEsaSl7dmFyIG89dC5hcHBseShyLG4pO2Z1bmN0aW9uIHModCl7ZShvLGEsaSxzLGMsIm5leHQiLHQpfWZ1bmN0aW9uIGModCl7ZShvLGEsaSxzLGMsInRocm93Iix0KX1zKHZvaWQgMCl9KSl9fWZ1bmN0aW9uIG4odCxlKXsobnVsbD09ZXx8ZT50Lmxlbmd0aCkmJihlPXQubGVuZ3RoKTtmb3IodmFyIHI9MCxuPW5ldyBBcnJheShlKTtyPGU7cisrKW5bcl09dFtyXTtyZXR1cm4gbn1mdW5jdGlvbiBhKHQsZSl7dmFyIHI9InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJnRbU3ltYm9sLml0ZXJhdG9yXXx8dFsiQEBpdGVyYXRvciJdO2lmKCFyKXtpZihBcnJheS5pc0FycmF5KHQpfHwocj1mdW5jdGlvbih0LGUpe2lmKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdClyZXR1cm4gbih0LGUpO3ZhciByPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KS5zbGljZSg4LC0xKTtyZXR1cm4iT2JqZWN0Ij09PXImJnQuY29uc3RydWN0b3ImJihyPXQuY29uc3RydWN0b3IubmFtZSksIk1hcCI9PT1yfHwiU2V0Ij09PXI/QXJyYXkuZnJvbSh0KToiQXJndW1lbnRzIj09PXJ8fC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KHIpP24odCxlKTp2b2lkIDB9fSh0KSl8fGUmJnQmJiJudW1iZXIiPT10eXBlb2YgdC5sZW5ndGgpe3ImJih0PXIpO3ZhciBhPTAsaT1mdW5jdGlvbigpe307cmV0dXJue3M6aSxuOmZ1bmN0aW9uKCl7cmV0dXJuIGE+PXQubGVuZ3RoP3tkb25lOiEwfTp7ZG9uZTohMSx2YWx1ZTp0W2ErK119fSxlOmZ1bmN0aW9uKHQpe3Rocm93IHR9LGY6aX19dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpfXZhciBvLHM9ITAsYz0hMTtyZXR1cm57czpmdW5jdGlvbigpe3I9ci5jYWxsKHQpfSxuOmZ1bmN0aW9uKCl7dmFyIHQ9ci5uZXh0KCk7cmV0dXJuIHM9dC5kb25lLHR9LGU6ZnVuY3Rpb24odCl7Yz0hMCxvPXR9LGY6ZnVuY3Rpb24oKXt0cnl7c3x8bnVsbD09ci5yZXR1cm58fHIucmV0dXJuKCl9ZmluYWxseXtpZihjKXRocm93IG99fX19dmFyIGk9InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWxUaGlzP2dsb2JhbFRoaXM6InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjp7fTshZnVuY3Rpb24oZSl7dmFyIHI9ZnVuY3Rpb24oZSl7dmFyIHIsbj1PYmplY3QucHJvdG90eXBlLGE9bi5oYXNPd25Qcm9wZXJ0eSxpPSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2w/U3ltYm9sOnt9LG89aS5pdGVyYXRvcnx8IkBAaXRlcmF0b3IiLHM9aS5hc3luY0l0ZXJhdG9yfHwiQEBhc3luY0l0ZXJhdG9yIixjPWkudG9TdHJpbmdUYWd8fCJAQHRvU3RyaW5nVGFnIjtmdW5jdGlvbiBoKHQsZSxyKXtyZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7dmFsdWU6cixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pLHRbZV19dHJ5e2goe30sIiIpfWNhdGNoKHQpe2g9ZnVuY3Rpb24odCxlLHIpe3JldHVybiB0W2VdPXJ9fWZ1bmN0aW9uIGwodCxlLHIsbil7dmFyIGE9ZSYmZS5wcm90b3R5cGUgaW5zdGFuY2VvZiB2P2U6dixpPU9iamVjdC5jcmVhdGUoYS5wcm90b3R5cGUpLG89bmV3IFIobnx8W10pO3JldHVybiBpLl9pbnZva2U9ZnVuY3Rpb24odCxlLHIpe3ZhciBuPWY7cmV0dXJuIGZ1bmN0aW9uKGEsaSl7aWYobj09PV8pdGhyb3cgbmV3IEVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nIik7aWYobj09PXApe2lmKCJ0aHJvdyI9PT1hKXRocm93IGk7cmV0dXJuIEwoKX1mb3Ioci5tZXRob2Q9YSxyLmFyZz1pOzspe3ZhciBvPXIuZGVsZWdhdGU7aWYobyl7dmFyIHM9RShvLHIpO2lmKHMpe2lmKHM9PT1nKWNvbnRpbnVlO3JldHVybiBzfX1pZigibmV4dCI9PT1yLm1ldGhvZClyLnNlbnQ9ci5fc2VudD1yLmFyZztlbHNlIGlmKCJ0aHJvdyI9PT1yLm1ldGhvZCl7aWYobj09PWYpdGhyb3cgbj1wLHIuYXJnO3IuZGlzcGF0Y2hFeGNlcHRpb24oci5hcmcpfWVsc2UicmV0dXJuIj09PXIubWV0aG9kJiZyLmFicnVwdCgicmV0dXJuIixyLmFyZyk7bj1fO3ZhciBjPXUodCxlLHIpO2lmKCJub3JtYWwiPT09Yy50eXBlKXtpZihuPXIuZG9uZT9wOmQsYy5hcmc9PT1nKWNvbnRpbnVlO3JldHVybnt2YWx1ZTpjLmFyZyxkb25lOnIuZG9uZX19InRocm93Ij09PWMudHlwZSYmKG49cCxyLm1ldGhvZD0idGhyb3ciLHIuYXJnPWMuYXJnKX19fSh0LHIsbyksaX1mdW5jdGlvbiB1KHQsZSxyKXt0cnl7cmV0dXJue3R5cGU6Im5vcm1hbCIsYXJnOnQuY2FsbChlLHIpfX1jYXRjaCh0KXtyZXR1cm57dHlwZToidGhyb3ciLGFyZzp0fX19ZS53cmFwPWw7dmFyIGY9InN1c3BlbmRlZFN0YXJ0IixkPSJzdXNwZW5kZWRZaWVsZCIsXz0iZXhlY3V0aW5nIixwPSJjb21wbGV0ZWQiLGc9e307ZnVuY3Rpb24gdigpe31mdW5jdGlvbiB5KCl7fWZ1bmN0aW9uIHcoKXt9dmFyIG09e307aChtLG8sKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSk7dmFyIGI9T2JqZWN0LmdldFByb3RvdHlwZU9mLHg9YiYmYihiKEQoW10pKSk7eCYmeCE9PW4mJmEuY2FsbCh4LG8pJiYobT14KTt2YXIgaz13LnByb3RvdHlwZT12LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG0pO2Z1bmN0aW9uIHoodCl7WyJuZXh0IiwidGhyb3ciLCJyZXR1cm4iXS5mb3JFYWNoKChmdW5jdGlvbihlKXtoKHQsZSwoZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2ludm9rZShlLHQpfSkpfSkpfWZ1bmN0aW9uIEEoZSxyKXtmdW5jdGlvbiBuKGksbyxzLGMpe3ZhciBoPXUoZVtpXSxlLG8pO2lmKCJ0aHJvdyIhPT1oLnR5cGUpe3ZhciBsPWguYXJnLGY9bC52YWx1ZTtyZXR1cm4gZiYmIm9iamVjdCI9PT10KGYpJiZhLmNhbGwoZiwiX19hd2FpdCIpP3IucmVzb2x2ZShmLl9fYXdhaXQpLnRoZW4oKGZ1bmN0aW9uKHQpe24oIm5leHQiLHQscyxjKX0pLChmdW5jdGlvbih0KXtuKCJ0aHJvdyIsdCxzLGMpfSkpOnIucmVzb2x2ZShmKS50aGVuKChmdW5jdGlvbih0KXtsLnZhbHVlPXQscyhsKX0pLChmdW5jdGlvbih0KXtyZXR1cm4gbigidGhyb3ciLHQscyxjKX0pKX1jKGguYXJnKX12YXIgaTt0aGlzLl9pbnZva2U9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBhKCl7cmV0dXJuIG5ldyByKChmdW5jdGlvbihyLGEpe24odCxlLHIsYSl9KSl9cmV0dXJuIGk9aT9pLnRoZW4oYSxhKTphKCl9fWZ1bmN0aW9uIEUodCxlKXt2YXIgbj10Lml0ZXJhdG9yW2UubWV0aG9kXTtpZihuPT09cil7aWYoZS5kZWxlZ2F0ZT1udWxsLCJ0aHJvdyI9PT1lLm1ldGhvZCl7aWYodC5pdGVyYXRvci5yZXR1cm4mJihlLm1ldGhvZD0icmV0dXJuIixlLmFyZz1yLEUodCxlKSwidGhyb3ciPT09ZS5tZXRob2QpKXJldHVybiBnO2UubWV0aG9kPSJ0aHJvdyIsZS5hcmc9bmV3IFR5cGVFcnJvcigiVGhlIGl0ZXJhdG9yIGRvZXMgbm90IHByb3ZpZGUgYSAndGhyb3cnIG1ldGhvZCIpfXJldHVybiBnfXZhciBhPXUobix0Lml0ZXJhdG9yLGUuYXJnKTtpZigidGhyb3ciPT09YS50eXBlKXJldHVybiBlLm1ldGhvZD0idGhyb3ciLGUuYXJnPWEuYXJnLGUuZGVsZWdhdGU9bnVsbCxnO3ZhciBpPWEuYXJnO3JldHVybiBpP2kuZG9uZT8oZVt0LnJlc3VsdE5hbWVdPWkudmFsdWUsZS5uZXh0PXQubmV4dExvYywicmV0dXJuIiE9PWUubWV0aG9kJiYoZS5tZXRob2Q9Im5leHQiLGUuYXJnPXIpLGUuZGVsZWdhdGU9bnVsbCxnKTppOihlLm1ldGhvZD0idGhyb3ciLGUuYXJnPW5ldyBUeXBlRXJyb3IoIml0ZXJhdG9yIHJlc3VsdCBpcyBub3QgYW4gb2JqZWN0IiksZS5kZWxlZ2F0ZT1udWxsLGcpfWZ1bmN0aW9uIFModCl7dmFyIGU9e3RyeUxvYzp0WzBdfTsxIGluIHQmJihlLmNhdGNoTG9jPXRbMV0pLDIgaW4gdCYmKGUuZmluYWxseUxvYz10WzJdLGUuYWZ0ZXJMb2M9dFszXSksdGhpcy50cnlFbnRyaWVzLnB1c2goZSl9ZnVuY3Rpb24gQih0KXt2YXIgZT10LmNvbXBsZXRpb258fHt9O2UudHlwZT0ibm9ybWFsIixkZWxldGUgZS5hcmcsdC5jb21wbGV0aW9uPWV9ZnVuY3Rpb24gUih0KXt0aGlzLnRyeUVudHJpZXM9W3t0cnlMb2M6InJvb3QifV0sdC5mb3JFYWNoKFMsdGhpcyksdGhpcy5yZXNldCghMCl9ZnVuY3Rpb24gRCh0KXtpZih0KXt2YXIgZT10W29dO2lmKGUpcmV0dXJuIGUuY2FsbCh0KTtpZigiZnVuY3Rpb24iPT10eXBlb2YgdC5uZXh0KXJldHVybiB0O2lmKCFpc05hTih0Lmxlbmd0aCkpe3ZhciBuPS0xLGk9ZnVuY3Rpb24gZSgpe2Zvcig7KytuPHQubGVuZ3RoOylpZihhLmNhbGwodCxuKSlyZXR1cm4gZS52YWx1ZT10W25dLGUuZG9uZT0hMSxlO3JldHVybiBlLnZhbHVlPXIsZS5kb25lPSEwLGV9O3JldHVybiBpLm5leHQ9aX19cmV0dXJue25leHQ6TH19ZnVuY3Rpb24gTCgpe3JldHVybnt2YWx1ZTpyLGRvbmU6ITB9fXJldHVybiB5LnByb3RvdHlwZT13LGgoaywiY29uc3RydWN0b3IiLHcpLGgodywiY29uc3RydWN0b3IiLHkpLHkuZGlzcGxheU5hbWU9aCh3LGMsIkdlbmVyYXRvckZ1bmN0aW9uIiksZS5pc0dlbmVyYXRvckZ1bmN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlPSJmdW5jdGlvbiI9PXR5cGVvZiB0JiZ0LmNvbnN0cnVjdG9yO3JldHVybiEhZSYmKGU9PT15fHwiR2VuZXJhdG9yRnVuY3Rpb24iPT09KGUuZGlzcGxheU5hbWV8fGUubmFtZSkpfSxlLm1hcms9ZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodCx3KToodC5fX3Byb3RvX189dyxoKHQsYywiR2VuZXJhdG9yRnVuY3Rpb24iKSksdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShrKSx0fSxlLmF3cmFwPWZ1bmN0aW9uKHQpe3JldHVybntfX2F3YWl0OnR9fSx6KEEucHJvdG90eXBlKSxoKEEucHJvdG90eXBlLHMsKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSksZS5Bc3luY0l0ZXJhdG9yPUEsZS5hc3luYz1mdW5jdGlvbih0LHIsbixhLGkpe3ZvaWQgMD09PWkmJihpPVByb21pc2UpO3ZhciBvPW5ldyBBKGwodCxyLG4sYSksaSk7cmV0dXJuIGUuaXNHZW5lcmF0b3JGdW5jdGlvbihyKT9vOm8ubmV4dCgpLnRoZW4oKGZ1bmN0aW9uKHQpe3JldHVybiB0LmRvbmU/dC52YWx1ZTpvLm5leHQoKX0pKX0seihrKSxoKGssYywiR2VuZXJhdG9yIiksaChrLG8sKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSksaChrLCJ0b1N0cmluZyIsKGZ1bmN0aW9uKCl7cmV0dXJuIltvYmplY3QgR2VuZXJhdG9yXSJ9KSksZS5rZXlzPWZ1bmN0aW9uKHQpe3ZhciBlPVtdO2Zvcih2YXIgciBpbiB0KWUucHVzaChyKTtyZXR1cm4gZS5yZXZlcnNlKCksZnVuY3Rpb24gcigpe2Zvcig7ZS5sZW5ndGg7KXt2YXIgbj1lLnBvcCgpO2lmKG4gaW4gdClyZXR1cm4gci52YWx1ZT1uLHIuZG9uZT0hMSxyfXJldHVybiByLmRvbmU9ITAscn19LGUudmFsdWVzPUQsUi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOlIscmVzZXQ6ZnVuY3Rpb24odCl7aWYodGhpcy5wcmV2PTAsdGhpcy5uZXh0PTAsdGhpcy5zZW50PXRoaXMuX3NlbnQ9cix0aGlzLmRvbmU9ITEsdGhpcy5kZWxlZ2F0ZT1udWxsLHRoaXMubWV0aG9kPSJuZXh0Iix0aGlzLmFyZz1yLHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKEIpLCF0KWZvcih2YXIgZSBpbiB0aGlzKSJ0Ij09PWUuY2hhckF0KDApJiZhLmNhbGwodGhpcyxlKSYmIWlzTmFOKCtlLnNsaWNlKDEpKSYmKHRoaXNbZV09cil9LHN0b3A6ZnVuY3Rpb24oKXt0aGlzLmRvbmU9ITA7dmFyIHQ9dGhpcy50cnlFbnRyaWVzWzBdLmNvbXBsZXRpb247aWYoInRocm93Ij09PXQudHlwZSl0aHJvdyB0LmFyZztyZXR1cm4gdGhpcy5ydmFsfSxkaXNwYXRjaEV4Y2VwdGlvbjpmdW5jdGlvbih0KXtpZih0aGlzLmRvbmUpdGhyb3cgdDt2YXIgZT10aGlzO2Z1bmN0aW9uIG4obixhKXtyZXR1cm4gcy50eXBlPSJ0aHJvdyIscy5hcmc9dCxlLm5leHQ9bixhJiYoZS5tZXRob2Q9Im5leHQiLGUuYXJnPXIpLCEhYX1mb3IodmFyIGk9dGhpcy50cnlFbnRyaWVzLmxlbmd0aC0xO2k+PTA7LS1pKXt2YXIgbz10aGlzLnRyeUVudHJpZXNbaV0scz1vLmNvbXBsZXRpb247aWYoInJvb3QiPT09by50cnlMb2MpcmV0dXJuIG4oImVuZCIpO2lmKG8udHJ5TG9jPD10aGlzLnByZXYpe3ZhciBjPWEuY2FsbChvLCJjYXRjaExvYyIpLGg9YS5jYWxsKG8sImZpbmFsbHlMb2MiKTtpZihjJiZoKXtpZih0aGlzLnByZXY8by5jYXRjaExvYylyZXR1cm4gbihvLmNhdGNoTG9jLCEwKTtpZih0aGlzLnByZXY8by5maW5hbGx5TG9jKXJldHVybiBuKG8uZmluYWxseUxvYyl9ZWxzZSBpZihjKXtpZih0aGlzLnByZXY8by5jYXRjaExvYylyZXR1cm4gbihvLmNhdGNoTG9jLCEwKX1lbHNle2lmKCFoKXRocm93IG5ldyBFcnJvcigidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHkiKTtpZih0aGlzLnByZXY8by5maW5hbGx5TG9jKXJldHVybiBuKG8uZmluYWxseUxvYyl9fX19LGFicnVwdDpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj10aGlzLnRyeUVudHJpZXMubGVuZ3RoLTE7cj49MDstLXIpe3ZhciBuPXRoaXMudHJ5RW50cmllc1tyXTtpZihuLnRyeUxvYzw9dGhpcy5wcmV2JiZhLmNhbGwobiwiZmluYWxseUxvYyIpJiZ0aGlzLnByZXY8bi5maW5hbGx5TG9jKXt2YXIgaT1uO2JyZWFrfX1pJiYoImJyZWFrIj09PXR8fCJjb250aW51ZSI9PT10KSYmaS50cnlMb2M8PWUmJmU8PWkuZmluYWxseUxvYyYmKGk9bnVsbCk7dmFyIG89aT9pLmNvbXBsZXRpb246e307cmV0dXJuIG8udHlwZT10LG8uYXJnPWUsaT8odGhpcy5tZXRob2Q9Im5leHQiLHRoaXMubmV4dD1pLmZpbmFsbHlMb2MsZyk6dGhpcy5jb21wbGV0ZShvKX0sY29tcGxldGU6ZnVuY3Rpb24odCxlKXtpZigidGhyb3ciPT09dC50eXBlKXRocm93IHQuYXJnO3JldHVybiJicmVhayI9PT10LnR5cGV8fCJjb250aW51ZSI9PT10LnR5cGU/dGhpcy5uZXh0PXQuYXJnOiJyZXR1cm4iPT09dC50eXBlPyh0aGlzLnJ2YWw9dGhpcy5hcmc9dC5hcmcsdGhpcy5tZXRob2Q9InJldHVybiIsdGhpcy5uZXh0PSJlbmQiKToibm9ybWFsIj09PXQudHlwZSYmZSYmKHRoaXMubmV4dD1lKSxnfSxmaW5pc2g6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTtlPj0wOy0tZSl7dmFyIHI9dGhpcy50cnlFbnRyaWVzW2VdO2lmKHIuZmluYWxseUxvYz09PXQpcmV0dXJuIHRoaXMuY29tcGxldGUoci5jb21wbGV0aW9uLHIuYWZ0ZXJMb2MpLEIociksZ319LGNhdGNoOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLnRyeUVudHJpZXMubGVuZ3RoLTE7ZT49MDstLWUpe3ZhciByPXRoaXMudHJ5RW50cmllc1tlXTtpZihyLnRyeUxvYz09PXQpe3ZhciBuPXIuY29tcGxldGlvbjtpZigidGhyb3ciPT09bi50eXBlKXt2YXIgYT1uLmFyZztCKHIpfXJldHVybiBhfX10aHJvdyBuZXcgRXJyb3IoImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdCIpfSxkZWxlZ2F0ZVlpZWxkOmZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gdGhpcy5kZWxlZ2F0ZT17aXRlcmF0b3I6RCh0KSxyZXN1bHROYW1lOmUsbmV4dExvYzpufSwibmV4dCI9PT10aGlzLm1ldGhvZCYmKHRoaXMuYXJnPXIpLGd9fSxlfShlLmV4cG9ydHMpO3RyeXtnbG9iYWxUaGlzLnJlZ2VuZXJhdG9yUnVudGltZT1yfWNhdGNoKGUpeyJvYmplY3QiPT09KCJ1bmRlZmluZWQiPT10eXBlb2YgZ2xvYmFsVGhpcz8idW5kZWZpbmVkIjp0KGdsb2JhbFRoaXMpKT9nbG9iYWxUaGlzLnJlZ2VuZXJhdG9yUnVudGltZT1yOkZ1bmN0aW9uKCJyIiwicmVnZW5lcmF0b3JSdW50aW1lID0gciIpKHIpfX0oe2V4cG9ydHM6e319KTt2YXIgbz17ZXhwb3J0czp7fX07KGZ1bmN0aW9uKGUpe3ZhciByPTQsbj0wLGE9MSxpPTI7ZnVuY3Rpb24gbyh0KXtmb3IodmFyIGU9dC5sZW5ndGg7LS1lPj0wOyl0W2VdPTB9dmFyIHM9MCxjPTEsaD0yLGw9Myx1PTI1OCxmPTI5LGQ9MjU2LF89ZCsxK2YscD0zMCxnPTE5LHY9MipfKzEseT0xNSx3PTE2LG09NyxiPTI1Nix4PTE2LGs9MTcsej0xOCxBPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMSwxLDEsMSwyLDIsMiwyLDMsMywzLDMsNCw0LDQsNCw1LDUsNSw1LDBdKSxFPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDEsMSwyLDIsMywzLDQsNCw1LDUsNiw2LDcsNyw4LDgsOSw5LDEwLDEwLDExLDExLDEyLDEyLDEzLDEzXSksUz1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyLDMsN10pLEI9bmV3IFVpbnQ4QXJyYXkoWzE2LDE3LDE4LDAsOCw3LDksNiwxMCw1LDExLDQsMTIsMywxMywyLDE0LDEsMTVdKSxSPTUxMixEPW5ldyBBcnJheSgyKihfKzIpKTtvKEQpO3ZhciBMPW5ldyBBcnJheSgyKnApO28oTCk7dmFyIFU9bmV3IEFycmF5KFIpO28oVSk7dmFyIEM9bmV3IEFycmF5KHUtbCsxKTtvKEMpO3ZhciBPPW5ldyBBcnJheShmKTtvKE8pO3ZhciBULEYsSCxaPW5ldyBBcnJheShwKTtmdW5jdGlvbiBNKHQsZSxyLG4sYSl7dGhpcy5zdGF0aWNfdHJlZT10LHRoaXMuZXh0cmFfYml0cz1lLHRoaXMuZXh0cmFfYmFzZT1yLHRoaXMuZWxlbXM9bix0aGlzLm1heF9sZW5ndGg9YSx0aGlzLmhhc19zdHJlZT10JiZ0Lmxlbmd0aH1mdW5jdGlvbiBJKHQsZSl7dGhpcy5keW5fdHJlZT10LHRoaXMubWF4X2NvZGU9MCx0aGlzLnN0YXRfZGVzYz1lfW8oWik7dmFyIE49ZnVuY3Rpb24odCl7cmV0dXJuIHQ8MjU2P1VbdF06VVsyNTYrKHQ+Pj43KV19LFA9ZnVuY3Rpb24odCxlKXt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lPj4+OCYyNTV9LGo9ZnVuY3Rpb24odCxlLHIpe3QuYmlfdmFsaWQ+dy1yPyh0LmJpX2J1Znw9ZTw8dC5iaV92YWxpZCY2NTUzNSxQKHQsdC5iaV9idWYpLHQuYmlfYnVmPWU+PnctdC5iaV92YWxpZCx0LmJpX3ZhbGlkKz1yLXcpOih0LmJpX2J1Znw9ZTw8dC5iaV92YWxpZCY2NTUzNSx0LmJpX3ZhbGlkKz1yKX0sSz1mdW5jdGlvbih0LGUscil7aih0LHJbMiplXSxyWzIqZSsxXSl9LFg9ZnVuY3Rpb24odCxlKXt2YXIgcj0wO2Rve3J8PTEmdCx0Pj4+PTEscjw8PTF9d2hpbGUoLS1lPjApO3JldHVybiByPj4+MX0scT1mdW5jdGlvbih0KXsxNj09PXQuYmlfdmFsaWQ/KFAodCx0LmJpX2J1ZiksdC5iaV9idWY9MCx0LmJpX3ZhbGlkPTApOnQuYmlfdmFsaWQ+PTgmJih0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmdC5iaV9idWYsdC5iaV9idWY+Pj04LHQuYmlfdmFsaWQtPTgpfSxHPWZ1bmN0aW9uKHQsZSl7dmFyIHIsbixhLGksbyxzLGM9ZS5keW5fdHJlZSxoPWUubWF4X2NvZGUsbD1lLnN0YXRfZGVzYy5zdGF0aWNfdHJlZSx1PWUuc3RhdF9kZXNjLmhhc19zdHJlZSxmPWUuc3RhdF9kZXNjLmV4dHJhX2JpdHMsZD1lLnN0YXRfZGVzYy5leHRyYV9iYXNlLF89ZS5zdGF0X2Rlc2MubWF4X2xlbmd0aCxwPTA7Zm9yKGk9MDtpPD15O2krKyl0LmJsX2NvdW50W2ldPTA7Zm9yKGNbMip0LmhlYXBbdC5oZWFwX21heF0rMV09MCxyPXQuaGVhcF9tYXgrMTtyPHY7cisrKShpPWNbMipjWzIqKG49dC5oZWFwW3JdKSsxXSsxXSsxKT5fJiYoaT1fLHArKyksY1syKm4rMV09aSxuPmh8fCh0LmJsX2NvdW50W2ldKyssbz0wLG4+PWQmJihvPWZbbi1kXSkscz1jWzIqbl0sdC5vcHRfbGVuKz1zKihpK28pLHUmJih0LnN0YXRpY19sZW4rPXMqKGxbMipuKzFdK28pKSk7aWYoMCE9PXApe2Rve2ZvcihpPV8tMTswPT09dC5ibF9jb3VudFtpXTspaS0tO3QuYmxfY291bnRbaV0tLSx0LmJsX2NvdW50W2krMV0rPTIsdC5ibF9jb3VudFtfXS0tLHAtPTJ9d2hpbGUocD4wKTtmb3IoaT1fOzAhPT1pO2ktLSlmb3Iobj10LmJsX2NvdW50W2ldOzAhPT1uOykoYT10LmhlYXBbLS1yXSk+aHx8KGNbMiphKzFdIT09aSYmKHQub3B0X2xlbis9KGktY1syKmErMV0pKmNbMiphXSxjWzIqYSsxXT1pKSxuLS0pfX0sVz1mdW5jdGlvbih0LGUscil7dmFyIG4sYSxpPW5ldyBBcnJheSh5KzEpLG89MDtmb3Iobj0xO248PXk7bisrKWlbbl09bz1vK3Jbbi0xXTw8MTtmb3IoYT0wO2E8PWU7YSsrKXt2YXIgcz10WzIqYSsxXTswIT09cyYmKHRbMiphXT1YKGlbc10rKyxzKSl9fSxZPWZ1bmN0aW9uKCl7dmFyIHQsZSxyLG4sYSxpPW5ldyBBcnJheSh5KzEpO2ZvcihyPTAsbj0wO248Zi0xO24rKylmb3IoT1tuXT1yLHQ9MDt0PDE8PEFbbl07dCsrKUNbcisrXT1uO2ZvcihDW3ItMV09bixhPTAsbj0wO248MTY7bisrKWZvcihaW25dPWEsdD0wO3Q8MTw8RVtuXTt0KyspVVthKytdPW47Zm9yKGE+Pj03O248cDtuKyspZm9yKFpbbl09YTw8Nyx0PTA7dDwxPDxFW25dLTc7dCsrKVVbMjU2K2ErK109bjtmb3IoZT0wO2U8PXk7ZSsrKWlbZV09MDtmb3IodD0wO3Q8PTE0MzspRFsyKnQrMV09OCx0KyssaVs4XSsrO2Zvcig7dDw9MjU1OylEWzIqdCsxXT05LHQrKyxpWzldKys7Zm9yKDt0PD0yNzk7KURbMip0KzFdPTcsdCsrLGlbN10rKztmb3IoO3Q8PTI4NzspRFsyKnQrMV09OCx0KyssaVs4XSsrO2ZvcihXKEQsXysxLGkpLHQ9MDt0PHA7dCsrKUxbMip0KzFdPTUsTFsyKnRdPVgodCw1KTtUPW5ldyBNKEQsQSxkKzEsXyx5KSxGPW5ldyBNKEwsRSwwLHAseSksSD1uZXcgTShuZXcgQXJyYXkoMCksUywwLGcsbSl9LFY9ZnVuY3Rpb24odCl7dmFyIGU7Zm9yKGU9MDtlPF87ZSsrKXQuZHluX2x0cmVlWzIqZV09MDtmb3IoZT0wO2U8cDtlKyspdC5keW5fZHRyZWVbMiplXT0wO2ZvcihlPTA7ZTxnO2UrKyl0LmJsX3RyZWVbMiplXT0wO3QuZHluX2x0cmVlWzIqYl09MSx0Lm9wdF9sZW49dC5zdGF0aWNfbGVuPTAsdC5sYXN0X2xpdD10Lm1hdGNoZXM9MH0sJD1mdW5jdGlvbih0KXt0LmJpX3ZhbGlkPjg/UCh0LHQuYmlfYnVmKTp0LmJpX3ZhbGlkPjAmJih0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT10LmJpX2J1ZiksdC5iaV9idWY9MCx0LmJpX3ZhbGlkPTB9LFE9ZnVuY3Rpb24odCxlLHIsbil7JCh0KSxuJiYoUCh0LHIpLFAodCx+cikpLHQucGVuZGluZ19idWYuc2V0KHQud2luZG93LnN1YmFycmF5KGUsZStyKSx0LnBlbmRpbmcpLHQucGVuZGluZys9cn0sSj1mdW5jdGlvbih0LGUscixuKXt2YXIgYT0yKmUsaT0yKnI7cmV0dXJuIHRbYV08dFtpXXx8dFthXT09PXRbaV0mJm5bZV08PW5bcl19LHR0PWZ1bmN0aW9uKHQsZSxyKXtmb3IodmFyIG49dC5oZWFwW3JdLGE9cjw8MTthPD10LmhlYXBfbGVuJiYoYTx0LmhlYXBfbGVuJiZKKGUsdC5oZWFwW2ErMV0sdC5oZWFwW2FdLHQuZGVwdGgpJiZhKyssIUooZSxuLHQuaGVhcFthXSx0LmRlcHRoKSk7KXQuaGVhcFtyXT10LmhlYXBbYV0scj1hLGE8PD0xO3QuaGVhcFtyXT1ufSxldD1mdW5jdGlvbih0LGUscil7dmFyIG4sYSxpLG8scz0wO2lmKDAhPT10Lmxhc3RfbGl0KWRve249dC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqc108PDh8dC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqcysxXSxhPXQucGVuZGluZ19idWZbdC5sX2J1ZitzXSxzKyssMD09PW4/Syh0LGEsZSk6KGk9Q1thXSxLKHQsaStkKzEsZSksMCE9PShvPUFbaV0pJiYoYS09T1tpXSxqKHQsYSxvKSksbi0tLGk9TihuKSxLKHQsaSxyKSwwIT09KG89RVtpXSkmJihuLT1aW2ldLGoodCxuLG8pKSl9d2hpbGUoczx0Lmxhc3RfbGl0KTtLKHQsYixlKX0scnQ9ZnVuY3Rpb24odCxlKXt2YXIgcixuLGEsaT1lLmR5bl90cmVlLG89ZS5zdGF0X2Rlc2Muc3RhdGljX3RyZWUscz1lLnN0YXRfZGVzYy5oYXNfc3RyZWUsYz1lLnN0YXRfZGVzYy5lbGVtcyxoPS0xO2Zvcih0LmhlYXBfbGVuPTAsdC5oZWFwX21heD12LHI9MDtyPGM7cisrKTAhPT1pWzIqcl0/KHQuaGVhcFsrK3QuaGVhcF9sZW5dPWg9cix0LmRlcHRoW3JdPTApOmlbMipyKzFdPTA7Zm9yKDt0LmhlYXBfbGVuPDI7KWlbMiooYT10LmhlYXBbKyt0LmhlYXBfbGVuXT1oPDI/KytoOjApXT0xLHQuZGVwdGhbYV09MCx0Lm9wdF9sZW4tLSxzJiYodC5zdGF0aWNfbGVuLT1vWzIqYSsxXSk7Zm9yKGUubWF4X2NvZGU9aCxyPXQuaGVhcF9sZW4+PjE7cj49MTtyLS0pdHQodCxpLHIpO2E9Yztkb3tyPXQuaGVhcFsxXSx0LmhlYXBbMV09dC5oZWFwW3QuaGVhcF9sZW4tLV0sdHQodCxpLDEpLG49dC5oZWFwWzFdLHQuaGVhcFstLXQuaGVhcF9tYXhdPXIsdC5oZWFwWy0tdC5oZWFwX21heF09bixpWzIqYV09aVsyKnJdK2lbMipuXSx0LmRlcHRoW2FdPSh0LmRlcHRoW3JdPj10LmRlcHRoW25dP3QuZGVwdGhbcl06dC5kZXB0aFtuXSkrMSxpWzIqcisxXT1pWzIqbisxXT1hLHQuaGVhcFsxXT1hKyssdHQodCxpLDEpfXdoaWxlKHQuaGVhcF9sZW4+PTIpO3QuaGVhcFstLXQuaGVhcF9tYXhdPXQuaGVhcFsxXSxHKHQsZSksVyhpLGgsdC5ibF9jb3VudCl9LG50PWZ1bmN0aW9uKHQsZSxyKXt2YXIgbixhLGk9LTEsbz1lWzFdLHM9MCxjPTcsaD00O2ZvcigwPT09byYmKGM9MTM4LGg9MyksZVsyKihyKzEpKzFdPTY1NTM1LG49MDtuPD1yO24rKylhPW8sbz1lWzIqKG4rMSkrMV0sKytzPGMmJmE9PT1vfHwoczxoP3QuYmxfdHJlZVsyKmFdKz1zOjAhPT1hPyhhIT09aSYmdC5ibF90cmVlWzIqYV0rKyx0LmJsX3RyZWVbMip4XSsrKTpzPD0xMD90LmJsX3RyZWVbMiprXSsrOnQuYmxfdHJlZVsyKnpdKysscz0wLGk9YSwwPT09bz8oYz0xMzgsaD0zKTphPT09bz8oYz02LGg9Myk6KGM9NyxoPTQpKX0sYXQ9ZnVuY3Rpb24odCxlLHIpe3ZhciBuLGEsaT0tMSxvPWVbMV0scz0wLGM9NyxoPTQ7Zm9yKDA9PT1vJiYoYz0xMzgsaD0zKSxuPTA7bjw9cjtuKyspaWYoYT1vLG89ZVsyKihuKzEpKzFdLCEoKytzPGMmJmE9PT1vKSl7aWYoczxoKWRve0sodCxhLHQuYmxfdHJlZSl9d2hpbGUoMCE9LS1zKTtlbHNlIDAhPT1hPyhhIT09aSYmKEsodCxhLHQuYmxfdHJlZSkscy0tKSxLKHQseCx0LmJsX3RyZWUpLGoodCxzLTMsMikpOnM8PTEwPyhLKHQsayx0LmJsX3RyZWUpLGoodCxzLTMsMykpOihLKHQseix0LmJsX3RyZWUpLGoodCxzLTExLDcpKTtzPTAsaT1hLDA9PT1vPyhjPTEzOCxoPTMpOmE9PT1vPyhjPTYsaD0zKTooYz03LGg9NCl9fSxpdD1mdW5jdGlvbih0KXt2YXIgZTtmb3IobnQodCx0LmR5bl9sdHJlZSx0LmxfZGVzYy5tYXhfY29kZSksbnQodCx0LmR5bl9kdHJlZSx0LmRfZGVzYy5tYXhfY29kZSkscnQodCx0LmJsX2Rlc2MpLGU9Zy0xO2U+PTMmJjA9PT10LmJsX3RyZWVbMipCW2VdKzFdO2UtLSk7cmV0dXJuIHQub3B0X2xlbis9MyooZSsxKSs1KzUrNCxlfSxvdD1mdW5jdGlvbih0LGUscixuKXt2YXIgYTtmb3Ioaih0LGUtMjU3LDUpLGoodCxyLTEsNSksaih0LG4tNCw0KSxhPTA7YTxuO2ErKylqKHQsdC5ibF90cmVlWzIqQlthXSsxXSwzKTthdCh0LHQuZHluX2x0cmVlLGUtMSksYXQodCx0LmR5bl9kdHJlZSxyLTEpfSxzdD1mdW5jdGlvbih0KXt2YXIgZSxyPTQwOTM2MjQ0NDc7Zm9yKGU9MDtlPD0zMTtlKysscj4+Pj0xKWlmKDEmciYmMCE9PXQuZHluX2x0cmVlWzIqZV0pcmV0dXJuIG47aWYoMCE9PXQuZHluX2x0cmVlWzE4XXx8MCE9PXQuZHluX2x0cmVlWzIwXXx8MCE9PXQuZHluX2x0cmVlWzI2XSlyZXR1cm4gYTtmb3IoZT0zMjtlPGQ7ZSsrKWlmKDAhPT10LmR5bl9sdHJlZVsyKmVdKXJldHVybiBhO3JldHVybiBufSxjdD0hMSxodD1mdW5jdGlvbih0LGUscixuKXtqKHQsKHM8PDEpKyhuPzE6MCksMyksUSh0LGUsciwhMCl9LGx0PWZ1bmN0aW9uKHQsZSxuLGEpe3ZhciBvLHMsbD0wO3QubGV2ZWw+MD8odC5zdHJtLmRhdGFfdHlwZT09PWkmJih0LnN0cm0uZGF0YV90eXBlPXN0KHQpKSxydCh0LHQubF9kZXNjKSxydCh0LHQuZF9kZXNjKSxsPWl0KHQpLG89dC5vcHRfbGVuKzMrNz4+PjMsKHM9dC5zdGF0aWNfbGVuKzMrNz4+PjMpPD1vJiYobz1zKSk6bz1zPW4rNSxuKzQ8PW8mJi0xIT09ZT9odCh0LGUsbixhKTp0LnN0cmF0ZWd5PT09cnx8cz09PW8/KGoodCwoYzw8MSkrKGE/MTowKSwzKSxldCh0LEQsTCkpOihqKHQsKGg8PDEpKyhhPzE6MCksMyksb3QodCx0LmxfZGVzYy5tYXhfY29kZSsxLHQuZF9kZXNjLm1heF9jb2RlKzEsbCsxKSxldCh0LHQuZHluX2x0cmVlLHQuZHluX2R0cmVlKSksVih0KSxhJiYkKHQpfSx1dD17X3RyX2luaXQ6ZnVuY3Rpb24odCl7Y3R8fChZKCksY3Q9ITApLHQubF9kZXNjPW5ldyBJKHQuZHluX2x0cmVlLFQpLHQuZF9kZXNjPW5ldyBJKHQuZHluX2R0cmVlLEYpLHQuYmxfZGVzYz1uZXcgSSh0LmJsX3RyZWUsSCksdC5iaV9idWY9MCx0LmJpX3ZhbGlkPTAsVih0KX0sX3RyX3N0b3JlZF9ibG9jazpodCxfdHJfZmx1c2hfYmxvY2s6bHQsX3RyX3RhbGx5OmZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqdC5sYXN0X2xpdF09ZT4+PjgmMjU1LHQucGVuZGluZ19idWZbdC5kX2J1ZisyKnQubGFzdF9saXQrMV09MjU1JmUsdC5wZW5kaW5nX2J1Zlt0LmxfYnVmK3QubGFzdF9saXRdPTI1NSZyLHQubGFzdF9saXQrKywwPT09ZT90LmR5bl9sdHJlZVsyKnJdKys6KHQubWF0Y2hlcysrLGUtLSx0LmR5bl9sdHJlZVsyKihDW3JdK2QrMSldKyssdC5keW5fZHRyZWVbMipOKGUpXSsrKSx0Lmxhc3RfbGl0PT09dC5saXRfYnVmc2l6ZS0xfSxfdHJfYWxpZ246ZnVuY3Rpb24odCl7aih0LGM8PDEsMyksSyh0LGIsRCkscSh0KX19LGZ0PWZ1bmN0aW9uKHQsZSxyLG4pe2Zvcih2YXIgYT02NTUzNSZ0fDAsaT10Pj4+MTYmNjU1MzV8MCxvPTA7MCE9PXI7KXtyLT1vPXI+MmUzPzJlMzpyO2Rve2k9aSsoYT1hK2VbbisrXXwwKXwwfXdoaWxlKC0tbyk7YSU9NjU1MjEsaSU9NjU1MjF9cmV0dXJuIGF8aTw8MTZ8MH0sZHQ9bmV3IFVpbnQzMkFycmF5KGZ1bmN0aW9uKCl7Zm9yKHZhciB0LGU9W10scj0wO3I8MjU2O3IrKyl7dD1yO2Zvcih2YXIgbj0wO248ODtuKyspdD0xJnQ/Mzk4ODI5MjM4NF50Pj4+MTp0Pj4+MTtlW3JdPXR9cmV0dXJuIGV9KCkpLF90PWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBhPWR0LGk9bityO3RePS0xO2Zvcih2YXIgbz1uO288aTtvKyspdD10Pj4+OF5hWzI1NSYodF5lW29dKV07cmV0dXJuLTFedH0scHQ9ezI6Im5lZWQgZGljdGlvbmFyeSIsMToic3RyZWFtIGVuZCIsMDoiIiwiLTEiOiJmaWxlIGVycm9yIiwiLTIiOiJzdHJlYW0gZXJyb3IiLCItMyI6ImRhdGEgZXJyb3IiLCItNCI6Imluc3VmZmljaWVudCBtZW1vcnkiLCItNSI6ImJ1ZmZlciBlcnJvciIsIi02IjoiaW5jb21wYXRpYmxlIHZlcnNpb24ifSxndD17Wl9OT19GTFVTSDowLFpfUEFSVElBTF9GTFVTSDoxLFpfU1lOQ19GTFVTSDoyLFpfRlVMTF9GTFVTSDozLFpfRklOSVNIOjQsWl9CTE9DSzo1LFpfVFJFRVM6NixaX09LOjAsWl9TVFJFQU1fRU5EOjEsWl9ORUVEX0RJQ1Q6MixaX0VSUk5POi0xLFpfU1RSRUFNX0VSUk9SOi0yLFpfREFUQV9FUlJPUjotMyxaX01FTV9FUlJPUjotNCxaX0JVRl9FUlJPUjotNSxaX05PX0NPTVBSRVNTSU9OOjAsWl9CRVNUX1NQRUVEOjEsWl9CRVNUX0NPTVBSRVNTSU9OOjksWl9ERUZBVUxUX0NPTVBSRVNTSU9OOi0xLFpfRklMVEVSRUQ6MSxaX0hVRkZNQU5fT05MWToyLFpfUkxFOjMsWl9GSVhFRDo0LFpfREVGQVVMVF9TVFJBVEVHWTowLFpfQklOQVJZOjAsWl9URVhUOjEsWl9VTktOT1dOOjIsWl9ERUZMQVRFRDo4fSx2dD11dC5fdHJfaW5pdCx5dD11dC5fdHJfc3RvcmVkX2Jsb2NrLHd0PXV0Ll90cl9mbHVzaF9ibG9jayxtdD11dC5fdHJfdGFsbHksYnQ9dXQuX3RyX2FsaWduLHh0PWd0LlpfTk9fRkxVU0gsa3Q9Z3QuWl9QQVJUSUFMX0ZMVVNILHp0PWd0LlpfRlVMTF9GTFVTSCxBdD1ndC5aX0ZJTklTSCxFdD1ndC5aX0JMT0NLLFN0PWd0LlpfT0ssQnQ9Z3QuWl9TVFJFQU1fRU5ELFJ0PWd0LlpfU1RSRUFNX0VSUk9SLER0PWd0LlpfREFUQV9FUlJPUixMdD1ndC5aX0JVRl9FUlJPUixVdD1ndC5aX0RFRkFVTFRfQ09NUFJFU1NJT04sQ3Q9Z3QuWl9GSUxURVJFRCxPdD1ndC5aX0hVRkZNQU5fT05MWSxUdD1ndC5aX1JMRSxGdD1ndC5aX0ZJWEVELEh0PWd0LlpfREVGQVVMVF9TVFJBVEVHWSxadD1ndC5aX1VOS05PV04sTXQ9Z3QuWl9ERUZMQVRFRCxJdD05LE50PTE1LFB0PTgsanQ9Mjg2LEt0PTMwLFh0PTE5LHF0PTIqanQrMSxHdD0xNSxXdD0zLFl0PTI1OCxWdD1ZdCtXdCsxLCR0PTMyLFF0PTQyLEp0PTY5LHRlPTczLGVlPTkxLHJlPTEwMyxuZT0xMTMsYWU9NjY2LGllPTEsb2U9MixzZT0zLGNlPTQsaGU9MyxsZT1mdW5jdGlvbih0LGUpe3JldHVybiB0Lm1zZz1wdFtlXSxlfSx1ZT1mdW5jdGlvbih0KXtyZXR1cm4odDw8MSktKHQ+ND85OjApfSxmZT1mdW5jdGlvbih0KXtmb3IodmFyIGU9dC5sZW5ndGg7LS1lPj0wOyl0W2VdPTB9LGRlPWZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4oZTw8dC5oYXNoX3NoaWZ0XnIpJnQuaGFzaF9tYXNrfSxfZT1mdW5jdGlvbih0KXt2YXIgZT10LnN0YXRlLHI9ZS5wZW5kaW5nO3I+dC5hdmFpbF9vdXQmJihyPXQuYXZhaWxfb3V0KSwwIT09ciYmKHQub3V0cHV0LnNldChlLnBlbmRpbmdfYnVmLnN1YmFycmF5KGUucGVuZGluZ19vdXQsZS5wZW5kaW5nX291dCtyKSx0Lm5leHRfb3V0KSx0Lm5leHRfb3V0Kz1yLGUucGVuZGluZ19vdXQrPXIsdC50b3RhbF9vdXQrPXIsdC5hdmFpbF9vdXQtPXIsZS5wZW5kaW5nLT1yLDA9PT1lLnBlbmRpbmcmJihlLnBlbmRpbmdfb3V0PTApKX0scGU9ZnVuY3Rpb24odCxlKXt3dCh0LHQuYmxvY2tfc3RhcnQ+PTA/dC5ibG9ja19zdGFydDotMSx0LnN0cnN0YXJ0LXQuYmxvY2tfc3RhcnQsZSksdC5ibG9ja19zdGFydD10LnN0cnN0YXJ0LF9lKHQuc3RybSl9LGdlPWZ1bmN0aW9uKHQsZSl7dC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK109ZX0sdmU9ZnVuY3Rpb24odCxlKXt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lPj4+OCYyNTUsdC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK109MjU1JmV9LHllPWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBhPXQuYXZhaWxfaW47cmV0dXJuIGE+biYmKGE9biksMD09PWE/MDoodC5hdmFpbF9pbi09YSxlLnNldCh0LmlucHV0LnN1YmFycmF5KHQubmV4dF9pbix0Lm5leHRfaW4rYSksciksMT09PXQuc3RhdGUud3JhcD90LmFkbGVyPWZ0KHQuYWRsZXIsZSxhLHIpOjI9PT10LnN0YXRlLndyYXAmJih0LmFkbGVyPV90KHQuYWRsZXIsZSxhLHIpKSx0Lm5leHRfaW4rPWEsdC50b3RhbF9pbis9YSxhKX0sd2U9ZnVuY3Rpb24odCxlKXt2YXIgcixuLGE9dC5tYXhfY2hhaW5fbGVuZ3RoLGk9dC5zdHJzdGFydCxvPXQucHJldl9sZW5ndGgscz10Lm5pY2VfbWF0Y2gsYz10LnN0cnN0YXJ0PnQud19zaXplLVZ0P3Quc3Ryc3RhcnQtKHQud19zaXplLVZ0KTowLGg9dC53aW5kb3csbD10LndfbWFzayx1PXQucHJldixmPXQuc3Ryc3RhcnQrWXQsZD1oW2krby0xXSxfPWhbaStvXTt0LnByZXZfbGVuZ3RoPj10Lmdvb2RfbWF0Y2gmJihhPj49Mikscz50Lmxvb2thaGVhZCYmKHM9dC5sb29rYWhlYWQpO2Rve2lmKGhbKHI9ZSkrb109PT1fJiZoW3Irby0xXT09PWQmJmhbcl09PT1oW2ldJiZoWysrcl09PT1oW2krMV0pe2krPTIscisrO2Rve313aGlsZShoWysraV09PT1oWysrcl0mJmhbKytpXT09PWhbKytyXSYmaFsrK2ldPT09aFsrK3JdJiZoWysraV09PT1oWysrcl0mJmhbKytpXT09PWhbKytyXSYmaFsrK2ldPT09aFsrK3JdJiZoWysraV09PT1oWysrcl0mJmhbKytpXT09PWhbKytyXSYmaTxmKTtpZihuPVl0LShmLWkpLGk9Zi1ZdCxuPm8pe2lmKHQubWF0Y2hfc3RhcnQ9ZSxvPW4sbj49cylicmVhaztkPWhbaStvLTFdLF89aFtpK29dfX19d2hpbGUoKGU9dVtlJmxdKT5jJiYwIT0tLWEpO3JldHVybiBvPD10Lmxvb2thaGVhZD9vOnQubG9va2FoZWFkfSxtZT1mdW5jdGlvbih0KXt2YXIgZSxyLG4sYSxpLG89dC53X3NpemU7ZG97aWYoYT10LndpbmRvd19zaXplLXQubG9va2FoZWFkLXQuc3Ryc3RhcnQsdC5zdHJzdGFydD49bysoby1WdCkpe3Qud2luZG93LnNldCh0LndpbmRvdy5zdWJhcnJheShvLG8rbyksMCksdC5tYXRjaF9zdGFydC09byx0LnN0cnN0YXJ0LT1vLHQuYmxvY2tfc3RhcnQtPW8sZT1yPXQuaGFzaF9zaXplO2Rve249dC5oZWFkWy0tZV0sdC5oZWFkW2VdPW4+PW8/bi1vOjB9d2hpbGUoLS1yKTtlPXI9bztkb3tuPXQucHJldlstLWVdLHQucHJldltlXT1uPj1vP24tbzowfXdoaWxlKC0tcik7YSs9b31pZigwPT09dC5zdHJtLmF2YWlsX2luKWJyZWFrO2lmKHI9eWUodC5zdHJtLHQud2luZG93LHQuc3Ryc3RhcnQrdC5sb29rYWhlYWQsYSksdC5sb29rYWhlYWQrPXIsdC5sb29rYWhlYWQrdC5pbnNlcnQ+PVd0KWZvcihpPXQuc3Ryc3RhcnQtdC5pbnNlcnQsdC5pbnNfaD10LndpbmRvd1tpXSx0Lmluc19oPWRlKHQsdC5pbnNfaCx0LndpbmRvd1tpKzFdKTt0Lmluc2VydCYmKHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W2krV3QtMV0pLHQucHJldltpJnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPWksaSsrLHQuaW5zZXJ0LS0sISh0Lmxvb2thaGVhZCt0Lmluc2VydDxXdCkpOyk7fXdoaWxlKHQubG9va2FoZWFkPFZ0JiYwIT09dC5zdHJtLmF2YWlsX2luKX0sYmU9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHIsbjs7KXtpZih0Lmxvb2thaGVhZDxWdCl7aWYobWUodCksdC5sb29rYWhlYWQ8VnQmJmU9PT14dClyZXR1cm4gaWU7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfWlmKHI9MCx0Lmxvb2thaGVhZD49V3QmJih0Lmluc19oPWRlKHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0K1d0LTFdKSxyPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnQpLDAhPT1yJiZ0LnN0cnN0YXJ0LXI8PXQud19zaXplLVZ0JiYodC5tYXRjaF9sZW5ndGg9d2UodCxyKSksdC5tYXRjaF9sZW5ndGg+PVd0KWlmKG49bXQodCx0LnN0cnN0YXJ0LXQubWF0Y2hfc3RhcnQsdC5tYXRjaF9sZW5ndGgtV3QpLHQubG9va2FoZWFkLT10Lm1hdGNoX2xlbmd0aCx0Lm1hdGNoX2xlbmd0aDw9dC5tYXhfbGF6eV9tYXRjaCYmdC5sb29rYWhlYWQ+PVd0KXt0Lm1hdGNoX2xlbmd0aC0tO2Rve3Quc3Ryc3RhcnQrKyx0Lmluc19oPWRlKHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0K1d0LTFdKSxyPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnR9d2hpbGUoMCE9LS10Lm1hdGNoX2xlbmd0aCk7dC5zdHJzdGFydCsrfWVsc2UgdC5zdHJzdGFydCs9dC5tYXRjaF9sZW5ndGgsdC5tYXRjaF9sZW5ndGg9MCx0Lmluc19oPXQud2luZG93W3Quc3Ryc3RhcnRdLHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrMV0pO2Vsc2Ugbj1tdCh0LDAsdC53aW5kb3dbdC5zdHJzdGFydF0pLHQubG9va2FoZWFkLS0sdC5zdHJzdGFydCsrO2lmKG4mJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIGllfXJldHVybiB0Lmluc2VydD10LnN0cnN0YXJ0PFd0LTE/dC5zdHJzdGFydDpXdC0xLGU9PT1BdD8ocGUodCwhMCksMD09PXQuc3RybS5hdmFpbF9vdXQ/c2U6Y2UpOnQubGFzdF9saXQmJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCk/aWU6b2V9LHhlPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByLG4sYTs7KXtpZih0Lmxvb2thaGVhZDxWdCl7aWYobWUodCksdC5sb29rYWhlYWQ8VnQmJmU9PT14dClyZXR1cm4gaWU7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfWlmKHI9MCx0Lmxvb2thaGVhZD49V3QmJih0Lmluc19oPWRlKHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0K1d0LTFdKSxyPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnQpLHQucHJldl9sZW5ndGg9dC5tYXRjaF9sZW5ndGgsdC5wcmV2X21hdGNoPXQubWF0Y2hfc3RhcnQsdC5tYXRjaF9sZW5ndGg9V3QtMSwwIT09ciYmdC5wcmV2X2xlbmd0aDx0Lm1heF9sYXp5X21hdGNoJiZ0LnN0cnN0YXJ0LXI8PXQud19zaXplLVZ0JiYodC5tYXRjaF9sZW5ndGg9d2UodCxyKSx0Lm1hdGNoX2xlbmd0aDw9NSYmKHQuc3RyYXRlZ3k9PT1DdHx8dC5tYXRjaF9sZW5ndGg9PT1XdCYmdC5zdHJzdGFydC10Lm1hdGNoX3N0YXJ0PjQwOTYpJiYodC5tYXRjaF9sZW5ndGg9V3QtMSkpLHQucHJldl9sZW5ndGg+PVd0JiZ0Lm1hdGNoX2xlbmd0aDw9dC5wcmV2X2xlbmd0aCl7YT10LnN0cnN0YXJ0K3QubG9va2FoZWFkLVd0LG49bXQodCx0LnN0cnN0YXJ0LTEtdC5wcmV2X21hdGNoLHQucHJldl9sZW5ndGgtV3QpLHQubG9va2FoZWFkLT10LnByZXZfbGVuZ3RoLTEsdC5wcmV2X2xlbmd0aC09Mjtkb3srK3Quc3Ryc3RhcnQ8PWEmJih0Lmluc19oPWRlKHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0K1d0LTFdKSxyPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnQpfXdoaWxlKDAhPS0tdC5wcmV2X2xlbmd0aCk7aWYodC5tYXRjaF9hdmFpbGFibGU9MCx0Lm1hdGNoX2xlbmd0aD1XdC0xLHQuc3Ryc3RhcnQrKyxuJiYocGUodCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpKXJldHVybiBpZX1lbHNlIGlmKHQubWF0Y2hfYXZhaWxhYmxlKXtpZigobj1tdCh0LDAsdC53aW5kb3dbdC5zdHJzdGFydC0xXSkpJiZwZSh0LCExKSx0LnN0cnN0YXJ0KyssdC5sb29rYWhlYWQtLSwwPT09dC5zdHJtLmF2YWlsX291dClyZXR1cm4gaWV9ZWxzZSB0Lm1hdGNoX2F2YWlsYWJsZT0xLHQuc3Ryc3RhcnQrKyx0Lmxvb2thaGVhZC0tfXJldHVybiB0Lm1hdGNoX2F2YWlsYWJsZSYmKG49bXQodCwwLHQud2luZG93W3Quc3Ryc3RhcnQtMV0pLHQubWF0Y2hfYXZhaWxhYmxlPTApLHQuaW5zZXJ0PXQuc3Ryc3RhcnQ8V3QtMT90LnN0cnN0YXJ0Old0LTEsZT09PUF0PyhwZSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9zZTpjZSk6dC5sYXN0X2xpdCYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9pZTpvZX0sa2U9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHIsbixhLGksbz10LndpbmRvdzs7KXtpZih0Lmxvb2thaGVhZDw9WXQpe2lmKG1lKHQpLHQubG9va2FoZWFkPD1ZdCYmZT09PXh0KXJldHVybiBpZTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYodC5tYXRjaF9sZW5ndGg9MCx0Lmxvb2thaGVhZD49V3QmJnQuc3Ryc3RhcnQ+MCYmKG49b1thPXQuc3Ryc3RhcnQtMV0pPT09b1srK2FdJiZuPT09b1srK2FdJiZuPT09b1srK2FdKXtpPXQuc3Ryc3RhcnQrWXQ7ZG97fXdoaWxlKG49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0mJmE8aSk7dC5tYXRjaF9sZW5ndGg9WXQtKGktYSksdC5tYXRjaF9sZW5ndGg+dC5sb29rYWhlYWQmJih0Lm1hdGNoX2xlbmd0aD10Lmxvb2thaGVhZCl9aWYodC5tYXRjaF9sZW5ndGg+PVd0PyhyPW10KHQsMSx0Lm1hdGNoX2xlbmd0aC1XdCksdC5sb29rYWhlYWQtPXQubWF0Y2hfbGVuZ3RoLHQuc3Ryc3RhcnQrPXQubWF0Y2hfbGVuZ3RoLHQubWF0Y2hfbGVuZ3RoPTApOihyPW10KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0XSksdC5sb29rYWhlYWQtLSx0LnN0cnN0YXJ0KyspLHImJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIGllfXJldHVybiB0Lmluc2VydD0wLGU9PT1BdD8ocGUodCwhMCksMD09PXQuc3RybS5hdmFpbF9vdXQ/c2U6Y2UpOnQubGFzdF9saXQmJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCk/aWU6b2V9LHplPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByOzspe2lmKDA9PT10Lmxvb2thaGVhZCYmKG1lKHQpLDA9PT10Lmxvb2thaGVhZCkpe2lmKGU9PT14dClyZXR1cm4gaWU7YnJlYWt9aWYodC5tYXRjaF9sZW5ndGg9MCxyPW10KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0XSksdC5sb29rYWhlYWQtLSx0LnN0cnN0YXJ0KyssciYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gaWV9cmV0dXJuIHQuaW5zZXJ0PTAsZT09PUF0PyhwZSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9zZTpjZSk6dC5sYXN0X2xpdCYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9pZTpvZX07ZnVuY3Rpb24gQWUodCxlLHIsbixhKXt0aGlzLmdvb2RfbGVuZ3RoPXQsdGhpcy5tYXhfbGF6eT1lLHRoaXMubmljZV9sZW5ndGg9cix0aGlzLm1heF9jaGFpbj1uLHRoaXMuZnVuYz1hfXZhciBFZT1bbmV3IEFlKDAsMCwwLDAsKGZ1bmN0aW9uKHQsZSl7dmFyIHI9NjU1MzU7Zm9yKHI+dC5wZW5kaW5nX2J1Zl9zaXplLTUmJihyPXQucGVuZGluZ19idWZfc2l6ZS01KTs7KXtpZih0Lmxvb2thaGVhZDw9MSl7aWYobWUodCksMD09PXQubG9va2FoZWFkJiZlPT09eHQpcmV0dXJuIGllO2lmKDA9PT10Lmxvb2thaGVhZClicmVha310LnN0cnN0YXJ0Kz10Lmxvb2thaGVhZCx0Lmxvb2thaGVhZD0wO3ZhciBuPXQuYmxvY2tfc3RhcnQrcjtpZigoMD09PXQuc3Ryc3RhcnR8fHQuc3Ryc3RhcnQ+PW4pJiYodC5sb29rYWhlYWQ9dC5zdHJzdGFydC1uLHQuc3Ryc3RhcnQ9bixwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIGllO2lmKHQuc3Ryc3RhcnQtdC5ibG9ja19zdGFydD49dC53X3NpemUtVnQmJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIGllfXJldHVybiB0Lmluc2VydD0wLGU9PT1BdD8ocGUodCwhMCksMD09PXQuc3RybS5hdmFpbF9vdXQ/c2U6Y2UpOih0LnN0cnN0YXJ0PnQuYmxvY2tfc3RhcnQmJihwZSh0LCExKSx0LnN0cm0uYXZhaWxfb3V0KSxpZSl9KSksbmV3IEFlKDQsNCw4LDQsYmUpLG5ldyBBZSg0LDUsMTYsOCxiZSksbmV3IEFlKDQsNiwzMiwzMixiZSksbmV3IEFlKDQsNCwxNiwxNix4ZSksbmV3IEFlKDgsMTYsMzIsMzIseGUpLG5ldyBBZSg4LDE2LDEyOCwxMjgseGUpLG5ldyBBZSg4LDMyLDEyOCwyNTYseGUpLG5ldyBBZSgzMiwxMjgsMjU4LDEwMjQseGUpLG5ldyBBZSgzMiwyNTgsMjU4LDQwOTYseGUpXSxTZT1mdW5jdGlvbih0KXt0LndpbmRvd19zaXplPTIqdC53X3NpemUsZmUodC5oZWFkKSx0Lm1heF9sYXp5X21hdGNoPUVlW3QubGV2ZWxdLm1heF9sYXp5LHQuZ29vZF9tYXRjaD1FZVt0LmxldmVsXS5nb29kX2xlbmd0aCx0Lm5pY2VfbWF0Y2g9RWVbdC5sZXZlbF0ubmljZV9sZW5ndGgsdC5tYXhfY2hhaW5fbGVuZ3RoPUVlW3QubGV2ZWxdLm1heF9jaGFpbix0LnN0cnN0YXJ0PTAsdC5ibG9ja19zdGFydD0wLHQubG9va2FoZWFkPTAsdC5pbnNlcnQ9MCx0Lm1hdGNoX2xlbmd0aD10LnByZXZfbGVuZ3RoPVd0LTEsdC5tYXRjaF9hdmFpbGFibGU9MCx0Lmluc19oPTB9O2Z1bmN0aW9uIEJlKCl7dGhpcy5zdHJtPW51bGwsdGhpcy5zdGF0dXM9MCx0aGlzLnBlbmRpbmdfYnVmPW51bGwsdGhpcy5wZW5kaW5nX2J1Zl9zaXplPTAsdGhpcy5wZW5kaW5nX291dD0wLHRoaXMucGVuZGluZz0wLHRoaXMud3JhcD0wLHRoaXMuZ3poZWFkPW51bGwsdGhpcy5nemluZGV4PTAsdGhpcy5tZXRob2Q9TXQsdGhpcy5sYXN0X2ZsdXNoPS0xLHRoaXMud19zaXplPTAsdGhpcy53X2JpdHM9MCx0aGlzLndfbWFzaz0wLHRoaXMud2luZG93PW51bGwsdGhpcy53aW5kb3dfc2l6ZT0wLHRoaXMucHJldj1udWxsLHRoaXMuaGVhZD1udWxsLHRoaXMuaW5zX2g9MCx0aGlzLmhhc2hfc2l6ZT0wLHRoaXMuaGFzaF9iaXRzPTAsdGhpcy5oYXNoX21hc2s9MCx0aGlzLmhhc2hfc2hpZnQ9MCx0aGlzLmJsb2NrX3N0YXJ0PTAsdGhpcy5tYXRjaF9sZW5ndGg9MCx0aGlzLnByZXZfbWF0Y2g9MCx0aGlzLm1hdGNoX2F2YWlsYWJsZT0wLHRoaXMuc3Ryc3RhcnQ9MCx0aGlzLm1hdGNoX3N0YXJ0PTAsdGhpcy5sb29rYWhlYWQ9MCx0aGlzLnByZXZfbGVuZ3RoPTAsdGhpcy5tYXhfY2hhaW5fbGVuZ3RoPTAsdGhpcy5tYXhfbGF6eV9tYXRjaD0wLHRoaXMubGV2ZWw9MCx0aGlzLnN0cmF0ZWd5PTAsdGhpcy5nb29kX21hdGNoPTAsdGhpcy5uaWNlX21hdGNoPTAsdGhpcy5keW5fbHRyZWU9bmV3IFVpbnQxNkFycmF5KDIqcXQpLHRoaXMuZHluX2R0cmVlPW5ldyBVaW50MTZBcnJheSgyKigyKkt0KzEpKSx0aGlzLmJsX3RyZWU9bmV3IFVpbnQxNkFycmF5KDIqKDIqWHQrMSkpLGZlKHRoaXMuZHluX2x0cmVlKSxmZSh0aGlzLmR5bl9kdHJlZSksZmUodGhpcy5ibF90cmVlKSx0aGlzLmxfZGVzYz1udWxsLHRoaXMuZF9kZXNjPW51bGwsdGhpcy5ibF9kZXNjPW51bGwsdGhpcy5ibF9jb3VudD1uZXcgVWludDE2QXJyYXkoR3QrMSksdGhpcy5oZWFwPW5ldyBVaW50MTZBcnJheSgyKmp0KzEpLGZlKHRoaXMuaGVhcCksdGhpcy5oZWFwX2xlbj0wLHRoaXMuaGVhcF9tYXg9MCx0aGlzLmRlcHRoPW5ldyBVaW50MTZBcnJheSgyKmp0KzEpLGZlKHRoaXMuZGVwdGgpLHRoaXMubF9idWY9MCx0aGlzLmxpdF9idWZzaXplPTAsdGhpcy5sYXN0X2xpdD0wLHRoaXMuZF9idWY9MCx0aGlzLm9wdF9sZW49MCx0aGlzLnN0YXRpY19sZW49MCx0aGlzLm1hdGNoZXM9MCx0aGlzLmluc2VydD0wLHRoaXMuYmlfYnVmPTAsdGhpcy5iaV92YWxpZD0wfXZhciBSZT1mdW5jdGlvbih0KXtpZighdHx8IXQuc3RhdGUpcmV0dXJuIGxlKHQsUnQpO3QudG90YWxfaW49dC50b3RhbF9vdXQ9MCx0LmRhdGFfdHlwZT1adDt2YXIgZT10LnN0YXRlO3JldHVybiBlLnBlbmRpbmc9MCxlLnBlbmRpbmdfb3V0PTAsZS53cmFwPDAmJihlLndyYXA9LWUud3JhcCksZS5zdGF0dXM9ZS53cmFwP1F0Om5lLHQuYWRsZXI9Mj09PWUud3JhcD8wOjEsZS5sYXN0X2ZsdXNoPXh0LHZ0KGUpLFN0fSxEZT1mdW5jdGlvbih0KXt2YXIgZT1SZSh0KTtyZXR1cm4gZT09PVN0JiZTZSh0LnN0YXRlKSxlfSxMZT1mdW5jdGlvbih0LGUscixuLGEsaSl7aWYoIXQpcmV0dXJuIFJ0O3ZhciBvPTE7aWYoZT09PVV0JiYoZT02KSxuPDA/KG89MCxuPS1uKTpuPjE1JiYobz0yLG4tPTE2KSxhPDF8fGE+SXR8fHIhPT1NdHx8bjw4fHxuPjE1fHxlPDB8fGU+OXx8aTwwfHxpPkZ0KXJldHVybiBsZSh0LFJ0KTs4PT09biYmKG49OSk7dmFyIHM9bmV3IEJlO3JldHVybiB0LnN0YXRlPXMscy5zdHJtPXQscy53cmFwPW8scy5nemhlYWQ9bnVsbCxzLndfYml0cz1uLHMud19zaXplPTE8PHMud19iaXRzLHMud19tYXNrPXMud19zaXplLTEscy5oYXNoX2JpdHM9YSs3LHMuaGFzaF9zaXplPTE8PHMuaGFzaF9iaXRzLHMuaGFzaF9tYXNrPXMuaGFzaF9zaXplLTEscy5oYXNoX3NoaWZ0PX5+KChzLmhhc2hfYml0cytXdC0xKS9XdCkscy53aW5kb3c9bmV3IFVpbnQ4QXJyYXkoMipzLndfc2l6ZSkscy5oZWFkPW5ldyBVaW50MTZBcnJheShzLmhhc2hfc2l6ZSkscy5wcmV2PW5ldyBVaW50MTZBcnJheShzLndfc2l6ZSkscy5saXRfYnVmc2l6ZT0xPDxhKzYscy5wZW5kaW5nX2J1Zl9zaXplPTQqcy5saXRfYnVmc2l6ZSxzLnBlbmRpbmdfYnVmPW5ldyBVaW50OEFycmF5KHMucGVuZGluZ19idWZfc2l6ZSkscy5kX2J1Zj0xKnMubGl0X2J1ZnNpemUscy5sX2J1Zj0zKnMubGl0X2J1ZnNpemUscy5sZXZlbD1lLHMuc3RyYXRlZ3k9aSxzLm1ldGhvZD1yLERlKHQpfSxVZT17ZGVmbGF0ZUluaXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gTGUodCxlLE10LE50LFB0LEh0KX0sZGVmbGF0ZUluaXQyOkxlLGRlZmxhdGVSZXNldDpEZSxkZWZsYXRlUmVzZXRLZWVwOlJlLGRlZmxhdGVTZXRIZWFkZXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCYmdC5zdGF0ZT8yIT09dC5zdGF0ZS53cmFwP1J0Oih0LnN0YXRlLmd6aGVhZD1lLFN0KTpSdH0sZGVmbGF0ZTpmdW5jdGlvbih0LGUpe3ZhciByLG47aWYoIXR8fCF0LnN0YXRlfHxlPkV0fHxlPDApcmV0dXJuIHQ/bGUodCxSdCk6UnQ7dmFyIGE9dC5zdGF0ZTtpZighdC5vdXRwdXR8fCF0LmlucHV0JiYwIT09dC5hdmFpbF9pbnx8YS5zdGF0dXM9PT1hZSYmZSE9PUF0KXJldHVybiBsZSh0LDA9PT10LmF2YWlsX291dD9MdDpSdCk7YS5zdHJtPXQ7dmFyIGk9YS5sYXN0X2ZsdXNoO2lmKGEubGFzdF9mbHVzaD1lLGEuc3RhdHVzPT09UXQpaWYoMj09PWEud3JhcCl0LmFkbGVyPTAsZ2UoYSwzMSksZ2UoYSwxMzkpLGdlKGEsOCksYS5nemhlYWQ/KGdlKGEsKGEuZ3poZWFkLnRleHQ/MTowKSsoYS5nemhlYWQuaGNyYz8yOjApKyhhLmd6aGVhZC5leHRyYT80OjApKyhhLmd6aGVhZC5uYW1lPzg6MCkrKGEuZ3poZWFkLmNvbW1lbnQ/MTY6MCkpLGdlKGEsMjU1JmEuZ3poZWFkLnRpbWUpLGdlKGEsYS5nemhlYWQudGltZT4+OCYyNTUpLGdlKGEsYS5nemhlYWQudGltZT4+MTYmMjU1KSxnZShhLGEuZ3poZWFkLnRpbWU+PjI0JjI1NSksZ2UoYSw5PT09YS5sZXZlbD8yOmEuc3RyYXRlZ3k+PU90fHxhLmxldmVsPDI/NDowKSxnZShhLDI1NSZhLmd6aGVhZC5vcyksYS5nemhlYWQuZXh0cmEmJmEuZ3poZWFkLmV4dHJhLmxlbmd0aCYmKGdlKGEsMjU1JmEuZ3poZWFkLmV4dHJhLmxlbmd0aCksZ2UoYSxhLmd6aGVhZC5leHRyYS5sZW5ndGg+PjgmMjU1KSksYS5nemhlYWQuaGNyYyYmKHQuYWRsZXI9X3QodC5hZGxlcixhLnBlbmRpbmdfYnVmLGEucGVuZGluZywwKSksYS5nemluZGV4PTAsYS5zdGF0dXM9SnQpOihnZShhLDApLGdlKGEsMCksZ2UoYSwwKSxnZShhLDApLGdlKGEsMCksZ2UoYSw5PT09YS5sZXZlbD8yOmEuc3RyYXRlZ3k+PU90fHxhLmxldmVsPDI/NDowKSxnZShhLGhlKSxhLnN0YXR1cz1uZSk7ZWxzZXt2YXIgbz1NdCsoYS53X2JpdHMtODw8NCk8PDg7b3w9KGEuc3RyYXRlZ3k+PU90fHxhLmxldmVsPDI/MDphLmxldmVsPDY/MTo2PT09YS5sZXZlbD8yOjMpPDw2LDAhPT1hLnN0cnN0YXJ0JiYob3w9JHQpLG8rPTMxLW8lMzEsYS5zdGF0dXM9bmUsdmUoYSxvKSwwIT09YS5zdHJzdGFydCYmKHZlKGEsdC5hZGxlcj4+PjE2KSx2ZShhLDY1NTM1JnQuYWRsZXIpKSx0LmFkbGVyPTF9aWYoYS5zdGF0dXM9PT1KdClpZihhLmd6aGVhZC5leHRyYSl7Zm9yKHI9YS5wZW5kaW5nO2EuZ3ppbmRleDwoNjU1MzUmYS5nemhlYWQuZXh0cmEubGVuZ3RoKSYmKGEucGVuZGluZyE9PWEucGVuZGluZ19idWZfc2l6ZXx8KGEuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLF9lKHQpLHI9YS5wZW5kaW5nLGEucGVuZGluZyE9PWEucGVuZGluZ19idWZfc2l6ZSkpOylnZShhLDI1NSZhLmd6aGVhZC5leHRyYVthLmd6aW5kZXhdKSxhLmd6aW5kZXgrKzthLmd6aGVhZC5oY3JjJiZhLnBlbmRpbmc+ciYmKHQuYWRsZXI9X3QodC5hZGxlcixhLnBlbmRpbmdfYnVmLGEucGVuZGluZy1yLHIpKSxhLmd6aW5kZXg9PT1hLmd6aGVhZC5leHRyYS5sZW5ndGgmJihhLmd6aW5kZXg9MCxhLnN0YXR1cz10ZSl9ZWxzZSBhLnN0YXR1cz10ZTtpZihhLnN0YXR1cz09PXRlKWlmKGEuZ3poZWFkLm5hbWUpe3I9YS5wZW5kaW5nO2Rve2lmKGEucGVuZGluZz09PWEucGVuZGluZ19idWZfc2l6ZSYmKGEuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLF9lKHQpLHI9YS5wZW5kaW5nLGEucGVuZGluZz09PWEucGVuZGluZ19idWZfc2l6ZSkpe249MTticmVha31uPWEuZ3ppbmRleDxhLmd6aGVhZC5uYW1lLmxlbmd0aD8yNTUmYS5nemhlYWQubmFtZS5jaGFyQ29kZUF0KGEuZ3ppbmRleCsrKTowLGdlKGEsbil9d2hpbGUoMCE9PW4pO2EuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLDA9PT1uJiYoYS5nemluZGV4PTAsYS5zdGF0dXM9ZWUpfWVsc2UgYS5zdGF0dXM9ZWU7aWYoYS5zdGF0dXM9PT1lZSlpZihhLmd6aGVhZC5jb21tZW50KXtyPWEucGVuZGluZztkb3tpZihhLnBlbmRpbmc9PT1hLnBlbmRpbmdfYnVmX3NpemUmJihhLmd6aGVhZC5oY3JjJiZhLnBlbmRpbmc+ciYmKHQuYWRsZXI9X3QodC5hZGxlcixhLnBlbmRpbmdfYnVmLGEucGVuZGluZy1yLHIpKSxfZSh0KSxyPWEucGVuZGluZyxhLnBlbmRpbmc9PT1hLnBlbmRpbmdfYnVmX3NpemUpKXtuPTE7YnJlYWt9bj1hLmd6aW5kZXg8YS5nemhlYWQuY29tbWVudC5sZW5ndGg/MjU1JmEuZ3poZWFkLmNvbW1lbnQuY2hhckNvZGVBdChhLmd6aW5kZXgrKyk6MCxnZShhLG4pfXdoaWxlKDAhPT1uKTthLmd6aGVhZC5oY3JjJiZhLnBlbmRpbmc+ciYmKHQuYWRsZXI9X3QodC5hZGxlcixhLnBlbmRpbmdfYnVmLGEucGVuZGluZy1yLHIpKSwwPT09biYmKGEuc3RhdHVzPXJlKX1lbHNlIGEuc3RhdHVzPXJlO2lmKGEuc3RhdHVzPT09cmUmJihhLmd6aGVhZC5oY3JjPyhhLnBlbmRpbmcrMj5hLnBlbmRpbmdfYnVmX3NpemUmJl9lKHQpLGEucGVuZGluZysyPD1hLnBlbmRpbmdfYnVmX3NpemUmJihnZShhLDI1NSZ0LmFkbGVyKSxnZShhLHQuYWRsZXI+PjgmMjU1KSx0LmFkbGVyPTAsYS5zdGF0dXM9bmUpKTphLnN0YXR1cz1uZSksMCE9PWEucGVuZGluZyl7aWYoX2UodCksMD09PXQuYXZhaWxfb3V0KXJldHVybiBhLmxhc3RfZmx1c2g9LTEsU3R9ZWxzZSBpZigwPT09dC5hdmFpbF9pbiYmdWUoZSk8PXVlKGkpJiZlIT09QXQpcmV0dXJuIGxlKHQsTHQpO2lmKGEuc3RhdHVzPT09YWUmJjAhPT10LmF2YWlsX2luKXJldHVybiBsZSh0LEx0KTtpZigwIT09dC5hdmFpbF9pbnx8MCE9PWEubG9va2FoZWFkfHxlIT09eHQmJmEuc3RhdHVzIT09YWUpe3ZhciBzPWEuc3RyYXRlZ3k9PT1PdD96ZShhLGUpOmEuc3RyYXRlZ3k9PT1UdD9rZShhLGUpOkVlW2EubGV2ZWxdLmZ1bmMoYSxlKTtpZihzIT09c2UmJnMhPT1jZXx8KGEuc3RhdHVzPWFlKSxzPT09aWV8fHM9PT1zZSlyZXR1cm4gMD09PXQuYXZhaWxfb3V0JiYoYS5sYXN0X2ZsdXNoPS0xKSxTdDtpZihzPT09b2UmJihlPT09a3Q/YnQoYSk6ZSE9PUV0JiYoeXQoYSwwLDAsITEpLGU9PT16dCYmKGZlKGEuaGVhZCksMD09PWEubG9va2FoZWFkJiYoYS5zdHJzdGFydD0wLGEuYmxvY2tfc3RhcnQ9MCxhLmluc2VydD0wKSkpLF9lKHQpLDA9PT10LmF2YWlsX291dCkpcmV0dXJuIGEubGFzdF9mbHVzaD0tMSxTdH1yZXR1cm4gZSE9PUF0P1N0OmEud3JhcDw9MD9CdDooMj09PWEud3JhcD8oZ2UoYSwyNTUmdC5hZGxlciksZ2UoYSx0LmFkbGVyPj44JjI1NSksZ2UoYSx0LmFkbGVyPj4xNiYyNTUpLGdlKGEsdC5hZGxlcj4+MjQmMjU1KSxnZShhLDI1NSZ0LnRvdGFsX2luKSxnZShhLHQudG90YWxfaW4+PjgmMjU1KSxnZShhLHQudG90YWxfaW4+PjE2JjI1NSksZ2UoYSx0LnRvdGFsX2luPj4yNCYyNTUpKToodmUoYSx0LmFkbGVyPj4+MTYpLHZlKGEsNjU1MzUmdC5hZGxlcikpLF9lKHQpLGEud3JhcD4wJiYoYS53cmFwPS1hLndyYXApLDAhPT1hLnBlbmRpbmc/U3Q6QnQpfSxkZWZsYXRlRW5kOmZ1bmN0aW9uKHQpe2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gUnQ7dmFyIGU9dC5zdGF0ZS5zdGF0dXM7cmV0dXJuIGUhPT1RdCYmZSE9PUp0JiZlIT09dGUmJmUhPT1lZSYmZSE9PXJlJiZlIT09bmUmJmUhPT1hZT9sZSh0LFJ0KToodC5zdGF0ZT1udWxsLGU9PT1uZT9sZSh0LER0KTpTdCl9LGRlZmxhdGVTZXREaWN0aW9uYXJ5OmZ1bmN0aW9uKHQsZSl7dmFyIHI9ZS5sZW5ndGg7aWYoIXR8fCF0LnN0YXRlKXJldHVybiBSdDt2YXIgbj10LnN0YXRlLGE9bi53cmFwO2lmKDI9PT1hfHwxPT09YSYmbi5zdGF0dXMhPT1RdHx8bi5sb29rYWhlYWQpcmV0dXJuIFJ0O2lmKDE9PT1hJiYodC5hZGxlcj1mdCh0LmFkbGVyLGUsciwwKSksbi53cmFwPTAscj49bi53X3NpemUpezA9PT1hJiYoZmUobi5oZWFkKSxuLnN0cnN0YXJ0PTAsbi5ibG9ja19zdGFydD0wLG4uaW5zZXJ0PTApO3ZhciBpPW5ldyBVaW50OEFycmF5KG4ud19zaXplKTtpLnNldChlLnN1YmFycmF5KHItbi53X3NpemUsciksMCksZT1pLHI9bi53X3NpemV9dmFyIG89dC5hdmFpbF9pbixzPXQubmV4dF9pbixjPXQuaW5wdXQ7Zm9yKHQuYXZhaWxfaW49cix0Lm5leHRfaW49MCx0LmlucHV0PWUsbWUobik7bi5sb29rYWhlYWQ+PVd0Oyl7dmFyIGg9bi5zdHJzdGFydCxsPW4ubG9va2FoZWFkLShXdC0xKTtkb3tuLmluc19oPWRlKG4sbi5pbnNfaCxuLndpbmRvd1toK1d0LTFdKSxuLnByZXZbaCZuLndfbWFza109bi5oZWFkW24uaW5zX2hdLG4uaGVhZFtuLmluc19oXT1oLGgrK313aGlsZSgtLWwpO24uc3Ryc3RhcnQ9aCxuLmxvb2thaGVhZD1XdC0xLG1lKG4pfXJldHVybiBuLnN0cnN0YXJ0Kz1uLmxvb2thaGVhZCxuLmJsb2NrX3N0YXJ0PW4uc3Ryc3RhcnQsbi5pbnNlcnQ9bi5sb29rYWhlYWQsbi5sb29rYWhlYWQ9MCxuLm1hdGNoX2xlbmd0aD1uLnByZXZfbGVuZ3RoPVd0LTEsbi5tYXRjaF9hdmFpbGFibGU9MCx0Lm5leHRfaW49cyx0LmlucHV0PWMsdC5hdmFpbF9pbj1vLG4ud3JhcD1hLFN0fSxkZWZsYXRlSW5mbzoicGFrbyBkZWZsYXRlIChmcm9tIE5vZGVjYSBwcm9qZWN0KSJ9LENlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGUpfSxPZT1mdW5jdGlvbihlKXtmb3IodmFyIHI9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3IubGVuZ3RoOyl7dmFyIG49ci5zaGlmdCgpO2lmKG4pe2lmKCJvYmplY3QiIT09dChuKSl0aHJvdyBuZXcgVHlwZUVycm9yKG4rIm11c3QgYmUgbm9uLW9iamVjdCIpO2Zvcih2YXIgYSBpbiBuKUNlKG4sYSkmJihlW2FdPW5bYV0pfX1yZXR1cm4gZX0sVGU9e2Fzc2lnbjpPZSxmbGF0dGVuQ2h1bmtzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLHI9MCxuPXQubGVuZ3RoO3I8bjtyKyspZSs9dFtyXS5sZW5ndGg7Zm9yKHZhciBhPW5ldyBVaW50OEFycmF5KGUpLGk9MCxvPTAscz10Lmxlbmd0aDtpPHM7aSsrKXt2YXIgYz10W2ldO2Euc2V0KGMsbyksbys9Yy5sZW5ndGh9cmV0dXJuIGF9fSxGZT0hMDt0cnl7U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG5ldyBVaW50OEFycmF5KDEpKX1jYXRjaCh0KXtGZT0hMX1mb3IodmFyIEhlPW5ldyBVaW50OEFycmF5KDI1NiksWmU9MDtaZTwyNTY7WmUrKylIZVtaZV09WmU+PTI1Mj82OlplPj0yNDg/NTpaZT49MjQwPzQ6WmU+PTIyND8zOlplPj0xOTI/MjoxO0hlWzI1NF09SGVbMjU0XT0xO3ZhciBNZT1mdW5jdGlvbih0LGUpe2lmKGU8NjU1MzQmJnQuc3ViYXJyYXkmJkZlKXJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5sZW5ndGg9PT1lP3Q6dC5zdWJhcnJheSgwLGUpKTtmb3IodmFyIHI9IiIsbj0wO248ZTtuKyspcis9U3RyaW5nLmZyb21DaGFyQ29kZSh0W25dKTtyZXR1cm4gcn0sSWU9e3N0cmluZzJidWY6ZnVuY3Rpb24odCl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIFRleHRFbmNvZGVyJiZUZXh0RW5jb2Rlci5wcm90b3R5cGUuZW5jb2RlKXJldHVybihuZXcgVGV4dEVuY29kZXIpLmVuY29kZSh0KTt2YXIgZSxyLG4sYSxpLG89dC5sZW5ndGgscz0wO2ZvcihhPTA7YTxvO2ErKyk1NTI5Nj09KDY0NTEyJihyPXQuY2hhckNvZGVBdChhKSkpJiZhKzE8byYmNTYzMjA9PSg2NDUxMiYobj10LmNoYXJDb2RlQXQoYSsxKSkpJiYocj02NTUzNisoci01NTI5Njw8MTApKyhuLTU2MzIwKSxhKyspLHMrPXI8MTI4PzE6cjwyMDQ4PzI6cjw2NTUzNj8zOjQ7Zm9yKGU9bmV3IFVpbnQ4QXJyYXkocyksaT0wLGE9MDtpPHM7YSsrKTU1Mjk2PT0oNjQ1MTImKHI9dC5jaGFyQ29kZUF0KGEpKSkmJmErMTxvJiY1NjMyMD09KDY0NTEyJihuPXQuY2hhckNvZGVBdChhKzEpKSkmJihyPTY1NTM2KyhyLTU1Mjk2PDwxMCkrKG4tNTYzMjApLGErKykscjwxMjg/ZVtpKytdPXI6cjwyMDQ4PyhlW2krK109MTkyfHI+Pj42LGVbaSsrXT0xMjh8NjMmcik6cjw2NTUzNj8oZVtpKytdPTIyNHxyPj4+MTIsZVtpKytdPTEyOHxyPj4+NiY2MyxlW2krK109MTI4fDYzJnIpOihlW2krK109MjQwfHI+Pj4xOCxlW2krK109MTI4fHI+Pj4xMiY2MyxlW2krK109MTI4fHI+Pj42JjYzLGVbaSsrXT0xMjh8NjMmcik7cmV0dXJuIGV9LGJ1ZjJzdHJpbmc6ZnVuY3Rpb24odCxlKXt2YXIgcixuLGE9ZXx8dC5sZW5ndGg7aWYoImZ1bmN0aW9uIj09dHlwZW9mIFRleHREZWNvZGVyJiZUZXh0RGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlKXJldHVybihuZXcgVGV4dERlY29kZXIpLmRlY29kZSh0LnN1YmFycmF5KDAsZSkpO3ZhciBpPW5ldyBBcnJheSgyKmEpO2ZvcihuPTAscj0wO3I8YTspe3ZhciBvPXRbcisrXTtpZihvPDEyOClpW24rK109bztlbHNle3ZhciBzPUhlW29dO2lmKHM+NClpW24rK109NjU1MzMscis9cy0xO2Vsc2V7Zm9yKG8mPTI9PT1zPzMxOjM9PT1zPzE1Ojc7cz4xJiZyPGE7KW89bzw8Nnw2MyZ0W3IrK10scy0tO3M+MT9pW24rK109NjU1MzM6bzw2NTUzNj9pW24rK109bzooby09NjU1MzYsaVtuKytdPTU1Mjk2fG8+PjEwJjEwMjMsaVtuKytdPTU2MzIwfDEwMjMmbyl9fX1yZXR1cm4gTWUoaSxuKX0sdXRmOGJvcmRlcjpmdW5jdGlvbih0LGUpeyhlPWV8fHQubGVuZ3RoKT50Lmxlbmd0aCYmKGU9dC5sZW5ndGgpO2Zvcih2YXIgcj1lLTE7cj49MCYmMTI4PT0oMTkyJnRbcl0pOylyLS07cmV0dXJuIHI8MHx8MD09PXI/ZTpyK0hlW3Rbcl1dPmU/cjplfX07ZnVuY3Rpb24gTmUoKXt0aGlzLmlucHV0PW51bGwsdGhpcy5uZXh0X2luPTAsdGhpcy5hdmFpbF9pbj0wLHRoaXMudG90YWxfaW49MCx0aGlzLm91dHB1dD1udWxsLHRoaXMubmV4dF9vdXQ9MCx0aGlzLmF2YWlsX291dD0wLHRoaXMudG90YWxfb3V0PTAsdGhpcy5tc2c9IiIsdGhpcy5zdGF0ZT1udWxsLHRoaXMuZGF0YV90eXBlPTIsdGhpcy5hZGxlcj0wfXZhciBQZT1OZSxqZT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEtlPWd0LlpfTk9fRkxVU0gsWGU9Z3QuWl9TWU5DX0ZMVVNILHFlPWd0LlpfRlVMTF9GTFVTSCxHZT1ndC5aX0ZJTklTSCxXZT1ndC5aX09LLFllPWd0LlpfU1RSRUFNX0VORCxWZT1ndC5aX0RFRkFVTFRfQ09NUFJFU1NJT04sJGU9Z3QuWl9ERUZBVUxUX1NUUkFURUdZLFFlPWd0LlpfREVGTEFURUQ7ZnVuY3Rpb24gSmUodCl7dGhpcy5vcHRpb25zPVRlLmFzc2lnbih7bGV2ZWw6VmUsbWV0aG9kOlFlLGNodW5rU2l6ZToxNjM4NCx3aW5kb3dCaXRzOjE1LG1lbUxldmVsOjgsc3RyYXRlZ3k6JGV9LHR8fHt9KTt2YXIgZT10aGlzLm9wdGlvbnM7ZS5yYXcmJmUud2luZG93Qml0cz4wP2Uud2luZG93Qml0cz0tZS53aW5kb3dCaXRzOmUuZ3ppcCYmZS53aW5kb3dCaXRzPjAmJmUud2luZG93Qml0czwxNiYmKGUud2luZG93Qml0cys9MTYpLHRoaXMuZXJyPTAsdGhpcy5tc2c9IiIsdGhpcy5lbmRlZD0hMSx0aGlzLmNodW5rcz1bXSx0aGlzLnN0cm09bmV3IFBlLHRoaXMuc3RybS5hdmFpbF9vdXQ9MDt2YXIgcj1VZS5kZWZsYXRlSW5pdDIodGhpcy5zdHJtLGUubGV2ZWwsZS5tZXRob2QsZS53aW5kb3dCaXRzLGUubWVtTGV2ZWwsZS5zdHJhdGVneSk7aWYociE9PVdlKXRocm93IG5ldyBFcnJvcihwdFtyXSk7aWYoZS5oZWFkZXImJlVlLmRlZmxhdGVTZXRIZWFkZXIodGhpcy5zdHJtLGUuaGVhZGVyKSxlLmRpY3Rpb25hcnkpe3ZhciBuO2lmKG49InN0cmluZyI9PXR5cGVvZiBlLmRpY3Rpb25hcnk/SWUuc3RyaW5nMmJ1ZihlLmRpY3Rpb25hcnkpOiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT1qZS5jYWxsKGUuZGljdGlvbmFyeSk/bmV3IFVpbnQ4QXJyYXkoZS5kaWN0aW9uYXJ5KTplLmRpY3Rpb25hcnksKHI9VWUuZGVmbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLG4pKSE9PVdlKXRocm93IG5ldyBFcnJvcihwdFtyXSk7dGhpcy5fZGljdF9zZXQ9ITB9fWZ1bmN0aW9uIHRyKHQsZSl7dmFyIHI9bmV3IEplKGUpO2lmKHIucHVzaCh0LCEwKSxyLmVycil0aHJvdyByLm1zZ3x8cHRbci5lcnJdO3JldHVybiByLnJlc3VsdH1mdW5jdGlvbiBlcih0LGUpe3JldHVybihlPWV8fHt9KS5yYXc9ITAsdHIodCxlKX1mdW5jdGlvbiBycih0LGUpe3JldHVybihlPWV8fHt9KS5nemlwPSEwLHRyKHQsZSl9SmUucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odCxlKXt2YXIgcixuLGE9dGhpcy5zdHJtLGk9dGhpcy5vcHRpb25zLmNodW5rU2l6ZTtpZih0aGlzLmVuZGVkKXJldHVybiExO2ZvcihuPWU9PT1+fmU/ZTohMD09PWU/R2U6S2UsInN0cmluZyI9PXR5cGVvZiB0P2EuaW5wdXQ9SWUuc3RyaW5nMmJ1Zih0KToiW29iamVjdCBBcnJheUJ1ZmZlcl0iPT09amUuY2FsbCh0KT9hLmlucHV0PW5ldyBVaW50OEFycmF5KHQpOmEuaW5wdXQ9dCxhLm5leHRfaW49MCxhLmF2YWlsX2luPWEuaW5wdXQubGVuZ3RoOzspaWYoMD09PWEuYXZhaWxfb3V0JiYoYS5vdXRwdXQ9bmV3IFVpbnQ4QXJyYXkoaSksYS5uZXh0X291dD0wLGEuYXZhaWxfb3V0PWkpLChuPT09WGV8fG49PT1xZSkmJmEuYXZhaWxfb3V0PD02KXRoaXMub25EYXRhKGEub3V0cHV0LnN1YmFycmF5KDAsYS5uZXh0X291dCkpLGEuYXZhaWxfb3V0PTA7ZWxzZXtpZigocj1VZS5kZWZsYXRlKGEsbikpPT09WWUpcmV0dXJuIGEubmV4dF9vdXQ+MCYmdGhpcy5vbkRhdGEoYS5vdXRwdXQuc3ViYXJyYXkoMCxhLm5leHRfb3V0KSkscj1VZS5kZWZsYXRlRW5kKHRoaXMuc3RybSksdGhpcy5vbkVuZChyKSx0aGlzLmVuZGVkPSEwLHI9PT1XZTtpZigwIT09YS5hdmFpbF9vdXQpe2lmKG4+MCYmYS5uZXh0X291dD4wKXRoaXMub25EYXRhKGEub3V0cHV0LnN1YmFycmF5KDAsYS5uZXh0X291dCkpLGEuYXZhaWxfb3V0PTA7ZWxzZSBpZigwPT09YS5hdmFpbF9pbilicmVha31lbHNlIHRoaXMub25EYXRhKGEub3V0cHV0KX1yZXR1cm4hMH0sSmUucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbih0KXt0aGlzLmNodW5rcy5wdXNoKHQpfSxKZS5wcm90b3R5cGUub25FbmQ9ZnVuY3Rpb24odCl7dD09PVdlJiYodGhpcy5yZXN1bHQ9VGUuZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpLHRoaXMuY2h1bmtzPVtdLHRoaXMuZXJyPXQsdGhpcy5tc2c9dGhpcy5zdHJtLm1zZ307dmFyIG5yPUplLGFyPXRyLGlyPWVyLG9yPXJyLHNyPWd0LGNyPXtEZWZsYXRlOm5yLGRlZmxhdGU6YXIsZGVmbGF0ZVJhdzppcixnemlwOm9yLGNvbnN0YW50czpzcn07ZS5EZWZsYXRlPW5yLGUuY29uc3RhbnRzPXNyLGUuZGVmYXVsdD1jcixlLmRlZmxhdGU9YXIsZS5kZWZsYXRlUmF3PWlyLGUuZ3ppcD1vcixPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSl9KShvLmV4cG9ydHMpO3ZhciBzLGM9e2V4cG9ydHM6e319LGg9e2V4cG9ydHM6e319O2guZXhwb3J0cz0ocz1zfHxmdW5jdGlvbih0LGUpe3ZhciByO2lmKCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuY3J5cHRvJiYocj13aW5kb3cuY3J5cHRvKSwidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGYmJnNlbGYuY3J5cHRvJiYocj1zZWxmLmNyeXB0byksInVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWxUaGlzJiZnbG9iYWxUaGlzLmNyeXB0byYmKHI9Z2xvYmFsVGhpcy5jcnlwdG8pLCFyJiYidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93Lm1zQ3J5cHRvJiYocj13aW5kb3cubXNDcnlwdG8pLCFyJiZ2b2lkIDAhPT1pJiZpLmNyeXB0byYmKHI9aS5jcnlwdG8pLCFyKXRyeXtyPXVuZGVmaW5lZH1jYXRjaCh0KXt9dmFyIG49ZnVuY3Rpb24oKXtpZihyKXtpZigiZnVuY3Rpb24iPT10eXBlb2Ygci5nZXRSYW5kb21WYWx1ZXMpdHJ5e3JldHVybiByLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDMyQXJyYXkoMSkpWzBdfWNhdGNoKHQpe31pZigiZnVuY3Rpb24iPT10eXBlb2Ygci5yYW5kb21CeXRlcyl0cnl7cmV0dXJuIHIucmFuZG9tQnl0ZXMoNCkucmVhZEludDMyTEUoKX1jYXRjaCh0KXt9fXRocm93IG5ldyBFcnJvcigiTmF0aXZlIGNyeXB0byBtb2R1bGUgY291bGQgbm90IGJlIHVzZWQgdG8gZ2V0IHNlY3VyZSByYW5kb20gbnVtYmVyLiIpfSxhPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHI7cmV0dXJuIHQucHJvdG90eXBlPWUscj1uZXcgdCx0LnByb3RvdHlwZT1udWxsLHJ9fSgpLG89e30scz1vLmxpYj17fSxjPXMuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKHQpe3ZhciBlPWEodGhpcyk7cmV0dXJuIHQmJmUubWl4SW4odCksZS5oYXNPd25Qcm9wZXJ0eSgiaW5pdCIpJiZ0aGlzLmluaXQhPT1lLmluaXR8fChlLmluaXQ9ZnVuY3Rpb24oKXtlLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLGUuaW5pdC5wcm90b3R5cGU9ZSxlLiRzdXBlcj10aGlzLGV9LGNyZWF0ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZXh0ZW5kKCk7cmV0dXJuIHQuaW5pdC5hcHBseSh0LGFyZ3VtZW50cyksdH0saW5pdDpmdW5jdGlvbigpe30sbWl4SW46ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXNbZV09dFtlXSk7dC5oYXNPd25Qcm9wZXJ0eSgidG9TdHJpbmciKSYmKHRoaXMudG9TdHJpbmc9dC50b1N0cmluZyl9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpfX0saD1zLldvcmRBcnJheT1jLmV4dGVuZCh7aW5pdDpmdW5jdGlvbih0LHIpe3Q9dGhpcy53b3Jkcz10fHxbXSx0aGlzLnNpZ0J5dGVzPXIhPWU/cjo0KnQubGVuZ3RofSx0b1N0cmluZzpmdW5jdGlvbih0KXtyZXR1cm4odHx8dSkuc3RyaW5naWZ5KHRoaXMpfSxjb25jYXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy53b3JkcyxyPXQud29yZHMsbj10aGlzLnNpZ0J5dGVzLGE9dC5zaWdCeXRlcztpZih0aGlzLmNsYW1wKCksbiU0KWZvcih2YXIgaT0wO2k8YTtpKyspe3ZhciBvPXJbaT4+PjJdPj4+MjQtaSU0KjgmMjU1O2VbbitpPj4+Ml18PW88PDI0LShuK2kpJTQqOH1lbHNlIGZvcih2YXIgcz0wO3M8YTtzKz00KWVbbitzPj4+Ml09cltzPj4+Ml07cmV0dXJuIHRoaXMuc2lnQnl0ZXMrPWEsdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLndvcmRzLHI9dGhpcy5zaWdCeXRlcztlW3I+Pj4yXSY9NDI5NDk2NzI5NTw8MzItciU0KjgsZS5sZW5ndGg9dC5jZWlsKHIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9Yy5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0LndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksdH0scmFuZG9tOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxyPTA7cjx0O3IrPTQpZS5wdXNoKG4oKSk7cmV0dXJuIG5ldyBoLmluaXQoZSx0KX19KSxsPW8uZW5jPXt9LHU9bC5IZXg9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsbj1bXSxhPTA7YTxyO2ErKyl7dmFyIGk9ZVthPj4+Ml0+Pj4yNC1hJTQqOCYyNTU7bi5wdXNoKChpPj4+NCkudG9TdHJpbmcoMTYpKSxuLnB1c2goKDE1JmkpLnRvU3RyaW5nKDE2KSl9cmV0dXJuIG4uam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10Lmxlbmd0aCxyPVtdLG49MDtuPGU7bis9MilyW24+Pj4zXXw9cGFyc2VJbnQodC5zdWJzdHIobiwyKSwxNik8PDI0LW4lOCo0O3JldHVybiBuZXcgaC5pbml0KHIsZS8yKX19LGY9bC5MYXRpbjE9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsbj1bXSxhPTA7YTxyO2ErKyl7dmFyIGk9ZVthPj4+Ml0+Pj4yNC1hJTQqOCYyNTU7bi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoaSkpfXJldHVybiBuLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5sZW5ndGgscj1bXSxuPTA7bjxlO24rKylyW24+Pj4yXXw9KDI1NSZ0LmNoYXJDb2RlQXQobikpPDwyNC1uJTQqODtyZXR1cm4gbmV3IGguaW5pdChyLGUpfX0sZD1sLlV0Zjg9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoZi5zdHJpbmdpZnkodCkpKX1jYXRjaCh0KXt0aHJvdyBuZXcgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIil9fSxwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gZi5wYXJzZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodCkpKX19LF89cy5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPWMuZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IGguaW5pdCx0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24odCl7InN0cmluZyI9PXR5cGVvZiB0JiYodD1kLnBhcnNlKHQpKSx0aGlzLl9kYXRhLmNvbmNhdCh0KSx0aGlzLl9uRGF0YUJ5dGVzKz10LnNpZ0J5dGVzfSxfcHJvY2VzczpmdW5jdGlvbihlKXt2YXIgcixuPXRoaXMuX2RhdGEsYT1uLndvcmRzLGk9bi5zaWdCeXRlcyxvPXRoaXMuYmxvY2tTaXplLHM9aS8oNCpvKSxjPShzPWU/dC5jZWlsKHMpOnQubWF4KCgwfHMpLXRoaXMuX21pbkJ1ZmZlclNpemUsMCkpKm8sbD10Lm1pbig0KmMsaSk7aWYoYyl7Zm9yKHZhciB1PTA7dTxjO3UrPW8pdGhpcy5fZG9Qcm9jZXNzQmxvY2soYSx1KTtyPWEuc3BsaWNlKDAsYyksbi5zaWdCeXRlcy09bH1yZXR1cm4gbmV3IGguaW5pdChyLGwpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWMuY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gdC5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCksdH0sX21pbkJ1ZmZlclNpemU6MH0pO3MuSGFzaGVyPV8uZXh0ZW5kKHtjZmc6Yy5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKHQpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZCh0KSx0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7Xy5yZXNldC5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9hcHBlbmQodCksdGhpcy5fcHJvY2VzcygpLHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLl9hcHBlbmQodCksdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyKXtyZXR1cm4gbmV3IHQuaW5pdChyKS5maW5hbGl6ZShlKX19LF9jcmVhdGVIbWFjSGVscGVyOmZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIpe3JldHVybiBuZXcgcC5ITUFDLmluaXQodCxyKS5maW5hbGl6ZShlKX19fSk7dmFyIHA9by5hbGdvPXt9O3JldHVybiBvfShNYXRoKSxzKSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT10LHI9ZS5saWIuV29yZEFycmF5O2Z1bmN0aW9uIG4odCxlLG4pe2Zvcih2YXIgYT1bXSxpPTAsbz0wO288ZTtvKyspaWYobyU0KXt2YXIgcz1uW3QuY2hhckNvZGVBdChvLTEpXTw8byU0KjJ8blt0LmNoYXJDb2RlQXQobyldPj4+Ni1vJTQqMjthW2k+Pj4yXXw9czw8MjQtaSU0KjgsaSsrfXJldHVybiByLmNyZWF0ZShhLGkpfWUuZW5jLkJhc2U2ND17c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe3ZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLG49dGhpcy5fbWFwO3QuY2xhbXAoKTtmb3IodmFyIGE9W10saT0wO2k8cjtpKz0zKWZvcih2YXIgbz0oZVtpPj4+Ml0+Pj4yNC1pJTQqOCYyNTUpPDwxNnwoZVtpKzE+Pj4yXT4+PjI0LShpKzEpJTQqOCYyNTUpPDw4fGVbaSsyPj4+Ml0+Pj4yNC0oaSsyKSU0KjgmMjU1LHM9MDtzPDQmJmkrLjc1KnM8cjtzKyspYS5wdXNoKG4uY2hhckF0KG8+Pj42KigzLXMpJjYzKSk7dmFyIGM9bi5jaGFyQXQoNjQpO2lmKGMpZm9yKDthLmxlbmd0aCU0OylhLnB1c2goYyk7cmV0dXJuIGEuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKHQpe3ZhciBlPXQubGVuZ3RoLHI9dGhpcy5fbWFwLGE9dGhpcy5fcmV2ZXJzZU1hcDtpZighYSl7YT10aGlzLl9yZXZlcnNlTWFwPVtdO2Zvcih2YXIgaT0wO2k8ci5sZW5ndGg7aSsrKWFbci5jaGFyQ29kZUF0KGkpXT1pfXZhciBvPXIuY2hhckF0KDY0KTtpZihvKXt2YXIgcz10LmluZGV4T2Yobyk7LTEhPT1zJiYoZT1zKX1yZXR1cm4gbih0LGUsYSl9LF9tYXA6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89In19KCksdC5lbmMuQmFzZTY0fShoLmV4cG9ydHMpfShjKTt2YXIgbD1jLmV4cG9ydHMsdT17ZXhwb3J0czp7fX0sZj17ZXhwb3J0czp7fX07IWZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgcj10LG49ci5saWIsYT1uLldvcmRBcnJheSxpPW4uSGFzaGVyLG89ci5hbGdvLHM9W107IWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTA7dDw2NDt0Kyspc1t0XT00Mjk0OTY3Mjk2KmUuYWJzKGUuc2luKHQrMSkpfDB9KCk7dmFyIGM9by5NRDU9aS5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgYS5pbml0KFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPTA7cjwxNjtyKyspe3ZhciBuPWUrcixhPXRbbl07dFtuXT0xNjcxMTkzNSYoYTw8OHxhPj4+MjQpfDQyNzgyNTUzNjAmKGE8PDI0fGE+Pj44KX12YXIgaT10aGlzLl9oYXNoLndvcmRzLG89dFtlKzBdLGM9dFtlKzFdLGQ9dFtlKzJdLF89dFtlKzNdLHA9dFtlKzRdLGc9dFtlKzVdLHY9dFtlKzZdLHk9dFtlKzddLHc9dFtlKzhdLG09dFtlKzldLGI9dFtlKzEwXSx4PXRbZSsxMV0saz10W2UrMTJdLHo9dFtlKzEzXSxBPXRbZSsxNF0sRT10W2UrMTVdLFM9aVswXSxCPWlbMV0sUj1pWzJdLEQ9aVszXTtTPWgoUyxCLFIsRCxvLDcsc1swXSksRD1oKEQsUyxCLFIsYywxMixzWzFdKSxSPWgoUixELFMsQixkLDE3LHNbMl0pLEI9aChCLFIsRCxTLF8sMjIsc1szXSksUz1oKFMsQixSLEQscCw3LHNbNF0pLEQ9aChELFMsQixSLGcsMTIsc1s1XSksUj1oKFIsRCxTLEIsdiwxNyxzWzZdKSxCPWgoQixSLEQsUyx5LDIyLHNbN10pLFM9aChTLEIsUixELHcsNyxzWzhdKSxEPWgoRCxTLEIsUixtLDEyLHNbOV0pLFI9aChSLEQsUyxCLGIsMTcsc1sxMF0pLEI9aChCLFIsRCxTLHgsMjIsc1sxMV0pLFM9aChTLEIsUixELGssNyxzWzEyXSksRD1oKEQsUyxCLFIseiwxMixzWzEzXSksUj1oKFIsRCxTLEIsQSwxNyxzWzE0XSksUz1sKFMsQj1oKEIsUixELFMsRSwyMixzWzE1XSksUixELGMsNSxzWzE2XSksRD1sKEQsUyxCLFIsdiw5LHNbMTddKSxSPWwoUixELFMsQix4LDE0LHNbMThdKSxCPWwoQixSLEQsUyxvLDIwLHNbMTldKSxTPWwoUyxCLFIsRCxnLDUsc1syMF0pLEQ9bChELFMsQixSLGIsOSxzWzIxXSksUj1sKFIsRCxTLEIsRSwxNCxzWzIyXSksQj1sKEIsUixELFMscCwyMCxzWzIzXSksUz1sKFMsQixSLEQsbSw1LHNbMjRdKSxEPWwoRCxTLEIsUixBLDksc1syNV0pLFI9bChSLEQsUyxCLF8sMTQsc1syNl0pLEI9bChCLFIsRCxTLHcsMjAsc1syN10pLFM9bChTLEIsUixELHosNSxzWzI4XSksRD1sKEQsUyxCLFIsZCw5LHNbMjldKSxSPWwoUixELFMsQix5LDE0LHNbMzBdKSxTPXUoUyxCPWwoQixSLEQsUyxrLDIwLHNbMzFdKSxSLEQsZyw0LHNbMzJdKSxEPXUoRCxTLEIsUix3LDExLHNbMzNdKSxSPXUoUixELFMsQix4LDE2LHNbMzRdKSxCPXUoQixSLEQsUyxBLDIzLHNbMzVdKSxTPXUoUyxCLFIsRCxjLDQsc1szNl0pLEQ9dShELFMsQixSLHAsMTEsc1szN10pLFI9dShSLEQsUyxCLHksMTYsc1szOF0pLEI9dShCLFIsRCxTLGIsMjMsc1szOV0pLFM9dShTLEIsUixELHosNCxzWzQwXSksRD11KEQsUyxCLFIsbywxMSxzWzQxXSksUj11KFIsRCxTLEIsXywxNixzWzQyXSksQj11KEIsUixELFMsdiwyMyxzWzQzXSksUz11KFMsQixSLEQsbSw0LHNbNDRdKSxEPXUoRCxTLEIsUixrLDExLHNbNDVdKSxSPXUoUixELFMsQixFLDE2LHNbNDZdKSxTPWYoUyxCPXUoQixSLEQsUyxkLDIzLHNbNDddKSxSLEQsbyw2LHNbNDhdKSxEPWYoRCxTLEIsUix5LDEwLHNbNDldKSxSPWYoUixELFMsQixBLDE1LHNbNTBdKSxCPWYoQixSLEQsUyxnLDIxLHNbNTFdKSxTPWYoUyxCLFIsRCxrLDYsc1s1Ml0pLEQ9ZihELFMsQixSLF8sMTAsc1s1M10pLFI9ZihSLEQsUyxCLGIsMTUsc1s1NF0pLEI9ZihCLFIsRCxTLGMsMjEsc1s1NV0pLFM9ZihTLEIsUixELHcsNixzWzU2XSksRD1mKEQsUyxCLFIsRSwxMCxzWzU3XSksUj1mKFIsRCxTLEIsdiwxNSxzWzU4XSksQj1mKEIsUixELFMseiwyMSxzWzU5XSksUz1mKFMsQixSLEQscCw2LHNbNjBdKSxEPWYoRCxTLEIsUix4LDEwLHNbNjFdKSxSPWYoUixELFMsQixkLDE1LHNbNjJdKSxCPWYoQixSLEQsUyxtLDIxLHNbNjNdKSxpWzBdPWlbMF0rU3wwLGlbMV09aVsxXStCfDAsaVsyXT1pWzJdK1J8MCxpWzNdPWlbM10rRHwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEscj10LndvcmRzLG49OCp0aGlzLl9uRGF0YUJ5dGVzLGE9OCp0LnNpZ0J5dGVzO3JbYT4+PjVdfD0xMjg8PDI0LWElMzI7dmFyIGk9ZS5mbG9vcihuLzQyOTQ5NjcyOTYpLG89bjtyWzE1KyhhKzY0Pj4+OTw8NCldPTE2NzExOTM1JihpPDw4fGk+Pj4yNCl8NDI3ODI1NTM2MCYoaTw8MjR8aT4+PjgpLHJbMTQrKGErNjQ+Pj45PDw0KV09MTY3MTE5MzUmKG88PDh8bz4+PjI0KXw0Mjc4MjU1MzYwJihvPDwyNHxvPj4+OCksdC5zaWdCeXRlcz00KihyLmxlbmd0aCsxKSx0aGlzLl9wcm9jZXNzKCk7Zm9yKHZhciBzPXRoaXMuX2hhc2gsYz1zLndvcmRzLGg9MDtoPDQ7aCsrKXt2YXIgbD1jW2hdO2NbaF09MTY3MTE5MzUmKGw8PDh8bD4+PjI0KXw0Mjc4MjU1MzYwJihsPDwyNHxsPj4+OCl9cmV0dXJuIHN9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9aS5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0Ll9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSx0fX0pO2Z1bmN0aW9uIGgodCxlLHIsbixhLGksbyl7dmFyIHM9dCsoZSZyfH5lJm4pK2ErbztyZXR1cm4oczw8aXxzPj4+MzItaSkrZX1mdW5jdGlvbiBsKHQsZSxyLG4sYSxpLG8pe3ZhciBzPXQrKGUmbnxyJn5uKSthK287cmV0dXJuKHM8PGl8cz4+PjMyLWkpK2V9ZnVuY3Rpb24gdSh0LGUscixuLGEsaSxvKXt2YXIgcz10KyhlXnJebikrYStvO3JldHVybihzPDxpfHM+Pj4zMi1pKStlfWZ1bmN0aW9uIGYodCxlLHIsbixhLGksbyl7dmFyIHM9dCsocl4oZXx+bikpK2ErbztyZXR1cm4oczw8aXxzPj4+MzItaSkrZX1yLk1ENT1pLl9jcmVhdGVIZWxwZXIoYyksci5IbWFjTUQ1PWkuX2NyZWF0ZUhtYWNIZWxwZXIoYyl9KE1hdGgpLHQuTUQ1fShoLmV4cG9ydHMpfShmKTt2YXIgZD17ZXhwb3J0czp7fX0sXz17ZXhwb3J0czp7fX07IWZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBlPXQscj1lLmxpYixuPXIuV29yZEFycmF5LGE9ci5IYXNoZXIsaT1lLmFsZ28sbz1bXSxzPWkuU0hBMT1hLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBuLmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OCwzMjg1Mzc3NTIwXSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj10aGlzLl9oYXNoLndvcmRzLG49clswXSxhPXJbMV0saT1yWzJdLHM9clszXSxjPXJbNF0saD0wO2g8ODA7aCsrKXtpZihoPDE2KW9baF09MHx0W2UraF07ZWxzZXt2YXIgbD1vW2gtM11eb1toLThdXm9baC0xNF1eb1toLTE2XTtvW2hdPWw8PDF8bD4+PjMxfXZhciB1PShuPDw1fG4+Pj4yNykrYytvW2hdO3UrPWg8MjA/MTUxODUwMDI0OSsoYSZpfH5hJnMpOmg8NDA/MTg1OTc3NTM5MysoYV5pXnMpOmg8NjA/KGEmaXxhJnN8aSZzKS0xODk0MDA3NTg4OihhXmlecyktODk5NDk3NTE0LGM9cyxzPWksaT1hPDwzMHxhPj4+MixhPW4sbj11fXJbMF09clswXStufDAsclsxXT1yWzFdK2F8MCxyWzJdPXJbMl0raXwwLHJbM109clszXStzfDAscls0XT1yWzRdK2N8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9kYXRhLGU9dC53b3JkcyxyPTgqdGhpcy5fbkRhdGFCeXRlcyxuPTgqdC5zaWdCeXRlcztyZXR1cm4gZVtuPj4+NV18PTEyODw8MjQtbiUzMixlWzE0KyhuKzY0Pj4+OTw8NCldPU1hdGguZmxvb3Ioci80Mjk0OTY3Mjk2KSxlWzE1KyhuKzY0Pj4+OTw8NCldPXIsdC5zaWdCeXRlcz00KmUubGVuZ3RoLHRoaXMuX3Byb2Nlc3MoKSx0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWEuY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gdC5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksdH19KTtlLlNIQTE9YS5fY3JlYXRlSGVscGVyKHMpLGUuSG1hY1NIQTE9YS5fY3JlYXRlSG1hY0hlbHBlcihzKX0oKSx0LlNIQTF9KGguZXhwb3J0cyl9KF8pO3ZhciBwPXtleHBvcnRzOnt9fTshZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGUscixuO3I9KGU9dCkubGliLkJhc2Usbj1lLmVuYy5VdGY4LGUuYWxnby5ITUFDPXIuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQsZSl7dD10aGlzLl9oYXNoZXI9bmV3IHQuaW5pdCwic3RyaW5nIj09dHlwZW9mIGUmJihlPW4ucGFyc2UoZSkpO3ZhciByPXQuYmxvY2tTaXplLGE9NCpyO2Uuc2lnQnl0ZXM+YSYmKGU9dC5maW5hbGl6ZShlKSksZS5jbGFtcCgpO2Zvcih2YXIgaT10aGlzLl9vS2V5PWUuY2xvbmUoKSxvPXRoaXMuX2lLZXk9ZS5jbG9uZSgpLHM9aS53b3JkcyxjPW8ud29yZHMsaD0wO2g8cjtoKyspc1toXV49MTU0OTU1NjgyOCxjW2hdXj05MDk1MjI0ODY7aS5zaWdCeXRlcz1vLnNpZ0J5dGVzPWEsdGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2hhc2hlcjt0LnJlc2V0KCksdC51cGRhdGUodGhpcy5faUtleSl9LHVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faGFzaGVyLnVwZGF0ZSh0KSx0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9oYXNoZXIscj1lLmZpbmFsaXplKHQpO3JldHVybiBlLnJlc2V0KCksZS5maW5hbGl6ZSh0aGlzLl9vS2V5LmNsb25lKCkuY29uY2F0KHIpKX19KX0oaC5leHBvcnRzKX0ocCksZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9dCxyPWUubGliLG49ci5CYXNlLGE9ci5Xb3JkQXJyYXksaT1lLmFsZ28sbz1pLk1ENSxzPWkuRXZwS0RGPW4uZXh0ZW5kKHtjZmc6bi5leHRlbmQoe2tleVNpemU6NCxoYXNoZXI6byxpdGVyYXRpb25zOjF9KSxpbml0OmZ1bmN0aW9uKHQpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZCh0KX0sY29tcHV0ZTpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcixuPXRoaXMuY2ZnLGk9bi5oYXNoZXIuY3JlYXRlKCksbz1hLmNyZWF0ZSgpLHM9by53b3JkcyxjPW4ua2V5U2l6ZSxoPW4uaXRlcmF0aW9ucztzLmxlbmd0aDxjOyl7ciYmaS51cGRhdGUocikscj1pLnVwZGF0ZSh0KS5maW5hbGl6ZShlKSxpLnJlc2V0KCk7Zm9yKHZhciBsPTE7bDxoO2wrKylyPWkuZmluYWxpemUociksaS5yZXNldCgpO28uY29uY2F0KHIpfXJldHVybiBvLnNpZ0J5dGVzPTQqYyxvfX0pO2UuRXZwS0RGPWZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gcy5jcmVhdGUocikuY29tcHV0ZSh0LGUpfX0oKSx0LkV2cEtERn0oaC5leHBvcnRzKX0oZCk7dmFyIGc9e2V4cG9ydHM6e319OyFmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXt0LmxpYi5DaXBoZXJ8fGZ1bmN0aW9uKGUpe3ZhciByPXQsbj1yLmxpYixhPW4uQmFzZSxpPW4uV29yZEFycmF5LG89bi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtLHM9ci5lbmM7cy5VdGY4O3ZhciBjPXMuQmFzZTY0LGg9ci5hbGdvLkV2cEtERixsPW4uQ2lwaGVyPW8uZXh0ZW5kKHtjZmc6YS5leHRlbmQoKSxjcmVhdGVFbmNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fRU5DX1hGT1JNX01PREUsdCxlKX0sY3JlYXRlRGVjcnlwdG9yOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0RFQ19YRk9STV9NT0RFLHQsZSl9LGluaXQ6ZnVuY3Rpb24odCxlLHIpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChyKSx0aGlzLl94Zm9ybU1vZGU9dCx0aGlzLl9rZXk9ZSx0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7by5yZXNldC5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX0scHJvY2VzczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fYXBwZW5kKHQpLHRoaXMuX3Byb2Nlc3MoKX0sZmluYWxpemU6ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnRoaXMuX2FwcGVuZCh0KSx0aGlzLl9kb0ZpbmFsaXplKCl9LGtleVNpemU6NCxpdlNpemU6NCxfRU5DX1hGT1JNX01PREU6MSxfREVDX1hGT1JNX01PREU6MixfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/dzp2fXJldHVybiBmdW5jdGlvbihlKXtyZXR1cm57ZW5jcnlwdDpmdW5jdGlvbihyLG4sYSl7cmV0dXJuIHQobikuZW5jcnlwdChlLHIsbixhKX0sZGVjcnlwdDpmdW5jdGlvbihyLG4sYSl7cmV0dXJuIHQobikuZGVjcnlwdChlLHIsbixhKX19fX0oKX0pO24uU3RyZWFtQ2lwaGVyPWwuZXh0ZW5kKHtfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wcm9jZXNzKCEwKX0sYmxvY2tTaXplOjF9KTt2YXIgdT1yLm1vZGU9e30sZj1uLkJsb2NrQ2lwaGVyTW9kZT1hLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZSh0LGUpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKHQsZSl9LGluaXQ6ZnVuY3Rpb24odCxlKXt0aGlzLl9jaXBoZXI9dCx0aGlzLl9pdj1lfX0pLGQ9dS5DQkM9ZnVuY3Rpb24oKXt2YXIgdD1mLmV4dGVuZCgpO2Z1bmN0aW9uIHIodCxyLG4pe3ZhciBhLGk9dGhpcy5faXY7aT8oYT1pLHRoaXMuX2l2PWUpOmE9dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgbz0wO288bjtvKyspdFtyK29dXj1hW29dfXJldHVybiB0LkVuY3J5cHRvcj10LmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5fY2lwaGVyLGE9bi5ibG9ja1NpemU7ci5jYWxsKHRoaXMsdCxlLGEpLG4uZW5jcnlwdEJsb2NrKHQsZSksdGhpcy5fcHJldkJsb2NrPXQuc2xpY2UoZSxlK2EpfX0pLHQuRGVjcnlwdG9yPXQuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzLl9jaXBoZXIsYT1uLmJsb2NrU2l6ZSxpPXQuc2xpY2UoZSxlK2EpO24uZGVjcnlwdEJsb2NrKHQsZSksci5jYWxsKHRoaXMsdCxlLGEpLHRoaXMuX3ByZXZCbG9jaz1pfX0pLHR9KCksXz0oci5wYWQ9e30pLlBrY3M3PXtwYWQ6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9NCplLG49ci10LnNpZ0J5dGVzJXIsYT1uPDwyNHxuPDwxNnxuPDw4fG4sbz1bXSxzPTA7czxuO3MrPTQpby5wdXNoKGEpO3ZhciBjPWkuY3JlYXRlKG8sbik7dC5jb25jYXQoYyl9LHVucGFkOmZ1bmN0aW9uKHQpe3ZhciBlPTI1NSZ0LndvcmRzW3Quc2lnQnl0ZXMtMT4+PjJdO3Quc2lnQnl0ZXMtPWV9fTtuLkJsb2NrQ2lwaGVyPWwuZXh0ZW5kKHtjZmc6bC5jZmcuZXh0ZW5kKHttb2RlOmQscGFkZGluZzpffSkscmVzZXQ6ZnVuY3Rpb24oKXt2YXIgdDtsLnJlc2V0LmNhbGwodGhpcyk7dmFyIGU9dGhpcy5jZmcscj1lLml2LG49ZS5tb2RlO3RoaXMuX3hmb3JtTW9kZT09dGhpcy5fRU5DX1hGT1JNX01PREU/dD1uLmNyZWF0ZUVuY3J5cHRvcjoodD1uLmNyZWF0ZURlY3J5cHRvcix0aGlzLl9taW5CdWZmZXJTaXplPTEpLHRoaXMuX21vZGUmJnRoaXMuX21vZGUuX19jcmVhdG9yPT10P3RoaXMuX21vZGUuaW5pdCh0aGlzLHImJnIud29yZHMpOih0aGlzLl9tb2RlPXQuY2FsbChuLHRoaXMsciYmci53b3JkcyksdGhpcy5fbW9kZS5fX2NyZWF0b3I9dCl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX21vZGUucHJvY2Vzc0Jsb2NrKHQsZSl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLmNmZy5wYWRkaW5nO3JldHVybiB0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFPyhlLnBhZCh0aGlzLl9kYXRhLHRoaXMuYmxvY2tTaXplKSx0PXRoaXMuX3Byb2Nlc3MoITApKToodD10aGlzLl9wcm9jZXNzKCEwKSxlLnVucGFkKHQpKSx0fSxibG9ja1NpemU6NH0pO3ZhciBwPW4uQ2lwaGVyUGFyYW1zPWEuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQpe3RoaXMubWl4SW4odCl9LHRvU3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVybih0fHx0aGlzLmZvcm1hdHRlcikuc3RyaW5naWZ5KHRoaXMpfX0pLGc9KHIuZm9ybWF0PXt9KS5PcGVuU1NMPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dC5jaXBoZXJ0ZXh0LHI9dC5zYWx0O3JldHVybihyP2kuY3JlYXRlKFsxMzk4ODkzNjg0LDE3MDEwNzY4MzFdKS5jb25jYXQocikuY29uY2F0KGUpOmUpLnRvU3RyaW5nKGMpfSxwYXJzZTpmdW5jdGlvbih0KXt2YXIgZSxyPWMucGFyc2UodCksbj1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT1uWzBdJiYxNzAxMDc2ODMxPT1uWzFdJiYoZT1pLmNyZWF0ZShuLnNsaWNlKDIsNCkpLG4uc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLHAuY3JlYXRlKHtjaXBoZXJ0ZXh0OnIsc2FsdDplfSl9fSx2PW4uU2VyaWFsaXphYmxlQ2lwaGVyPWEuZXh0ZW5kKHtjZmc6YS5leHRlbmQoe2Zvcm1hdDpnfSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixuKXtuPXRoaXMuY2ZnLmV4dGVuZChuKTt2YXIgYT10LmNyZWF0ZUVuY3J5cHRvcihyLG4pLGk9YS5maW5hbGl6ZShlKSxvPWEuY2ZnO3JldHVybiBwLmNyZWF0ZSh7Y2lwaGVydGV4dDppLGtleTpyLGl2Om8uaXYsYWxnb3JpdGhtOnQsbW9kZTpvLm1vZGUscGFkZGluZzpvLnBhZGRpbmcsYmxvY2tTaXplOnQuYmxvY2tTaXplLGZvcm1hdHRlcjpuLmZvcm1hdH0pfSxkZWNyeXB0OmZ1bmN0aW9uKHQsZSxyLG4pe3JldHVybiBuPXRoaXMuY2ZnLmV4dGVuZChuKSxlPXRoaXMuX3BhcnNlKGUsbi5mb3JtYXQpLHQuY3JlYXRlRGVjcnlwdG9yKHIsbikuZmluYWxpemUoZS5jaXBoZXJ0ZXh0KX0sX3BhcnNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P2UucGFyc2UodCx0aGlzKTp0fX0pLHk9KHIua2RmPXt9KS5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKHQsZSxyLG4pe258fChuPWkucmFuZG9tKDgpKTt2YXIgYT1oLmNyZWF0ZSh7a2V5U2l6ZTplK3J9KS5jb21wdXRlKHQsbiksbz1pLmNyZWF0ZShhLndvcmRzLnNsaWNlKGUpLDQqcik7cmV0dXJuIGEuc2lnQnl0ZXM9NCplLHAuY3JlYXRlKHtrZXk6YSxpdjpvLHNhbHQ6bn0pfX0sdz1uLlBhc3N3b3JkQmFzZWRDaXBoZXI9di5leHRlbmQoe2NmZzp2LmNmZy5leHRlbmQoe2tkZjp5fSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixuKXt2YXIgYT0obj10aGlzLmNmZy5leHRlbmQobikpLmtkZi5leGVjdXRlKHIsdC5rZXlTaXplLHQuaXZTaXplKTtuLml2PWEuaXY7dmFyIGk9di5lbmNyeXB0LmNhbGwodGhpcyx0LGUsYS5rZXksbik7cmV0dXJuIGkubWl4SW4oYSksaX0sZGVjcnlwdDpmdW5jdGlvbih0LGUscixuKXtuPXRoaXMuY2ZnLmV4dGVuZChuKSxlPXRoaXMuX3BhcnNlKGUsbi5mb3JtYXQpO3ZhciBhPW4ua2RmLmV4ZWN1dGUocix0LmtleVNpemUsdC5pdlNpemUsZS5zYWx0KTtyZXR1cm4gbi5pdj1hLml2LHYuZGVjcnlwdC5jYWxsKHRoaXMsdCxlLGEua2V5LG4pfX0pfSgpfShoLmV4cG9ydHMpfShnKSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT10LHI9ZS5saWIuQmxvY2tDaXBoZXIsbj1lLmFsZ28sYT1bXSxpPVtdLG89W10scz1bXSxjPVtdLGg9W10sbD1bXSx1PVtdLGY9W10sZD1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sZT0wO2U8MjU2O2UrKyl0W2VdPWU8MTI4P2U8PDE6ZTw8MV4yODM7dmFyIHI9MCxuPTA7Zm9yKGU9MDtlPDI1NjtlKyspe3ZhciBfPW5ebjw8MV5uPDwyXm48PDNebjw8NDtfPV8+Pj44XjI1NSZfXjk5LGFbcl09XyxpW19dPXI7dmFyIHA9dFtyXSxnPXRbcF0sdj10W2ddLHk9MjU3KnRbX11eMTY4NDMwMDgqXztvW3JdPXk8PDI0fHk+Pj44LHNbcl09eTw8MTZ8eT4+PjE2LGNbcl09eTw8OHx5Pj4+MjQsaFtyXT15LHk9MTY4NDMwMDkqdl42NTUzNypnXjI1NypwXjE2ODQzMDA4KnIsbFtfXT15PDwyNHx5Pj4+OCx1W19dPXk8PDE2fHk+Pj4xNixmW19dPXk8PDh8eT4+PjI0LGRbX109eSxyPyhyPXBedFt0W3Rbdl5wXV1dLG5ePXRbdFtuXV0pOnI9bj0xfX0oKTt2YXIgXz1bMCwxLDIsNCw4LDE2LDMyLDY0LDEyOCwyNyw1NF0scD1uLkFFUz1yLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fblJvdW5kc3x8dGhpcy5fa2V5UHJpb3JSZXNldCE9PXRoaXMuX2tleSl7Zm9yKHZhciB0PXRoaXMuX2tleVByaW9yUmVzZXQ9dGhpcy5fa2V5LGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMvNCxuPTQqKCh0aGlzLl9uUm91bmRzPXIrNikrMSksaT10aGlzLl9rZXlTY2hlZHVsZT1bXSxvPTA7bzxuO28rKylvPHI/aVtvXT1lW29dOihoPWlbby0xXSxvJXI/cj42JiZvJXI9PTQmJihoPWFbaD4+PjI0XTw8MjR8YVtoPj4+MTYmMjU1XTw8MTZ8YVtoPj4+OCYyNTVdPDw4fGFbMjU1JmhdKTooaD1hWyhoPWg8PDh8aD4+PjI0KT4+PjI0XTw8MjR8YVtoPj4+MTYmMjU1XTw8MTZ8YVtoPj4+OCYyNTVdPDw4fGFbMjU1JmhdLGhePV9bby9yfDBdPDwyNCksaVtvXT1pW28tcl1eaCk7Zm9yKHZhciBzPXRoaXMuX2ludktleVNjaGVkdWxlPVtdLGM9MDtjPG47YysrKXtpZihvPW4tYyxjJTQpdmFyIGg9aVtvXTtlbHNlIGg9aVtvLTRdO3NbY109Yzw0fHxvPD00P2g6bFthW2g+Pj4yNF1dXnVbYVtoPj4+MTYmMjU1XV1eZlthW2g+Pj44JjI1NV1dXmRbYVsyNTUmaF1dfX19LGVuY3J5cHRCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX2RvQ3J5cHRCbG9jayh0LGUsdGhpcy5fa2V5U2NoZWR1bGUsbyxzLGMsaCxhKX0sZGVjcnlwdEJsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dFtlKzFdO3RbZSsxXT10W2UrM10sdFtlKzNdPXIsdGhpcy5fZG9DcnlwdEJsb2NrKHQsZSx0aGlzLl9pbnZLZXlTY2hlZHVsZSxsLHUsZixkLGkpLHI9dFtlKzFdLHRbZSsxXT10W2UrM10sdFtlKzNdPXJ9LF9kb0NyeXB0QmxvY2s6ZnVuY3Rpb24odCxlLHIsbixhLGksbyxzKXtmb3IodmFyIGM9dGhpcy5fblJvdW5kcyxoPXRbZV1eclswXSxsPXRbZSsxXV5yWzFdLHU9dFtlKzJdXnJbMl0sZj10W2UrM11eclszXSxkPTQsXz0xO188YztfKyspe3ZhciBwPW5baD4+PjI0XV5hW2w+Pj4xNiYyNTVdXmlbdT4+PjgmMjU1XV5vWzI1NSZmXV5yW2QrK10sZz1uW2w+Pj4yNF1eYVt1Pj4+MTYmMjU1XV5pW2Y+Pj44JjI1NV1eb1syNTUmaF1ecltkKytdLHY9blt1Pj4+MjRdXmFbZj4+PjE2JjI1NV1eaVtoPj4+OCYyNTVdXm9bMjU1JmxdXnJbZCsrXSx5PW5bZj4+PjI0XV5hW2g+Pj4xNiYyNTVdXmlbbD4+PjgmMjU1XV5vWzI1NSZ1XV5yW2QrK107aD1wLGw9Zyx1PXYsZj15fXA9KHNbaD4+PjI0XTw8MjR8c1tsPj4+MTYmMjU1XTw8MTZ8c1t1Pj4+OCYyNTVdPDw4fHNbMjU1JmZdKV5yW2QrK10sZz0oc1tsPj4+MjRdPDwyNHxzW3U+Pj4xNiYyNTVdPDwxNnxzW2Y+Pj44JjI1NV08PDh8c1syNTUmaF0pXnJbZCsrXSx2PShzW3U+Pj4yNF08PDI0fHNbZj4+PjE2JjI1NV08PDE2fHNbaD4+PjgmMjU1XTw8OHxzWzI1NSZsXSlecltkKytdLHk9KHNbZj4+PjI0XTw8MjR8c1toPj4+MTYmMjU1XTw8MTZ8c1tsPj4+OCYyNTVdPDw4fHNbMjU1JnVdKV5yW2QrK10sdFtlXT1wLHRbZSsxXT1nLHRbZSsyXT12LHRbZSszXT15fSxrZXlTaXplOjh9KTtlLkFFUz1yLl9jcmVhdGVIZWxwZXIocCl9KCksdC5BRVN9KGguZXhwb3J0cyl9KHUpO3ZhciB2PXUuZXhwb3J0cyx5PXtleHBvcnRzOnt9fTshZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciByPXQsbj1yLmxpYixhPW4uV29yZEFycmF5LGk9bi5IYXNoZXIsbz1yLmFsZ28scz1bXSxjPVtdOyFmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7Zm9yKHZhciByPWUuc3FydCh0KSxuPTI7bjw9cjtuKyspaWYoISh0JW4pKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIHIodCl7cmV0dXJuIDQyOTQ5NjcyOTYqKHQtKDB8dCkpfDB9Zm9yKHZhciBuPTIsYT0wO2E8NjQ7KXQobikmJihhPDgmJihzW2FdPXIoZS5wb3cobiwuNSkpKSxjW2FdPXIoZS5wb3cobiwxLzMpKSxhKyspLG4rK30oKTt2YXIgaD1bXSxsPW8uU0hBMjU2PWkuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGEuaW5pdChzLnNsaWNlKDApKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXRoaXMuX2hhc2gud29yZHMsbj1yWzBdLGE9clsxXSxpPXJbMl0sbz1yWzNdLHM9cls0XSxsPXJbNV0sdT1yWzZdLGY9cls3XSxkPTA7ZDw2NDtkKyspe2lmKGQ8MTYpaFtkXT0wfHRbZStkXTtlbHNle3ZhciBfPWhbZC0xNV0scD0oXzw8MjV8Xz4+PjcpXihfPDwxNHxfPj4+MTgpXl8+Pj4zLGc9aFtkLTJdLHY9KGc8PDE1fGc+Pj4xNyleKGc8PDEzfGc+Pj4xOSleZz4+PjEwO2hbZF09cCtoW2QtN10rditoW2QtMTZdfXZhciB5PW4mYV5uJmleYSZpLHc9KG48PDMwfG4+Pj4yKV4objw8MTl8bj4+PjEzKV4objw8MTB8bj4+PjIyKSxtPWYrKChzPDwyNnxzPj4+NileKHM8PDIxfHM+Pj4xMSleKHM8PDd8cz4+PjI1KSkrKHMmbF5+cyZ1KStjW2RdK2hbZF07Zj11LHU9bCxsPXMscz1vK218MCxvPWksaT1hLGE9bixuPW0rKHcreSl8MH1yWzBdPXJbMF0rbnwwLHJbMV09clsxXSthfDAsclsyXT1yWzJdK2l8MCxyWzNdPXJbM10rb3wwLHJbNF09cls0XStzfDAscls1XT1yWzVdK2x8MCxyWzZdPXJbNl0rdXwwLHJbN109cls3XStmfDB9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZGF0YSxyPXQud29yZHMsbj04KnRoaXMuX25EYXRhQnl0ZXMsYT04KnQuc2lnQnl0ZXM7cmV0dXJuIHJbYT4+PjVdfD0xMjg8PDI0LWElMzIsclsxNCsoYSs2ND4+Pjk8PDQpXT1lLmZsb29yKG4vNDI5NDk2NzI5NiksclsxNSsoYSs2ND4+Pjk8PDQpXT1uLHQuc2lnQnl0ZXM9NCpyLmxlbmd0aCx0aGlzLl9wcm9jZXNzKCksdGhpcy5faGFzaH0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdD1pLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIHQuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpLHR9fSk7ci5TSEEyNTY9aS5fY3JlYXRlSGVscGVyKGwpLHIuSG1hY1NIQTI1Nj1pLl9jcmVhdGVIbWFjSGVscGVyKGwpfShNYXRoKSx0LlNIQTI1Nn0oaC5leHBvcnRzKX0oeSk7dmFyIHc9eS5leHBvcnRzLG09e2V4cG9ydHM6e319OyFmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgQXJyYXlCdWZmZXIpe3ZhciBlPXQubGliLldvcmRBcnJheSxyPWUuaW5pdCxuPWUuaW5pdD1mdW5jdGlvbih0KXtpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJih0PW5ldyBVaW50OEFycmF5KHQpKSwodCBpbnN0YW5jZW9mIEludDhBcnJheXx8InVuZGVmaW5lZCIhPXR5cGVvZiBVaW50OENsYW1wZWRBcnJheSYmdCBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHx0IGluc3RhbmNlb2YgSW50MTZBcnJheXx8dCBpbnN0YW5jZW9mIFVpbnQxNkFycmF5fHx0IGluc3RhbmNlb2YgSW50MzJBcnJheXx8dCBpbnN0YW5jZW9mIFVpbnQzMkFycmF5fHx0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHx0IGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSYmKHQ9bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0LHQuYnl0ZUxlbmd0aCkpLHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KXtmb3IodmFyIGU9dC5ieXRlTGVuZ3RoLG49W10sYT0wO2E8ZTthKyspblthPj4+Ml18PXRbYV08PDI0LWElNCo4O3IuY2FsbCh0aGlzLG4sZSl9ZWxzZSByLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07bi5wcm90b3R5cGU9ZX19KCksdC5saWIuV29yZEFycmF5fShoLmV4cG9ydHMpfShtKTt2YXIgYj1tLmV4cG9ydHMseD17ZXhwb3J0czp7fX07IWZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiB0LkhtYWNTSEEyNTZ9KGguZXhwb3J0cyl9KHgpO3ZhciBrLHosQT14LmV4cG9ydHM7b25tZXNzYWdlPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZGF0YSxuPWUuam9iLGk9ZS5jbWQscz1lLnNlcnZlcixjPWUucGF0aCxoPWUuYnVmZmVyLHU9ZS5rZXlCYXNlNjQsZj1lLmd6aXAsZD1lLnJlZmVycmVyLF89ZS5pZCxwPWUuYXBwSWQsZz1lLnBlcnNpc3RlbnRJZCx5PWUuQ1JPUVVFVF9WRVJTSU9OLG09ZS5kZWJ1Zyx4PWUud2hhdDtpZigidXBsb2FkRW5jcnlwdGVkIj09PWkpTChjKTtlbHNlIGNvbnNvbGUuZXJyb3IoIlVua25vd24gd29ya2VyIGNvbW1hbmQiLGkpO2Z1bmN0aW9uIEUodCl7dmFyIGU9RGF0ZS5ub3coKSxyPWIuY3JlYXRlKHQpLG49bC5wYXJzZSh1KSxpPUEocixuKSxvPWIucmFuZG9tKDE2KSxzPXYuZW5jcnlwdChyLG4se2l2Om99KS5jaXBoZXJ0ZXh0LGM9bmV3IEFycmF5QnVmZmVyKDQrby5zaWdCeXRlcytpLnNpZ0J5dGVzK3Muc2lnQnl0ZXMpLGg9bmV3IERhdGFWaWV3KGMpLGY9MDtoLnNldFVpbnQzMihmLDExMjk0NjgyMDksITEpLGYrPTQ7Zm9yKHZhciBkPTAscD1bbyxpLHNdO2Q8cC5sZW5ndGg7ZCsrKXt2YXIgZyx5PWEocFtkXS53b3Jkcyk7dHJ5e2Zvcih5LnMoKTshKGc9eS5uKCkpLmRvbmU7KXt2YXIgdz1nLnZhbHVlO2guc2V0SW50MzIoZix3LCExKSxmKz00fX1jYXRjaCh0KXt5LmUodCl9ZmluYWxseXt5LmYoKX19cmV0dXJuIG0mJmNvbnNvbGUubG9nKCIiLmNvbmNhdChfLCIgIikuY29uY2F0KHgsIiBlbmNyeXB0ZWQgKCIpLmNvbmNhdChjLmJ5dGVMZW5ndGgsIiBieXRlcykgaW4gIikuY29uY2F0KERhdGUubm93KCktZSwibXMiKSksY31mdW5jdGlvbiBTKHQpe3ZhciBlPURhdGUubm93KCkscj1vLmV4cG9ydHMuZGVmbGF0ZSh0LHtnemlwOiEwLGxldmVsOjF9KTtyZXR1cm4gbSYmY29uc29sZS5sb2coIiIuY29uY2F0KF8sIiAiKS5jb25jYXQoeCwiIGNvbXByZXNzZWQgKCIpLmNvbmNhdChyLmxlbmd0aCwiIGJ5dGVzKSBpbiAiKS5jb25jYXQoRGF0ZS5ub3coKS1lLCJtcyIpKSxyfWZ1bmN0aW9uIEIodCl7dmFyIGU9RGF0ZS5ub3coKSxyPXcoYi5jcmVhdGUodCkpLG49bC5zdHJpbmdpZnkocikucmVwbGFjZSgvPS9nLCIiKS5yZXBsYWNlKC9cKy9nLCItIikucmVwbGFjZSgvXC8vZywiXyIpO3JldHVybiBtJiZjb25zb2xlLmxvZygiIi5jb25jYXQoXywiICIpLmNvbmNhdCh4LCIgaGFzaGVkICgiKS5jb25jYXQodC5sZW5ndGgsIiBieXRlcykgaW4gIikuY29uY2F0KERhdGUubm93KCktZSwibXMiKSksbn1mdW5jdGlvbiBSKHQpe3JldHVybiBELmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBEKCl7cmV0dXJuKEQ9cihyZWdlbmVyYXRvclJ1bnRpbWUubWFyaygoZnVuY3Rpb24gdChlKXt2YXIgcixuLGEsaSxvLGMsaCxsLHUsZjtyZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoKGZ1bmN0aW9uKHQpe2Zvcig7Oylzd2l0Y2godC5wcmV2PXQubmV4dCl7Y2FzZSAwOmlmKHI9RGF0ZS5ub3coKSxuPSIiLmNvbmNhdChzLnVybCwiLyIpLmNvbmNhdChlKSxzLmFwaUtleSl7dC5uZXh0PTQ7YnJlYWt9cmV0dXJuIHQuYWJydXB0KCJyZXR1cm4iLHt1cmw6bix1cGxvYWRVcmw6bn0pO2Nhc2UgNDpyZXR1cm4gdC5uZXh0PTYsayhuLHtoZWFkZXJzOnsiWC1Dcm9xdWV0LUF1dGgiOnMuYXBpS2V5LCJYLUNyb3F1ZXQtQXBwIjpwLCJYLUNyb3F1ZXQtSWQiOmcsIlgtQ3JvcXVldC1TZXNzaW9uIjpfLCJYLUNyb3F1ZXQtVmVyc2lvbiI6eSwiWC1Dcm9xdWV0LVBhdGgiOm5ldyBVUkwoZCkucGF0aG5hbWV9LHJlZmVycmVyOmR9KTtjYXNlIDY6aWYoYT10LnNlbnQsaT1hLm9rLG89YS5zdGF0dXMsYz1hLnN0YXR1c1RleHQsaSl7dC5uZXh0PTEwO2JyZWFrfXRocm93IEVycm9yKCJFcnJvciBpbiBzaWduaW5nIFVSTDogIi5jb25jYXQobywiIC0gIikuY29uY2F0KGMpKTtjYXNlIDEwOnJldHVybiB0Lm5leHQ9MTIsYS5qc29uKCk7Y2FzZSAxMjppZihoPXQuc2VudCxsPWguZXJyb3IsdT1oLnJlYWQsZj1oLndyaXRlLCFsKXt0Lm5leHQ9MTg7YnJlYWt9dGhyb3cgRXJyb3IobCk7Y2FzZSAxODpyZXR1cm4gbSYmY29uc29sZS5sb2coIiIuY29uY2F0KF8sIiAiKS5jb25jYXQoeCwiIGF1dGhvcml6ZWQgaW4gIikuY29uY2F0KERhdGUubm93KCktciwibXMiKSksdC5hYnJ1cHQoInJldHVybiIse3VybDp1LHVwbG9hZFVybDpmfSk7Y2FzZSAyMDpjYXNlImVuZCI6cmV0dXJuIHQuc3RvcCgpfX0pLHQpfSkpKSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIEwodCl7cmV0dXJuIFUuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIFUoKXtyZXR1cm4oVT1yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKChmdW5jdGlvbiB0KGUpe3ZhciByLGEsaSxvLHMsYyxsLHUsdjtyZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoKGZ1bmN0aW9uKHQpe2Zvcig7Oylzd2l0Y2godC5wcmV2PXQubmV4dCl7Y2FzZSAwOnJldHVybiB0LnByZXY9MCxyPUUoZj9TKGgpOmgpLGUuaW5jbHVkZXMoIiVIQVNIJSIpJiYoZT1lLnJlcGxhY2UoIiVIQVNIJSIsQihyKSkpLHQubmV4dD02LFIoZSk7Y2FzZSA2OnJldHVybiBhPXQuc2VudCxpPWEudXBsb2FkVXJsLG89YS51cmwscz1EYXRlLm5vdygpLHQubmV4dD0xMixrKGkse21ldGhvZDoiUFVUIixtb2RlOiJjb3JzIixoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtIiwiWC1Dcm9xdWV0LUFwcCI6cCwiWC1Dcm9xdWV0LUlkIjpnLCJYLUNyb3F1ZXQtU2Vzc2lvbiI6XywiWC1Dcm9xdWV0LVZlcnNpb24iOnl9LHJlZmVycmVyOmQsYm9keTpyfSk7Y2FzZSAxMjppZihjPXQuc2VudCxsPWMub2ssdT1jLnN0YXR1cyx2PWMuc3RhdHVzVGV4dCxsKXt0Lm5leHQ9MTg7YnJlYWt9dGhyb3cgRXJyb3IoInNlcnZlciByZXR1cm5lZCAiLmNvbmNhdCh1LCIgIikuY29uY2F0KHYsIiBmb3IgUFVUICIpLmNvbmNhdChpKSk7Y2FzZSAxODptJiZjb25zb2xlLmxvZygiIi5jb25jYXQoXywiICIpLmNvbmNhdCh4LCIgdXBsb2FkZWQgKCIpLmNvbmNhdCh1LCIpIGluICIpLmNvbmNhdChEYXRlLm5vdygpLXMsIm1zICIpLmNvbmNhdChvKSkseih7am9iOm4sdXJsOm8sb2s6bCxzdGF0dXM6dSxzdGF0dXNUZXh0OnZ9KSx0Lm5leHQ9MjY7YnJlYWs7Y2FzZSAyMjp0LnByZXY9MjIsdC50MD10LmNhdGNoKDApLG0mJmNvbnNvbGUubG9nKCIiLmNvbmNhdChfLCIgdXBsb2FkIGVycm9yICIpLmNvbmNhdCh0LnQwLm1lc3NhZ2UpKSx6KHtqb2I6bixvazohMSxzdGF0dXM6LTEsc3RhdHVzVGV4dDp0LnQwLm1lc3NhZ2V9KTtjYXNlIDI2OmNhc2UiZW5kIjpyZXR1cm4gdC5zdG9wKCl9fSksdCxudWxsLFtbMCwyMl1dKX0pKSkpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LGs9ZmV0Y2gsej1wb3N0TWVzc2FnZX0oKTsKCg==",null,!1),new Worker(_s,t)},Qs=(Us.onerror=function(t){return console.error("UploadWorker error: ".concat(t.message))},0),Ds=new Set;function vc(i){var r,t=W(Ds);try{for(t.s();!(r=t.n()).done;){var e=function(){var t,e=r.value;if(e.id===i)return{v:{appId:(t=e.sessionSpec).appId,persistentId:t.persistentId,uploadEncrypted:function(t){return e.uploadEncrypted(t)},downloadEncrypted:function(t){return e.downloadEncrypted(t)}}}}();if("object"===n(e))return e.v}}catch(i){t.e(i)}finally{t.f()}return{}}var Os=function(e){function r(){var t,e;o(this,r),t=M.dev||!1!==M.dev&&"localhost",e=M.dev||!1!==M.dev&&(Hs||zs),q={messages:M.has("debug","messages",!1),sends:M.has("debug","sends",!1),ticks:M.has("debug","ticks",!1),pong:M.has("debug","pong",!1),snapshot:M.has("debug","snapshot",!1),session:M.has("debug","session",!1),initsnapshot:M.has("debug","initsnapshot",t),reflector:M.has("debug","reflector",e)},this.reset()}var s,c,l,h,u,d,m,p,f,y,b,v,g,L;return a(r,[{key:"reset",value:function(){globalThis.CROQUETVM===this.vm&&delete globalThis.CROQUETVM,this.vm=null,this.session=null,this.connection=this.connection||new Bs(this),this.networkQueue=[],this.reflectorTime=0,this.msPerTick=this.msPerTick||0,this.tickMultiplier=this.tickMultiplier||1,this.extrapolatedTimeBase=Date.now(),this.key=this.key||null,this.tove=this.tove||null,this.viewId=this.viewId||Math.floor(Math.random()*Math.pow(36,10)).toString(36),this.timeline="",this.rejoinTimeout&&clearTimeout(this.rejoinTimeout),this.rejoinTimeout=0,this.sendBuffer=[],this.users=0,this.usersTotal=0,this.cpuTime=0,this.triggeringCpuTime=null,this.synced=null,this.latency=0,this.latencyHistory&&(this.latencyHistory=[]),this.localTicker&&(globalThis.clearInterval(this.localTicker),delete this.localTicker),this.syncTimer&&(globalThis.clearTimeout(this.syncTimer),delete this.syncTimer),this.tuttiHistory=[],this.lastAnimationEnd=0,this.animationGapCheck=[],this.rateLimitedSendTimes=[],this.rateLimitBuffer=[],this.rateLimitSoftWarned=!1,this.rateLimitBufferWarned=!1,this.rateLimitLastLogged=0,this.payloadSizeWarned=!1,j.removeAllSubscriptionsFor(this.viewId),j.addSubscription(this.viewId,"__peers__",this.viewId,function(t){return $e("users now ".concat(t.count))},"oncePerFrameWhileSynced"),this.leaving||E.showSyncWait(!0)}},{key:"id",get:function(){return(this.vm||this.sessionSpec).id}},{key:"persistentId",get:function(){return this.sessionSpec.persistentId}},{key:"versionId",get:function(){return this.sessionSpec.codeHash}},{key:"extrapolatedTime",get:function(){return Date.now()-this.extrapolatedTimeBase}},{key:"viewOnly",get:function(){return this.sessionSpec.viewOnly}},{key:"backlog",get:function(){return this.vm?this.reflectorTime-this.vm.time:0}},{key:"starvation",get:function(){return Date.now()-this.lastReceived}},{key:"lag",get:function(){return this.vm?Math.max(0,this.extrapolatedTime-this.vm.time-this.msPerTick):0}},{key:"activity",get:function(){return Date.now()-this.lastSent}},{key:"viewed",get:function(){return!(!this.session||!this.session.view)}},{key:"connected",get:function(){return this.connection.connected}},{key:"shouldLeaveWhenDisconnected",get:function(){return this.leaving||!this.canRejoinSeamlessly||0===this.sessionSpec.rejoinLimit}},{key:"canRejoinSeamlessly",get:function(){return!!this.timeline}},{key:"checkForConnection",value:function(t){this.connection.checkForConnection(t)}},{key:"dormantDisconnect",value:function(){this.connected&&this.connection.dormantDisconnect()}},{key:"initFromSessionSpec",value:(L=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a,c,l,h,u,d,m,p,f,y,b,v,g,Z,w,X,L,x;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.name,v=n.optionsFromUrl,X=n.password,i=n.appId,r=n.apiKey,f=n.viewIdDebugSuffix,s=i?"".concat(i,"/").concat(s):s,f&&(this.viewId=this.viewId.replace(/_.*$/,"")+"_"+encodeURIComponent((""+f).slice(0,16)).replace(/[^a-z0-9]/gi,function(t){return"_".concat("%"===t?"":t.charCodeAt(0).toString(16).toUpperCase())})),o=t({},n.options),v){a=W(v);try{for(a.s();!(c=a.n()).done;)(l=c.value)in M&&(o[l]=M[l])}catch(e){a.e(e)}finally{a.f()}}for(h={},u=0,d=["hashOverride"];u<d.length;u++)(m=d[u])in M?h[m]=M[m]:m in n&&(h[m]=n[m]);return this.key=Ii(X,"",{keySize:8}),e.next=10,function me(){return pe.apply(this,arguments)}(s,o);case 10:return p=e.sent,e.next=13,this.verifyApiKey(r,i,p);case 13:return f=e.sent,y=f.developerId,b=f.token,e.next=18,function be(){return ve.apply(this,arguments)}(p,y,h,Ns);case 18:return v=e.sent,g=v.id,Z=v.codeHash,w=v.computedCodeHash,e.next=24,this.encrypt(g);case 24:this.tove=e.sent,q.session&&console.log('Croquet session "'.concat(s,'":\n        sessionId=').concat(g).concat(i?"\n        persistentId=".concat(p):"","\n        versionId=").concat(Z===w?Z:"".concat(Z," (specified in hashOverride)\n        versionId=").concat(w," (computed)"),"\n        viewId=").concat(this.viewId)),this.eventRateLimit=n.eventRateLimit,this.eventHistoryLimit=this.eventRateLimit,this.eventMaxBundles=this.eventRateLimit,this.sessionSpec=t(t({},n),{},{options:o,name:s,id:g,persistentId:p,developerId:y,token:b,codeHash:Z,computedCodeHash:w}),X=this.getTickAndMultiplier(),L=X.msPerTick,x=X.multiplier,this.msPerTick=L,this.tickMultiplier=x,this.setUpActivityChecks();case 34:case"end":return e.stop()}},e,this)})),function(t){return L.apply(this,arguments)})},{key:"establishSession",value:(g=i(regeneratorRuntime.mark(function e(){var n,i,r,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.sessionSpec,n=i.id,r=i.persistentId,i=i.codeHash,this.sessionSpec.snapshot={id:n,time:0,meta:{id:n,persistentId:r,codeHash:i,created:(new Date).toISOString()}},r=new Promise(function(t){return s.sessionSpec.sessionJoined=t}),this.checkForConnection(!1),q.session&&console.log(n,"waiting for SYNC"),t.next=7,r;case 7:case"end":return t.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"verifyApiKey",value:(v=i(regeneratorRuntime.mark(function e(n,i,r){var s,o,a,c,l,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=uc(n),s=o.signServer,o=o.apiKey,"none"===s)return t.abrupt("return",{developerId:"unknown_dev_id"});t.next=3;break;case 3:return t.prev=3,t.next=6,fetch("".concat(s,"/join?meta=login"),{method:"GET",mode:"cors",headers:{"X-Croquet-Auth":o,"X-Croquet-App":i,"X-Croquet-Id":r,"X-Croquet-Version":Ns,"X-Croquet-Path":new URL(E.referrerURL()).pathname},referrer:E.referrerURL(),referrerPolicy:"no-referrer-when-downgrade"});case 6:return a=t.sent,t.next=9,a.json();case 9:if(a=t.sent,c=a.error,l=a.developerId,h=a.token,c)throw Error(c);t.next=15;break;case 15:return q.session&&console.log("Croquet: verified API key"),t.abrupt("return",{developerId:l,token:h});case 19:throw t.prev=19,t.t0=t.catch(3),Error('Croquet API key validation failed for "'.concat(n,'": ').concat(t.t0.message));case 22:case"end":return t.stop()}},e,null,[[3,19]])})),function(t,e,n){return v.apply(this,arguments)})},{key:"lastKnownTime",value:function(t){return Math.max(t.time,t.externalTime)}},{key:"takeSnapshot",value:function(){var e=this.vm.snapshot(),n=this.lastKnownTime(e),i=e.externalSeq;return e.meta=t(t({},this.sessionSpec.snapshot.meta),{},{options:this.sessionSpec.options,time:n,seq:i,date:(new globalThis.CroquetViewDate).toISOString(),host:Fs?"localhost":window.location.hostname,sdk:Ns}),delete e.meta.hash,e}},{key:"takeSnapshotHandleErrors",value:function(){var t,e,n;try{t=H.begin("snapshot"),n=this.takeSnapshot()}catch(t){return et("snapshot",t),null}finally{e=H.end("snapshot")-t}return q.snapshot&&console.log(this.id,"snapshot taken in ".concat(Math.ceil(e)," ms")),n}},{key:"scheduleSnapshot",value:function(){var t,e;this.connected&&this.vm&&!this.viewOnly&&((e=(t=this.vm.time)-this.vm.lastSnapshotPoll)<5e3?q.snapshot&&console.log("not requesting snapshot poll (".concat(e,"ms since poll scheduled)")):(e=new nt(t,0,"_","handlePollForSnapshot",[]),this.sendTagged(e,{debounce:5e3,msgID:"pollForSnapshot"}),q.snapshot&&console.log(this.id,"requesting snapshot poll via reflector")))}},{key:"handlePollForSnapshot",value:function(t){var e=this;if(!0!==this.synced||this.viewOnly)this.triggeringCpuTime=null;else{var n,i,r=this.triggeringCpuTime||this.cpuTime;this.triggeringCpuTime=null,this.cpuTime=0;try{n=H.begin("snapshot"),i={cpuTime:r,hash:this.vm.getSummaryHash(),viewId:this.viewId}}catch(t){return void et("snapshot",t)}finally{r=H.end("snapshot")-n,this.cpuTime-=r}q.snapshot&&console.log(this.id,"Summary hashing took ".concat(Math.ceil(r),"ms")),Promise.resolve().then(function(){return e.pollForSnapshot(t,i)})}}},{key:"pollForSnapshot",value:function(t,e){e.cpuTime+=Math.random(),q.snapshot&&console.log(this.id,"sending snapshot vote",e),this.sendTutti({time:t,topic:"snapshot",data:e,tallyTarget:["handleSnapshotVote"]})}},{key:"handleSnapshotVote",value:function(t){var e,n,i,r,s=this;!0===this.synced?(t=t.tally,q.snapshot&&console.log(this.id,"received snapshot votes",t),e=(t=this.analyzeTally(t,"cpuTime")).numberOfGroups,n=t.shouldUpload,i=t.dissidentFlag,1<e&&console.error(this.id,"Session diverged! Snapshots fall into ".concat(e," groups")),n&&(r=this.takeSnapshotHandleErrors())&&Promise.resolve().then(function(){return s.uploadSnapshot(r,i)})):q.snapshot&&console.log(this.id,"Ignoring snapshot vote during sync")}},{key:"analyzeTally",value:function(t,n){var e,i=this,r=!1,s=null,o=[],a={},c=null,t=(Object.keys(t).forEach(function(t,e){var t=JSON.parse(t),n=(o.push(t),t.hash);t.viewId===i.viewId&&(c=e),a[n]||(a[n]=[]),a[n].push(e)}),Object.keys(a)),l=t.length,h=0,t=(1<l&&(t.sort(function(t,e){return a[e].length-a[t].length}),a[t[0]].length===a[t[1]].length)&&(q.snapshot&&console.log(this.id,"Deciding consensus by tie-break"),t[1]<t[0])&&(h=1),t[h]);return null!==c&&(h=o[c].hash,1<(e=a[h]).length&&e.sort(function(t,e){return o[t][n]-o[e][n]}),e[0]===c)&&(r=!0,h!==t)&&(s={groupVotes:e.length,allVotes:o.length}),{numberOfGroups:l,shouldUpload:r,dissidentFlag:s}}},{key:"snapshotPath",value:function(t,e,n){var t=Math.ceil(t).toString().padStart(10,"0"),i=this.sessionSpec,r=i.appId,s=i.persistentId,o=i.codeHash;return i.apiKey?"apps/".concat(r,"/snap/").concat(o,"/").concat(s,".").concat(this.id,"/").concat(t,"_").concat(e,".").concat(n):"snapshots/".concat(this.id,"/").concat(t,"_").concat(e,"-").concat(n,".snap")}},{key:"hashSnapshot",value:function(i){return i.meta.hash||(i.meta.hashPromise||(i.meta.hashPromise=new Promise(function(e){var n=t({},i);delete n.meta,ue(JSON.stringify(n)).then(function(t){i.meta.hash=t,delete i.meta.hashPromise,e(t)})})),i.meta.hashPromise)}},{key:"uploadServer",value:function(t){if("string"==typeof M.files)return{url:e=(e=M.files).endsWith("/")?e.slice(0,-1):e,apiKey:null};var e=uc(t),t=e.apiKey,e=e.signServer;if("none"===e)throw Error("no file server configured");return{url:e,apiKey:t}}},{key:"uploadSnapshot",value:(b=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a,c,l,h=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=1<h.length&&void 0!==h[1]?h[1]:null,t.next=3,this.hashSnapshot(n);case 3:return a=H.begin("snapshot"),r=JSON.stringify(n),a=H.end("snapshot")-a,q.snapshot&&console.log(this.id,"snapshot stringified (".concat(r.length," bytes) in ").concat(Math.ceil(a),"ms")),a=n.meta,s=a.time,o=a.seq,a=a.hash,c=this.connection.socket,t.prev=9,t.next=12,this.uploadEncrypted({content:r,path:this.snapshotPath(s,o,a),key:this.key,gzip:!0,debug:q.snapshot,what:"snapshot"});case 12:if(l=t.sent,this.connection.socket!==c)return console.warn(this.id,"Controller was reset while trying to upload snapshot"),t.abrupt("return",!1);t.next=16;break;case 16:return this.announceSnapshotUrl(s,o,a,l,i),t.abrupt("return",!0);case 20:return t.prev=20,t.t0=t.catch(9),console.error(this.id,"Failed to upload snapshot"),t.abrupt("return",!1);case 24:case"end":return t.stop()}},e,this,[[9,20]])})),function(t){return b.apply(this,arguments)})},{key:"announceSnapshotUrl",value:function(t,e,n,i,r){var s;q.snapshot&&(s="time: ".concat(t,", seq: ").concat(e,", hash: ").concat(n),r&&(s+=", as dissident; "+JSON.stringify(r)),console.log(this.id,"sending snapshot url to reflector (".concat(s,"): ").concat(i)));try{this.connection.send(JSON.stringify({id:this.id,action:"SNAP",args:{time:t,seq:e,hash:n,url:i,dissident:r}}))}catch(t){console.error("ERROR while sending",t)}}},{key:"downloadEncrypted",value:(y=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a,c,l,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l=n.url,i=n.gzip,r=n.key,s=n.debug,o=n.json,a=n.what,l.startsWith("https://croquet.io/files/v1")&&(l=l.replace("https://croquet.io/files/v1","https://files.croquet.io")),c=Date.now(),t.next=5,fetch(l,{method:"GET",mode:"cors",headers:{"X-Croquet-App":this.sessionSpec.appId,"X-Croquet-Id":this.sessionSpec.persistentId,"X-Croquet-Session":this.sessionSpec.id,"X-Croquet-Version":Ns},referrer:E.referrerURL()});case 5:return l=t.sent,t.next=8,l.arrayBuffer();case 8:return h=t.sent,s&&console.log(this.id,"".concat(a," fetched (").concat(h.byteLength," bytes) in ").concat(-c+(c=Date.now()),"ms")),h=this.decryptBinary(h,r),s&&console.log(this.id,"".concat(a," decrypted (").concat(h.length," bytes) in ").concat(-c+(c=Date.now()),"ms")),h=i?Ps.inflate(h):h,s&&i&&console.log(this.id,"".concat(a," inflated (").concat(h.length," bytes) in ").concat(-c+(c=Date.now()),"ms")),t.abrupt("return",o?JSON.parse((new TextDecoder).decode(h)):h);case 15:case"end":return t.stop()}},e,this)})),function(t){return y.apply(this,arguments)})},{key:"uploadEncrypted",value:(f=i(regeneratorRuntime.mark(function e(i){var r,s,c,o,l,h,u,d,m,a,p,f,y,b,v=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.content,r=i.path,s=i.key,c=i.gzip,o=i.keep,l=i.debug,h=i.what,u="string"==typeof a?(new TextEncoder).encode(a).buffer:a,d=o?void 0:[u],m="string"==typeof s?s:Ki.stringify(s),a=this.sessionSpec,p=a.apiKey,f=a.appId,y=a.persistentId,b=++Qs,t.abrupt("return",new Promise(function(s,o){var t=Fs?"addListener":"addEventListener",a=Fs?"removeListener":"removeEventListener";Us.postMessage({job:b,cmd:"uploadEncrypted",server:v.uploadServer(p),path:r,buffer:u,keyBase64:m,gzip:c,referrer:E.referrerURL(),id:v.id,appId:f,persistentId:y,CROQUET_VERSION:Ns,debug:l,what:h},d);try{Us[t]("message",function n(t){var e,i,r;b===t.data.job&&(e=(t=t.data).url,i=t.ok,r=t.status,t=t.statusText,Us[a]("message",n),i?s(e):o(Error("".concat(r,": ").concat(t))))})}catch(s){console.log("failed to add listener",s)}}));case 7:case"end":return t.stop()}},e,this)})),function(t){return f.apply(this,arguments)})},{key:"persistentPath",value:function(t){var e=this.sessionSpec,n=e.appId,e=e.persistentId;return"apps/".concat(n,"/").concat(e,"/save/").concat(t)}},{key:"pollForPersist",value:function(t,e,n,i,r){if(this.synced){if(!this.sessionSpec.appId)throw Error("Persistence API requires appId");r={viewId:this.viewId,hash:i,ms:r+.001*Math.random()},i={persistTime:e,persistentHash:i,persistentString:n};q.snapshot&&console.log(this.id,"sending persistence vote for time @".concat(e),r),this.sendTutti({time:t,topic:"persist",data:r,localContext:i,tallyTarget:["handlePersistVote"]})}}},{key:"handlePersistVote",value:(p=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a,c,l,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.tally,i=n.localContext,q.snapshot&&(r=i?"for time @".concat(i.persistTime):"that we didn't participate in",console.log(this.id,"received persistence vote ".concat(r),a)),r=this.analyzeTally(a,"ms"),a=r.numberOfGroups,c=r.shouldUpload,s=r.dissidentFlag,1<a&&console.warn(this.id,"Persistence records fall into ".concat(a," groups")),c&&i){t.next=6;break}return t.abrupt("return");case 6:return o=i.persistTime,a=i.persistentHash,c=i.persistentString,t.next=9,this.uploadEncrypted({path:this.persistentPath(a),content:c,key:this.key,gzip:!0,debug:q.snapshot,what:"persistent data"});case 9:l=t.sent,q.snapshot&&(h=s?" (as dissident; ".concat(JSON.stringify(s),")"):"",console.log(this.id,"sending persistent data url to reflector".concat(h,": ").concat(l)));try{this.connection.send(JSON.stringify({id:this.id,action:"SAVE",args:{persistTime:o,url:l,dissident:s}}))}catch(t){console.error("ERROR while sending",t)}case 12:case"end":return t.stop()}},e,this)})),function(t){return p.apply(this,arguments)})},{key:"convertReflectorMessage",value:function(t){var e="noop",n=[];switch(t[2].what){case"users":var i=t[2],r=i.joined,s=i.left,o=i.active,i=i.total,i=(this.users=o,this.usersTotal=i,"__peers__"),r={entered:r||[],exited:s||[],count:o},e="publishFromModelOnly",n=["__VM__",i,r];j.handleEvent(this.viewId+":"+i,r);break;case"tally":var s=t[2],o=s.tuttiSeq,i=s.tuttiKey,r=s.tally,a=s.tallyTarget,s=s.missingClients;(q.messages||q.snapshot)&&s&&console.log("".concat(s," ").concat(1===s?"client":"clients"," failed to participate in tally ").concat(i||o)),e="handleTuttiResult",n=[{tuttiSeq:o,tuttiKey:i,tally:r,tallyTarget:a}]}var c=new nt(0,0,"_",e,n);t[2]=c.asState()[2]}},{key:"handleTuttiResult",value:function(t){var e=t.tuttiSeq,n=t.tuttiKey,i=t.tally,t=t.tallyTarget,r=this.tuttiHistory.findIndex(n?function(t){return t.tuttiKey===n}:function(t){return t.dummyTuttiSeq===e}),r=-1!==r&&this.tuttiHistory.splice(r,1)[0],s=null,o=null;r&&(s=r.payload,o=r.localContext),t&&(t=(r=X(t))[0],r=r.slice(1),r=[].concat(w(r),[{tally:i,localPayload:s,localContext:o}]),i=new nt(0,0,"_",t,r),this.vm.verifyExternal(i),i.executeOn(this.vm,!0))}},{key:"receive",value:(m=i(regeneratorRuntime.mark(function e(n,i){var r,s,o,a,c,l,h,u,d,m,p,f,y,b,v,g,X,L,x,k,G,S,T,C,M,R,Y,K,P,I,V=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=this.lastReceived,this.lastReceived=this.connection.lastReceived,t.t0=n,t.next="SYNC"===t.t0?5:"RECV"===t.t0?87:"TICK"===t.t0?111:"INFO"===t.t0?119:"REQU"===t.t0?122:125;break;case 5:if(this.syncReceived=!0,this.clearSyncReceiptTimeout(),Ds.add(this),s=i.messages,o=i.url,a=i.persisted,c=i.time,l=i.seq,h=i.snapshotSeq,y=i.tove,u=i.reflector,d=i.flags,y&&y!==this.tove){if(t.prev=10,this.decrypt(y)!==this.id)throw Error("wrong sessionId in tove?!");t.next=13}else t.next=19;break;case 13:t.next=19;break;case 15:return t.prev=15,t.t1=t.catch(10),this.connection.closeConnectionWithError("SYNC",Error("failed to decrypt session secret: ".concat(t.t1.message)),4200),t.abrupt("return");case 19:if(m=i.timeline||i.reflectorSession,this.flags=d||{},p=a?"persisted session":"snapshot",q.session&&console.log(this.id,"received SYNC from ".concat(u," reflector: time ").concat(c,", ").concat(s.length," messages, ").concat(p," ").concat(o||"<none>")),f=!!this.vm){if(this.networkQueue.length=0,y=!!m&&m===this.timeline,x=s[0],G=l,k=void 0!==h?h:x?x[1]:G,q.messages&&console.log(this.id,"rejoin: we have #".concat(this.vm.seq," SYNC has #").concat(k,"-#").concat(G)),b=y&&Dc(k,this.vm.seq)&&Dc(this.vm.seq,G)&&c>=this.reflectorTime){for(k=0,x&&Dc(x[1],this.vm.seq)&&(k=this.vm.seq-x[1]+1>>>0),v=k;b&&v<s.length;v++)"string"!=typeof(g=s[v][2])&&"users"===g.what&&g.left&&g.left.includes(this.viewId)&&(q.session&&console.log(this.id,"reflector reports that this view has left"),b=!1);b&&k&&(q.messages&&console.log(this.id,"rejoin: discarding ".concat(k," messages #").concat(x[1],"-#").concat(this.vm.seq)),s.splice(0,k))}if(b){if(0<this.sendBuffer.length){G=this.sendBuffer,this.sendBuffer=[],q.session&&console.log(this.id,"rejoin: sending ".concat(G.length," messages buffered while disconnected")),X=W(G);try{for(X.s();!(L=X.n()).done;)(0,L.value)()}catch(t){X.e(t)}finally{X.f()}}}else q.session&&console.log(this.id,"cannot rejoin seamlessly; rebooting model/view"),this.leave(!0),f=!1}x=this.networkQueue,this.networkQueue=[],k=W(s),t.prev=28,k.s();case 30:(G=k.n()).done?t.next=48:"string"==typeof(S=G.value)[2]?t.next=36:(this.convertReflectorMessage(S),t.next=44);break;case 36:t.prev=36,S[2]=this.decryptPayload(S[2])[0],t.next=44;break;case 40:return t.prev=40,t.t2=t.catch(36),this.connection.closeConnectionWithError("SYNC",Error("failed to decrypt message: ".concat(t.t2.message)),4200),t.abrupt("return");case 44:q.messages&&console.log(this.id,"received in SYNC "+JSON.stringify(S)),this.networkQueue.push(S);case 46:t.next=30;break;case 48:t.next=53;break;case 50:t.prev=50,t.t3=t.catch(28),k.e(t.t3);case 53:return t.prev=53,k.f(),t.finish(53);case 56:if((C=this.networkQueue).push.apply(C,w(x)),c>this.reflectorTime&&this.timeFromReflector(c,"reflector"),f)return q.session&&console.log(this.id,"seamless rejoin successful"),this.sessionSpec.sessionJoined(),t.abrupt("return");t.next=62;break;case 62:if(this.timeline=m||"",q.snapshot&&o&&console.log("".concat(this.id," fetching ").concat(p," ").concat(o)),o)return t.prev=65,t.next=68,this.downloadEncrypted({url:o,gzip:!0,key:this.key,debug:q.snapshot,json:!0,what:p});t.next=75;break;case 68:T=t.sent,t.next=75;break;case 71:return t.prev=71,t.t4=t.catch(65),this.connection.closeConnectionWithError("SYNC",Error("failed to fetch ".concat(p,": ").concat(t.t4.message)),4200),t.abrupt("return");case 75:if(this.connected){t.next=78;break}return console.log(this.id,"disconnected during SYNC"),t.abrupt("return");case 78:return a?this.install(T):(T&&(this.sessionSpec.snapshot=T),this.install()),q.session&&console.log("".concat(this.id," fast-forwarding from ").concat(Math.round(this.vm.time))),t.next=82,new Promise(function(e){V.fastForwardHandler=function(t){V.connected&&V.vm?"error"===t?e(!1):t&&V.viewId in V.vm.views&&e(!0):(console.log(V.id,"disconnected during SYNC fast-forwarding"),e(!1))},Promise.resolve().then(function(){return V.stepSession("fastForward",{budget:200})})});case 82:return C=t.sent,delete this.fastForwardHandler,C&&q.session&&console.log("".concat(this.id," fast-forwarded to ").concat(Math.round(this.vm.time))),C&&this.sessionSpec.sessionJoined(),t.abrupt("return");case 87:((M=i)[1]>>>=0,"string"==typeof M[2])?t.next=95:(q.messages&&console.log(this.id,"received META "+JSON.stringify(M)),this.convertReflectorMessage(M),q.messages&&console.log(this.id,"converted to "+JSON.stringify(M)),t.next=106);break;case 95:t.prev=95,P=this.decryptPayload(M[2]),P=Z(P,3),Y=P[0],K=P[1],P=P[2],M[2]=Y,K===this.viewId&&this.addToStatistics(P,this.lastReceived),q.messages&&console.log(this.id,"received "+JSON.stringify(M)),t.next=106;break;case 102:return t.prev=102,t.t5=t.catch(95),this.connection.closeConnectionWithError("RECV",Error("failed to decrypt message: ".concat(t.t5.message)),4200),t.abrupt("return");case 106:return this.networkQueue.push(M),this.flags.rawtime&&(R=M[M.length-1]),this.timeFromReflector(M[0],"reflector",R),this.simulateIfNeeded&&Promise.resolve().then(function(){return V.simulateIfNeeded()}),t.abrupt("return");case 111:if(this.vm){t.next=113;break}return t.abrupt("return");case 113:return Y="number"==typeof i?i:i.time,q.ticks&&(K=r&&this.lastReceived-r-this.msPerTick*this.tickMultiplier|0,console.log(this.id,"Controller received TICK ".concat(Y," ").concat(Math.abs(K)<5?"on time":K<0?"early":"late"," (").concat(K," ms)"))),this.timeFromReflector(Y,"reflector"),1<this.tickMultiplier&&this.multiplyTick(Y),this.simulateIfNeeded&&Promise.resolve().then(function(){return V.simulateIfNeeded()}),t.abrupt("return");case 119:return P=i.msg,I=i.options,E.showMessage(P,I),t.abrupt("return");case 122:return q.snapshot&&console.log("received REQU (snapshot request) from reflector"),this.cpuTime=12345,t.abrupt("return");case 125:console.warn("Unknown action:",n,i);case 126:case"end":return t.stop()}},e,this,[[10,15],[28,50,53,56],[36,40],[65,71],[95,102]])})),function(t,e){return m.apply(this,arguments)})},{key:"install",value:function(t){var e=Date.now(),n=this.sessionSpec,i=n.snapshot,r=n.initFn,s=n.options,n=Z(i.modelsById?["deserializ","snapshot"]:["initializ","root model"],2),o=n[0],n=n[1],a=(q.session&&console.log("".concat(this.id," ").concat(o,"ing ").concat(n)),new uo(i,function(){try{return r(s,t)}catch(t){throw et("init",t,"fatal"),t}}));if((q.session||q.snapshot&&i.modelsById)&&console.log("".concat(this.id," ").concat(n," ").concat(o,"ed in ").concat(Date.now()-e,"ms")),q.initsnapshot&&!i.modelsById){q.snapshot&&console.log("".concat(this.id," exercising snapshot and restore after init()"));n=null;try{n=JSON.stringify(a.snapshot())}catch(t){throw et("initial snapshot",t,"fatal"),t}try{a=new uo(JSON.parse(n),function(){return r(s)})}catch(t){throw et("initial snapshot resume",t,"fatal"),t}}o=this.lastKnownTime(a);this.reflectorTime=Math.max(this.reflectorTime,o),this.setVM(a)}},{key:"setVM",value:function(t){this.vm=t,this.vm.controller=this}},{key:"sendJoin",value:function(){var t=this,e=(this.syncReceived=!1,delete this.fastForwardHandler,this.rejoinTimeout&&(clearTimeout(this.rejoinTimeout),this.rejoinTimeout=0),q.session&&console.log(this.id,"Controller sending JOIN"),this.getTickAndMultiplier()),n=e.tick,e=e.delay,i=this.sessionSpec,r=i.name,s=i.codeHash,o=i.appId,a=i.apiKey,c=i.persistentId,l=i.developerId,h=i.heraldUrl,u=i.rejoinLimit,d=i.autoSleep,m=i.computedCodeHash,i=i.flags,r={name:r,apiKey:uc(a).apiKey,appId:o,persistentId:c,url:E.referrerURL(),sdk:Ns,developerId:l,version:1,user:this.viewId,ticks:{tick:n,delay:e},dormantDelay:d,tove:this.tove,codeHash:s};h&&Object.assign(r,{heraldUrl:h}),u&&Object.assign(r,{leaveDelay:u+250}),m!==s&&Object.assign(r,{computedCodeHash:m}),i&&Object.assign(r,{flags:i}),this.connection.send(JSON.stringify({id:this.id,action:"JOIN",args:r})),this.syncReceiptTimeout=setTimeout(function(){delete t.syncReceiptTimeout,t.syncReceived||t.connection.closeConnectionWithError("join",Error("SYNC not received in time"))},5e3)}},{key:"clearSyncReceiptTimeout",value:function(){this.syncReceiptTimeout&&(clearTimeout(this.syncReceiptTimeout),delete this.syncReceiptTimeout)}},{key:"connectionInterrupted",value:function(){var t=this;this.syncReceived&&(this.shouldLeaveWhenDisconnected?this.leave():this.rejoinTimeout||(this.rejoinTimeout=setTimeout(function(){q.session&&console.log(t.id,"rejoin timed out"),t.rejoinTimeout=0,t.leave()},this.sessionSpec.rejoinLimit)))}},{key:"leave",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.sessionSpec.rebootModelView;if(this.reset(),q.session&&console.log(this.id,"resetting ".concat(t?"(but keeping)":"and discarding"," controller")),t||Ds.delete(this),!this.sessionSpec)throw Error("do not discard sessionSpec!");e()}},{key:"encrypt",value:(d=i(regeneratorRuntime.mark(function e(n){var i,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=St.random(16),i=Vi.encrypt(n,this.key,{iv:s}),r=_i(n,this.key),s="".concat(Ki.stringify(s)).concat(Ki.stringify(r)).concat(i),t.abrupt("return",s);case 5:case"end":return t.stop()}},e,this)})),function(t){return d.apply(this,arguments)})},{key:"deprecatedDefaultKey",get:function(){return Es=Es||Ii("THIS SHOULDN'T BE IN LOGS","",{keySize:8})}},{key:"decrypt",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.key,n=Ki.parse(t.slice(0,24)),i=Ki.parse(t.slice(24,68)),r=t.slice(68),r=Vi.decrypt(r,e,{iv:n}),n="";try{n=Pi.stringify(r)}catch(t){}r=_i(n,this.key);if(this.compareHmacs(i.words,r.words))return n;if(e!==this.deprecatedDefaultKey)return this.decrypt(t,this.deprecatedDefaultKey);throw Error("Decryption error")}},{key:"decryptBinary",value:function(t,e){var n,i,r,s,o,a=(new TextDecoder).decode(new Uint8Array(t,0,4));switch("string"==typeof e&&(e=Ki.parse(e)),a){case"CRQ0":n=(new TextDecoder).decode(t),i=Ki.parse(n.slice(4,28)),r=Ki.parse(n.slice(28,72)),s=n.slice(72),o=Vi.decrypt(s,e,{iv:i});break;case"CRQ1":n=new Uint8Array(t),i=St.create(n.subarray(4,20)),r=St.create(n.subarray(20,52)),s=St.create(n.subarray(52)),o=Vi.decrypt({ciphertext:s},e,{iv:i});break;default:throw Error("".concat(this.id," unknown encryption version ").concat(a))}o.clamp();var c=_i(o,e);if(this.compareHmacs(r.words,c.words))return ne(o);if(e!==this.deprecatedDefaultKey)return this.decryptBinary(t,this.deprecatedDefaultKey);throw Error("Decryption error")}},{key:"encryptMessage",value:(u=i(regeneratorRuntime.mark(function e(n,i,r){var s,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.asState(),a=Z(a,3),s=a[0],o=a[1],a=a[2],t.next=3,this.encryptPayload([a,i,r]);case 3:return a=t.sent,t.abrupt("return",[s,o,a]);case 5:case"end":return t.stop()}},e,this)})),function(t,e,n){return u.apply(this,arguments)})},{key:"encryptPayload",value:(h=i(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.encrypt(JSON.stringify(n)));case 1:case"end":return t.stop()}},e,this)})),function(t){return h.apply(this,arguments)})},{key:"decryptPayload",value:function(t){return JSON.parse(this.decrypt(t))}},{key:"compareHmacs",value:function(t,e){for(var n=t.length===e.length,i=0;i<t.length;i++)t[i]!==e[i]&&(n=!1);return n}},{key:"sendMessage",value:function(t){var e,n,i,r,s=this;!this.viewOnly&&this.vm&&(16384<(e=t.asState()[2].length)?console.warn("".concat(this.id," Message with payload of ").concat(e," bytes exceeds maximum ").concat(16384," and will not be sent to reflector.")):(!this.payloadSizeWarned&&4096<e&&(console.log("".concat(this.id," Message with payload of ").concat(e," bytes being sent to reflector. Maximum recommended is ").concat(4096,".")),this.payloadSizeWarned=!0),n=Date.now(),r=this.rateLimitedSendTimes,i=this.rateLimitBuffer,H.perSecondTally({requestedMessages:1}),i.length?this.addToRateLimitBuffer(t):(i=0,(i=r.length&&this.synced&&(r=r[r.length-1],1<(r=1e3/this.eventRateLimit-(n-r)))?Math.ceil(r):i)?(this.addToRateLimitBuffer(t),setTimeout(function(){return s.serviceRateLimitBuffer()},i)):(this.recordRateLimitedSend(n),this.socketSendMessage(t),H.perSecondTally({sentSingleMessages:1,sentMessagesTotal:1,sentPayloadTotal:e})))))}},{key:"recordRateLimitedSend",value:function(t){var e=this.rateLimitedSendTimes;!this.synced&&e.length&&e[e.length-1]===t||(e.push(t),e.length>this.eventHistoryLimit&&e.shift()),!this.rateLimitSoftWarned&&e.length===this.eventHistoryLimit&&t-e[0]<1010&&(console.warn("".concat(this.id," Sends to reflector are at or above recommended limit of ").concat(this.eventHistoryLimit," within one second. Events will be bundled as necessary to keep to the limit.")),this.rateLimitSoftWarned=!0)}},{key:"addToRateLimitBuffer",value:function(t){H.perSecondTally({bundledMessages:1});var e=Date.now(),t=t.asState(),n=t[2].length,i=this.rateLimitBuffer;if(i.length){var r=i[i.length-1],s=r.msgStates;if(r.totalPayload<4096)return s.push({msgState:t,bufferTime:e}),void(r.totalPayload+=n)}H.perSecondTally({newBundles:1}),i.push({msgStates:[{msgState:t,bufferTime:e}],totalPayload:n});s=i.length;q.session&&s%5==0&&s!==this.rateLimitLastLogged&&(console.log("".concat(this.id," SEND rate-limit buffer grew to ").concat(s," event bundles (max ").concat(this.eventMaxBundles,")")),this.rateLimitLastLogged=s),s>this.eventMaxBundles?(console.error("".concat(this.id," Disconnecting after overflow of SEND rate-limit buffer.")),this.connection.closeConnectionWithError("SEND",Error("Send rate exceeded"),4200)):!this.rateLimitBufferWarned&&s>this.eventMaxBundles/2&&(console.warn("".concat(this.id," SEND rate-limit buffer is 50% full. If send rate does not drop, the app will be disconnected.")),this.rateLimitBufferWarned=!0)}},{key:"serviceRateLimitBuffer",value:function(){var t=this;if(this.connected){var e=this.rateLimitBuffer;if(e.length){var n=Date.now(),i=1e3/this.eventRateLimit,r=this.rateLimitedSendTimes;if(r.length){r=r[r.length-1];if(0<i-(n-r))return}var s,r=e.shift(),o=r.msgStates,r=r.totalPayload,a=[],c=0;o.forEach(function(t){a.push(t.msgState),c+=n-t.bufferTime}),1===a.length?(s=nt.fromState(a[0],this.vm),this.socketSendMessage(s)):(s=new nt(this.vm.time,0,"_","handleBundledEvents",[a]),this.socketSendMessage(s)),this.recordRateLimitedSend(n),H.perSecondTally({sentBundles:1,sentMessagesTotal:o.length,sendDelay:c,sentBundlePayload:r,sentPayloadTotal:r}),q.session&&this.connected&&(s=e.length)&&s%5==0&&s!==this.rateLimitLastLogged&&(console.log("".concat(this.id," SEND rate-limit buffer dropped to ").concat(s," event bundles")),this.rateLimitLastLogged=s),e.length&&setTimeout(function(){return t.serviceRateLimitBuffer()},i)}}}},{key:"socketSendMessage",value:(l=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a=this,c=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=1<c.length&&void 0!==c[1]?c[1]:null,t.next=3,this.encryptMessage(n,this.viewId,Date.now());case 3:if(r=t.sent,s=i?"tagged SEND ".concat(n.asState()," with tags ").concat(JSON.stringify(i)):"SEND ".concat(n.asState()),this.connected){t.next=8;break}return this.vm&&(q.sends&&console.log(this.id,"buffering ".concat(s)),this.sendBuffer.push(function(){return a.socketSendMessage(n,i)})),t.abrupt("return");case 8:q.sends&&console.log(this.id,"sending ".concat(s)),o={id:this.id,action:"SEND",args:[].concat(w(r),[this.latency])},i&&(o.tags=i),this.lastSent=Date.now(),this.connection.send(JSON.stringify(o));case 13:case"end":return t.stop()}},e,this)})),function(t){return l.apply(this,arguments)})},{key:"sendTagged",value:(c=i(regeneratorRuntime.mark(function e(n,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.viewOnly)return t.abrupt("return");t.next=2;break;case 2:this.socketSendMessage(n,i);case 3:case"end":return t.stop()}},e,this)})),function(t,e){return c.apply(this,arguments)})},{key:"sendTutti",value:(s=i(regeneratorRuntime.mark(function e(n){var i,r,s,o,a,c,l,h,u,d,m=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.time,r=n.topic,s=n.data,d=n.localContext,o=void 0===d?null:d,d=n.firstMessage,a=void 0===d?null:d,d=n.wantsVote,c=void 0===d||d,d=n.tallyTarget,l=void 0===d?null:d,this.viewOnly)return t.abrupt("return");t.next=3;break;case 3:if(t.t0=a,t.t0)return t.next=7,this.encryptMessage(a,this.viewId,Date.now());t.next=8;break;case 7:t.t0=t.sent;case 8:if(h=t.t0,u=kt(s),this.connected){t.next=13;break}return this.vm&&(q.sends&&console.log(this.id,'buffering "'.concat(r,'" TUTTI ').concat(u," ").concat(a&&a.asState())),this.sendBuffer.push(function(){return m.sendTutti({time:i,topic:r,data:s,localContext:o,firstMessage:a,wantsVote:c,tallyTarget:l})})),t.abrupt("return");case 13:q.sends&&console.log(this.id,'sending "'.concat(r,'" TUTTI ').concat(u," ").concat(a&&a.asState())),this.lastSent=Date.now(),d="".concat(r,"@").concat(i),this.connection.send(JSON.stringify({id:this.id,action:"TUTTI",args:[i,0,u,h,c,l,d]})),100<this.tuttiHistory.length&&this.tuttiHistory.shift(),this.tuttiHistory.push({time:i,tuttiKey:d,dummyTuttiSeq:0,payload:u,localContext:o});case 20:case"end":return t.stop()}},e,this)})),function(t){return s.apply(this,arguments)})},{key:"sendLog",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.connected?(q.sends&&console.log(this.id,"sending LOG"),n.length<2&&(n=n[0]),this.connection.send(JSON.stringify({action:"LOG",args:n}))):this.vm&&(q.sends&&console.log(this.id,"buffering LOG"),this.sendBuffer.push(function(){return t.sendLog.apply(t,w(n))}))}},{key:"addToStatistics",value:function(t,e){this.latency=e-t,this.latencyHistory&&(100<=this.latencyHistory.length&&this.latencyHistory.shift(),this.latencyHistory.push({time:e,ms:this.latency}))}},{key:"latencies",get:function(){return this.latencyHistory||(this.latencyHistory=[]),this.latencyHistory}},{key:"getTickAndMultiplier",value:function(){var t=this.sessionSpec.options,t=Z(((["number","string"].includes(n(t.tps))?t.tps:["number","string"].includes(n(this.sessionSpec.tps))?this.sessionSpec.tps:20)+"x").split("x").map(function(t){return Number.parseFloat("0"+t)}),2),e=t[0],t=t[1],e=1e3/Math.max(1/30,Math.min(60,e)),t=Math.max(1,t),i=e,r=0;return 1<t&&!js&&(i=e/t,r=Math.ceil(i*(t-1))),{msPerTick:i,multiplier:t,tick:e,delay:r}}},{key:"simulate",value:function(t){var e=this;if(!this.vm)return!0;try{var n=!0;if(this.networkQueue.length+this.vm.messages.size===0)n=this.vm.advanceTo(this.reflectorTime,t);else{for(var i=H.begin("simulate");n;){var r=this.networkQueue[0];if(!r)break;if(!(n=this.vm.advanceTo(r[0],t)))break;this.networkQueue.shift();var s=this.vm.scheduleExternalMessage(r),n=this.vm.advanceTo(s.time,t);this.cpuTime+=5}n=n&&this.vm.advanceTo(this.reflectorTime,t),this.cpuTime+=Math.max(.01,H.end("simulate")-i)}H.backlog(this.backlog);var o=this.lag,a=Math.max(200,.1*this.msPerTick),c=Math.max(2e3,.2*this.msPerTick);return"boolean"==typeof this.synced&&this.viewed&&(this.synced&&c<o||!this.synced&&o<a)&&(this.synced?this.applySyncChange(!1):this.syncTimer||(this.syncTimer=setTimeout(function(){delete e.syncTimer,e.connected&&e.lag<a&&e.applySyncChange(!0)},200))),this.synced&&n&&5e3<this.cpuTime&&(this.triggeringCpuTime=this.cpuTime,this.cpuTime=0,this.isBeingAnimated()?setTimeout(function(){return e.scheduleSnapshot()},Math.floor(2e3*Math.random())):this.scheduleSnapshot()),n}catch(t){return et("simulate",t),this.connection.closeConnectionWithError("simulate",t),"error"}}},{key:"stepSession",value:function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=H.stepSession(n.frameTime,!0),i=(i&&console.log(i),this.backlog),r=this.latency,s=this.starvation,o=this.activity;if("animation"===t&&(H.animationFrame(n.frameTime,{backlog:i,starvation:s,latency:r,activity:o,users:this.users}),i=Date.now(),this.lastAnimationEnd&&(s=i-this.lastAnimationEnd,!0===this.animationGapCheck&&200<s&&(this.animationGapCheck=[],q.session)&&console.log("".concat(this.id," animation has stopped (too long between steps)")),!0!==this.animationGapCheck)&&((r=this.animationGapCheck).push(s),4<r.length&&r.shift(),4===r.length)&&r.reduce(function(t,e){return t+e},0)<=400&&(this.animationGapCheck=!0,q.session)&&console.log("".concat(this.id," animation has started")),this.lastAnimationEnd=i),this.connected){if(this.vm){switch(t){case"animation":var a=n.expectedSimFPS,c=Date.now(),l=Js.reduce(function(t,e){return t+e},0)/Js.length;"error"!==(e=!1===(e=this.simulate(c+Math.min(l,200)))&&this.backlog>(0===a?0:1e3/a*4)?this.simulate(c+200-l):e)&&(Js.push(Date.now()-c),4<Js.length)&&Js.shift();break;case"fastForward":case"background":e=this.simulate(Date.now()+n.budget);break;default:console.warn(t)}this.fastForwardHandler&&this.fastForwardHandler(e),"error"!==e&&(H.begin("update"),this.processModelViewEvents("animation"===t),H.end("update"),this.serviceRateLimitBuffer(),"animation"===t)&&(n.view&&(H.begin("render"),this.inViewRealm(function(){return n.view.update(n.frameTime)}),H.end("render")),this.lastAnimationEnd=Date.now())}}else this.isInBackground()||this.checkForConnection(!0)}},{key:"applySyncChange",value:function(t){q.session&&console.log(this.id,"synced=".concat(t)),this.synced=t,E.showSyncWait(!t),this.vm.publishFromView(this.viewId,"synced",t)}},{key:"inViewRealm",value:function(t){var e=this;return xt(this.vm,function(){return t(e.vm)})}},{key:"processModelViewEvents",value:function(t){return this.vm?this.vm.processModelViewEvents(t):0}},{key:"timeFromReflector",value:function(t,e,n){t<this.reflectorTime?"controller"===e&&!q.ticks||console.warn("time is ".concat(this.reflectorTime,", ignoring time ").concat(t," from ").concat(e)):("boolean"!=typeof this.synced&&(this.synced=!1),this.reflectorTime=t,this.extrapolatedTimeBase=Date.now()-t,this.vm&&H.backlog(this.backlog),this.tickHook&&this.tickHook(t,n))}},{key:"multiplyTick",value:function(t){var e=this,n=(this.localTicker&&globalThis.clearInterval(this.localTicker),this.msPerTick),i=this.tickMultiplier,r=1;this.localTicker=globalThis.setInterval(function(){e.timeFromReflector(Math.round(t+r*n),"controller"),q.ticks&&console.log(e.id,"Controller generate TICK "+e.reflectorTime,r),++r>=i&&(globalThis.clearInterval(e.localTicker),e.localTicker=0)},n)}},{key:"startStepping",value:function(e){var i=this;window.requestAnimationFrame(function n(t){i.leaving||(i.isOutOfSight()||e(t),window.requestAnimationFrame(n))})}},{key:"setUpActivityChecks",value:function(){var n=this,i=null;this.isOutOfSight=function(){return!(Fs||"hidden"!==document.visibilityState&&i)},this.isBeingAnimated=function(){var t=!0===n.animationGapCheck,e=Date.now()-n.lastAnimationEnd<200;return t&&!e&&(n.animationGapCheck=[],q.session)&&console.log("".concat(n.id," animation has stopped (too long since last step)")),t&&e},this.isInBackground=function(){return n.isOutOfSight()||!n.isBeingAnimated()},Fs||new IntersectionObserver(function(t,e){return i=t[0].isIntersecting}).observe(document.body);function TZ(){n.leaving?a&&(clearInterval(a),a=null):n.connected&&n.vm&&(t&&t(),n.isBeingAnimated()||n.connection.keepAlive(Date.now()))}var e,r,s,t,o=this.sessionSpec.autoSleep,a=(o&&(e=1e3*o,s=r=0,t=function(){var t=Date.now();t-r<980||(r=t,n.isOutOfSight()?s?e<t-s&&(n.dormantDisconnect(),s=0):s=t:s=0)}),setInterval(TZ,1e3));this.simulateIfNeeded=function(){var t,e;!n.isBeingAnimated()&&(TZ(),n.connected)&&(t=.9*n.msPerTick,o&&(t=Math.min(t,200)),e=n.synced?"background":"fastForward",n.stepSession(e,{budget:t}))}}},{key:"toString",value:function(){return"Controller[".concat(this.id,"]")}},{key:e,value:function(){return this.toString()}}]),r}(Symbol.toPrimitive),Bs=function(){function e(t){o(this,e),this.controller=t,this.socketLastSent=0,this.connectBlocked=!1,this.connectRestricted=!1,this.connectHasBeenCalled=!1,this.reconnectDelay=0,this.missingTickThreshold=1/0}return a(e,[{key:"id",get:function(){return this.controller.id}},{key:"setTick",value:function(t){this.missingTickThreshold=Math.min(3*t,45e3)}},{key:"connected",get:function(){return!(!this.socket||this.socket.readyState!==WebSocket.OPEN)}},{key:"checkForConnection",value:function(t){this.socket||this.connectHasBeenCalled||this.connectBlocked||this.connectRestricted&&!t||this.connectToReflector()}},{key:"connectToReflector",value:function(){var n=this;if(!this.socket&&!this.connectHasBeenCalled){this.connectHasBeenCalled=!0,this.connectBlocked=!1,this.connectRestricted=!1;var t=uc(this.controller.sessionSpec.apiKey).reflector,e={},i=this.controller.sessionSpec.token;if(i&&(e.token=i),M.reflector&&("CF"===(i=M.reflector.toUpperCase())||i.match(/^[A-Z]{3}$/)?(t=q.reflector?"wss://croquet.network/reflector/dev/":"wss://croquet.network/reflector/",3===i.length&&(e.colo=i)):M.reflector.match(/^[-a-z0-9]+$/i)?e.region=M.reflector:t=M.reflector),!t.match(/^wss?:/))throw Error("Cannot interpret reflector address "+t);t.endsWith("/")||(t+="/");for(var r=new URL(t+this.id),s=0,o=Object.entries(e);s<o.length;s++){var a=Z(o[s],2),c=a[0],a=a[1];r.searchParams.append(c,a)}var l=new WebSocket(r);l.onopen=function(t){var e=n.socket;e&&(e.onopen=e.onmessage=e.onerror=e.onclose=null),n.socket=l,n.connectHasBeenCalled=!1,q.session&&console.log(n.id,n.socket.constructor.name,"connected to",n.socket.url),n.reconnectDelay=0,H.connected(!0),n.controller.sendJoin()},l.onmessage=function(t){l===n.socket&&n.receive(t.data)},l.onerror=function(t){q.session&&console.log(n.id,l.constructor.name,"connection error"),n.connectHasBeenCalled=!1,n.controller.clearSyncReceiptTimeout()},l.onclose=function(t){n.socketClosed(t.code,t.reason)}}}},{key:"socketClosed",value:function(t,e){var n=this,i=(this.controller.clearSyncReceiptTimeout(),1e3!==t&&t<4100),r=4110===t;r||1e3===t||this.reconnectDelay||setTimeout(function(){n.connected||E.showMessage("Connection closed: ".concat(t," ").concat(e),{level:i?"error":"fatal"})},500),q.session&&console.log(this.id,"".concat(this.socket?this.socket.constructor.name+" closed":"closed before opening,"," with code: ").concat(t," ").concat(e)),H.connected(!1),r?this.connectRestricted=!0:this.connectBlocked=!0,this.disconnected(),i&&(q.session&&console.log(this.id,"reconnecting in ".concat(this.reconnectDelay," ms")),this.reconnectTimeout=globalThis.setTimeout(function(){delete n.reconnectTimeout,n.connectToReflector()},this.reconnectDelay),this.reconnectDelay=Math.min(3e4,Math.round((this.reconnectDelay+100)*(1+Math.random()))))}},{key:"disconnected",value:function(){this.socket&&(this.socket=null,this.lastReceived=0,this.socketLastSent=0,this.stalledSince=0,this.connectHasBeenCalled=!1,this.controller.connectionInterrupted())}},{key:"send",value:function(t){this.socketLastSent=Date.now(),this.socket.send(t)}},{key:"receive",value:function(t){this.lastReceived=Date.now();var e=JSON.parse(t),n=e.id,i=e.action,e=e.args;if(n)try{this.controller.receive(i,e)}catch(t){this.closeConnectionWithError("receive",t)}else if("PONG"===i){if(q.pong&&console.log("PONG after",Date.now()-e,"ms"),this.pongHook)try{this.pongHook(e)}catch(t){console.error(t)}}else console.warn("Unknown action",i)}},{key:"dormantDisconnect",value:function(){this.connected&&(q.session&&console.log(this.id,"dormant; disconnecting from reflector"),this.closeConnection(4110,"Going dormant"))}},{key:"closeConnectionWithError",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4e3;console.error(e),console.warn("closing socket"),4100<=n&&4110!==n&&(this.controller.leaving=function(){}),this.closeConnection(n,"Error in "+t)}},{key:"closeConnection",value:function(t,e){this.socket&&(this.socket.onclose=null,this.socket.close(t,e),this.socketClosed(t,e))}},{key:"PULSE",value:function(t){this.connected&&(0===this.socket.bufferedAmount?(this.send(JSON.stringify({action:"PULSE"})),this.stalledSince=0):this.stalledSince&&500<t-this.stalledSince?console.log("".concat(this.id," Reflector connection stalled: ").concat(this.socket.bufferedAmount," bytes unsent for ").concat(t-this.stalledSince," ms")):this.stalledSince=Date.now())}},{key:"keepAlive",value:function(t){0!==this.lastReceived&&(25e3<t-this.socketLastSent?this.PULSE(t):5e4<t-this.lastReceived?this.closeConnectionWithError("connection",Error("Reflector has gone away")):t-this.lastReceived>this.missingTickThreshold&&this.PULSE(t))}},{key:"PING",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Date.now();this.connected&&this.send(JSON.stringify({action:"PING",args:t}))}}]),e}(),As=(globalThis.setInterval(function(){var t,e=W(Ds);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.connected&&n.vm&&n.connection.keepAlive(Date.now())}}catch(t){e.e(t)}finally{e.f()}},100),Symbol("hash")),qs=Symbol("key"),$s=Symbol("url"),to=new Map;function kc(t){return M.has("debug",t,!1)}function Wc(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Cc(t){return t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+3&-4,"=")}function Tc(e,t){return t.replace(/[\s\S]/g,function(t){return String.fromCharCode(t.charCodeAt(0)^e.charCodeAt(0))})}var eo=function(){function e(t,n,i){o(this,e);var r=to.get(t);if(r)return kc("data")&&console.log("Croquet.Data: using cached handle for ".concat(t)),r;if(i.slice(-43)!==t)throw Error("Croquet Data: malformed URL");Object.defineProperty(this,As,{value:t}),Object.defineProperty(this,qs,{value:n}),Object.defineProperty(this,$s,{value:i}),to.set(t,this),kc("data")&&console.log("Croquet.Data: created new handle for ".concat(t))}var r,s;return a(e,null,[{key:"store",value:(s=i(regeneratorRuntime.mark(function t(i,r){var s,o,a,c,l,h=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=2<h.length&&void 0!==h[2]&&h[2],"object"===n(i)&&(console.warn("Deprecated: Croquet.Data.store(sessionId, data) called without sessionId"),r=i),uo.hasCurrent())throw Error("Croquet.Data.store() called from Model code");t.next=4;break;case 4:return l=vc(i),a=l.appId,c=l.persistentId,l=l.uploadEncrypted,o=St.random(32).toString(Ki),a="apps/".concat(a,"/").concat(c,"/data/%HASH%"),t.next=9,l({path:a,content:r,key:o,keep:s,debug:kc("data"),what:"shared data"});case 9:return c=t.sent,l=function Sc(t){return t.replace(/.*\//,"")}(c),t.abrupt("return",new e(l,o,c));case 12:case"end":return t.stop()}},t)})),function(t,e){return s.apply(this,arguments)})},{key:"fetch",value:(r=i(regeneratorRuntime.mark(function e(i,r){var s,o,a,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("object"===n(i)&&(console.warn("Deprecated: Croquet.Data.fetch(sessionId, handle) called without sessionId"),r=i),uo.hasCurrent())throw Error("Croquet.Data.fetch() called from Model code");t.next=3;break;case 3:if(s=vc(i),s=s.downloadEncrypted,o=r&&r[As],a=r&&r[qs],c=r&&r[$s],"string"!=typeof o||"string"!=typeof a||"string"!=typeof c)throw Error("Croquet.Data.fetch() called with invalid handle");t.next=9;break;case 9:return t.abrupt("return",s({url:c,key:a,debug:kc("data"),what:"shared data"}));case 10:case"end":return t.stop()}},e)})),function(t,e){return r.apply(this,arguments)})},{key:"hash",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"base64url",n=("string"==typeof(t="function"==typeof t?Function.prototype.toString.call(t):t)?t=(new TextEncoder).encode(t):t&&t.constructor===DataView?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t&&t.constructor===ArrayBuffer?t=new Uint8Array(t):ArrayBuffer.isView(t)||(t=(new TextEncoder).encode(kt(t))),Wt(St.create(t)));switch(e){case"hex":return n.toString();case"base64":return n.toString(Ki);case"base64url":return Wc(n.toString(Ki));default:throw Error('Croquet.Data: unknown hash output "'.concat(e,'", expected "hex"/"base64"/"base64url"'))}}},{key:"fromId",value:function(t){var e,n,i,r,s=t.slice(0,1);switch(s){case"0":e=t.slice(1,44),n=t.slice(44),i="".concat("https://files.croquet.io","/sessiondata/").concat(e);break;case"1":e=t.slice(1,44),n=t.slice(44,87)+"=",r=t.slice(87),i="".concat("https://files.croquet.io","/apps/").concat(r,"/data/").concat(e);break;case"2":e=t.slice(1,44),r=Tc(n=Cc(t.slice(44,87)),atob(Cc(t.slice(87)))),i="".concat("https://files.croquet.io","/apps/").concat(r,"/data/").concat(e);break;case"3":e=(i=Tc(n=Cc(t.slice(1,44)),atob(Cc(t.slice(44))))).slice(-43);break;default:throw Error("Croquet.Data expected handle v0-v".concat("3"," got v").concat(s))}return new this(e,n,i)}},{key:"toId",value:function(t){if(!t)return"";var e=t[As],n=t[qs],t=t[$s];if(t.slice(-43)!==e)throw Error("Croquet Data: malformed URL");e=Wc(n),n=Wc(btoa(Tc(n,t)));return"".concat("3").concat(e).concat(n)}}]),e}(),no={cls:eo,write:function(t){return eo.toId(t)},read:function(t){return eo.fromId(t)}},$=null,io=null,ro=function(){l(n,m(Error));var t=b(n);function n(){return o(this,n),t.apply(this,arguments)}return a(n)}();function Ic(){if(!globalThis.CroquetViewMath){globalThis.CroquetMath.random=function(){return $.random()},globalThis.CroquetViewMath=t({},Math);for(var r=0,s=Object.entries(globalThis.CroquetMath);r<s.length;r++)!function(){var t=Z(s[r],2),e=t[0],n=t[1],i=Math[e];Math[e]=1===n.length?function(t){return($?n:i)(t)}:function(t,e){return($?n:i)(t,e)}}()}var h,n,u,i;globalThis.CroquetViewDate||(h=function(t,e){return i||(i=!0,console.warn(new ro("".concat(t," used in Model code")))),e},n=function e(t,n,i,r,s,o,a){var c=this instanceof e,l=[t,n,i,r,s,o,a];if(l.length=arguments.length,$)switch(h(c?"new Date()":"Date()"),arguments.length){case 0:l.push($.time);break;case 1:break;default:l[0]=u.UTC.apply(u,l),l.length=1}t=f(u,l);return c?t:""+t},u=globalThis.Date,i=!1,n.prototype=u.prototype,n.UTC=u.UTC,n.now=function(){return $?h("Date.now()",$.time):u.now()},n.parse=function(){return $?h("Date.parse()",0):u.parse.apply(u,arguments)},globalThis.CroquetViewDate=u,globalThis.Date=n)}Object.defineProperty(ro.prototype,"name",{value:"CroquetWarning"});var so={};function Nc(t,e){var t=JSON.parse(atob(t.slice(1,-1))),n=t.qPara,i=t.qArgs,t=t.qFn,r=JSON.stringify(n),r=so[r]||(so[r]=f(Function,w(n)));return"number"==typeof t&&(i[t]=r),r.call.apply(r,[e].concat(w(i))).bind(e)}function Hc(t,e){if($)throw Error("VirtualMachine confusion");if(!(t instanceof uo))throw Error("not a VM: "+t);var n=$;try{$=t,globalThis.CROQUETVM=t,e()}finally{$=n}}for(var oo=["handleModelEventInModel","handleBundledEvents","publishFromModelOnly","handlePollForSnapshot","handleTuttiResult","handleTuttiDivergence","handleSnapshotVote","handlePersistVote","handleModelEventInView","noop"],ao={},co=0;co<oo.length;co++)ao[oo[co]]=co;var lo=new WeakMap;function jc(t){lo.set(t,null)}var ho=function(){function e(){o(this,e)}return a(e,[{key:"random",value:function(){throw Error("Math.random() cannot be used in Model.evaluate()")}}]),e}(),uo=function(){function t(c,l){var h=this;o(this,t),Ic(),io={snapshot:M.has("debug","snapshot",!1),session:M.has("debug","session",!1)},jc(this),Hc(this,function(){Lt(h,function(){if(h.modelsById={},h.modelsByName={},h.messages=new Yi(function(t,e){return t.before(e)}),h.subscriptions={},h.views={},h._random=function(){throw Error("You must not use random when applying state!")},h.id=c.id,h.time=0,h.seq=4294967280,h.externalTime=0,h.externalSeq=h.seq,h.futureSeq=0,h.lastSnapshotPoll=0,h.lastPersistencePoll=0,h.inPersistenceCoolOff=!1,h.persisted="",h.modelsId=0,h.controller=null,c.modelsById){for(var t=vo.newOrRecycled(h).readVM(c,"_"),e=[],n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];r in h||"meta"===r?"messages"===r?e=t.messages:h[r]=t[r]:console.warn("Ignoring property snapshot.".concat(r))}var s,o=W(e);try{for(o.s();!(s=o.n()).done;){var a=s.value;h.messages.add(a.convertIfNeeded(h))}}catch(t){o.e(t)}finally{o.f()}}else h._random=new Zt(c.id,{state:!0}),l(h),h.addSubscription(h,"__VM__","__peers__",h.generateJoinExit)})})}return a(t,[{key:"registerModel",value:function(t,e){if($!==this)throw Error("You can only create models from model code!");return e=e||"M"+ ++this.modelsId,this.modelsById[e]=t,e}},{key:"deregisterModel",value:function(e){if($!==this)throw Error("You can only destroy models from model code!");var t=this.modelsById;delete this.modelsById[e];for(var n=0,i=Object.entries(this.modelsByName);n<i.length;n++){var r=Z(i[n],2),s=r[0];t===r[1]&&delete this.modelsByName[s]}this.messages.removeMany(function(t){return t.hasReceiver(e)})}},{key:"lookUpModel",value:function(t){var e;return"_"===t?this:this.modelsById[t]||((t=Z(t.match(/^([^#]+)#(.*)$/),3))[0],e=t[1],t=t[2],this.modelsById[e].lookUp(t))}},{key:"get",value:function(t){return this.modelsByName[t]}},{key:"set",value:function(t,e){if($!==this)throw Error("You can only make a model well-known from model code!");this.modelsByName[t]=e}},{key:"noop",value:function(){}},{key:"generateJoinExit",value:function(t){var e=t.entered,n=t.exited,i=t.count;if(e.length===i){var r,s=W(n=Object.keys(this.views));try{for(s.s();!(r=s.n()).done;){var o=r.value;this.views[o].extraConnections=0}}catch(t){s.e(t)}finally{s.f()}}if(0!==e.length&&0!==n.length){var a=e.filter(function(t){return n.includes(t)});if(0!==a.length&&(e=e.filter(function(t){return!a.includes(t)}),n=n.filter(function(t){return!a.includes(t)}),0===e.length)&&0===n.length)return}var c,l=W(n);try{for(l.s();!(c=l.n()).done;){var h=c.value;this.views[h]?this.views[h].extraConnections?(this.views[h].extraConnections--,io.session&&console.log("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(h," closed extra connection"))):(delete this.views[h],this.publishFromModelOnly(this.id,"view-exit",h)):(console.error("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(h," exited without being present - this should not happen")),this.controller.sendLog("view-exit-mismatch @".concat(this.time,"#").concat(this.seq," ").concat(h," left without being present")))}}catch(t){l.e(t)}finally{l.f()}var u,d=W(e);try{for(d.s();!(u=d.n()).done;){var m=u.value;this.views[m]?(io.session&&console.log("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(m," opened another connection")),this.views[m].extraConnections=(this.views[m].extraConnections||0)+1):(this.views[m]={},this.publishFromModelOnly(this.id,"view-join",m))}}catch(t){d.e(t)}finally{d.f()}e=Object.values(this.views).reduce(function(t,e){return t+1+(e.extraConnections||0)},0);i!==e&&(console.error("@".concat(this.time,"#").concat(this.seq," view count mismatch (model: ").concat(e,", reflector: ").concat(i,") - this should not happen")),this.controller.sendLog("view-exit-mismatch @".concat(this.time,"#").concat(this.seq," connections model: ").concat(e," reflector: ").concat(i)))}},{key:"scheduleExternalMessage",value:function(t){var e=nt.fromState(t,this);if(e.time<this.time)throw Error("past message from reflector "+t);t=this.externalSeq+1>>>0;if(e.seq!==t)throw Error("External message error. Expected message #".concat(t," got #").concat(e.seq));return this.externalTime=e.time,this.externalSeq=e.seq,e.seq=2*e.seq+1,this.verifyExternal(e),this.messages.add(e),e}},{key:"verifyExternal",value:function(t){if("_"!==t.receiver)throw Error("invalid receiver in external message: ".concat(t));if(!(t.selector in ao))throw Error("unexpected external message: ".concat(t.selector))}},{key:"futureSend",value:function(t,e,n,i){if(t.every)return this.futureRepeat(t.every,e,n,i);if(t<0)throw Error("attempt to send future message into the past");this.futureSeq=this.futureSeq+1>>>0;t=new nt(this.time+t,2*this.futureSeq,e,n,i);return this.messages.add(t),t}},{key:"futureRepeat",value:function(t,e,n,i){this.futureSend(t,this.id,"futureExecAndRepeat",[t,e,n,i])}},{key:"futureExecAndRepeat",value:function(t,e,n,i){var r=this.lookUpModel(e);if("function"==typeof r[n])try{r[n].apply(r,w(i))}catch(t){et("future message ".concat(r,".").concat(n),t)}else{var s=Nc(n,r);try{s.apply(void 0,w(i))}catch(t){et("future message ".concat(r," ").concat(s),t)}}this.futureRepeat(t,e,n,i)}},{key:"future",value:function(r,s,t,e){var o,t=this.asQFunc(r,t);return"string"==typeof t?this.futureSend(s,r.id,t,e):(o=this,new Proxy(r,{get:function(t,i){if("function"==typeof r[i])return function(){if(o.lookUpModel(r.id)!==r)throw Error("future send to unregistered model");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.futureSend(s,r.id,i,e)};throw Error("Tried to call "+i+"() on future of "+Object.getPrototypeOf(r).constructor.name+" which is not a function")}}))}},{key:"advanceTo",value:function(t,e){if($)throw Error("cannot advance time from model code");for(var n,i=0;(n=this.messages.peek())&&n.time<=t;){var r=n,s=r.time,r=r.seq;if(s<this.time)throw Error("past message encountered: "+n);if(1&r&&(this.seq=this.seq+1>>>0,r/2>>>0!==this.seq))throw Error("Sequence error: expected ".concat(this.seq," got ").concat(r/2>>>0," in ").concat(n));if(this.messages.poll(),this.time=n.time,n.executeOn(this),100<++i&&(i=0,Date.now()>e))return!1}return this.time=t,!0}},{key:"asQFunc",value:function(t,e){if("string"==typeof e)return e;if("function"==typeof e){if(t[e.name]===e)return e.name;for(var n=t;null!==n;){for(var i=0,r=Object.entries(Object.getOwnPropertyDescriptors(n));i<r.length;i++){var s=Z(r[i],2),o=s[0];if(s[1].value===e)return o}n=Object.getPrototypeOf(n)}qe("subscription handler is not a method of ".concat(t,": ").concat(e,"\n"),{only:"once"});t=e.toString().match(/^\(?([a-z][a-z0-9]*)?\)? *=> *this\.([a-z][a-z0-9]*) *\( *([a-z][a-z0-9]*)? *\) *$/i);return!t||t[3]&&t[3]!==t[1]?("function"==typeof(a=e)&&(c=a,a={}),l=Object.keys(a).concat(["return "+c]),a=Object.values(a),h={qPara:l,qArgs:a},0<=(c=a.indexOf(c))&&(a[c]=l[c],h.qFn=c),"{".concat(btoa(JSON.stringify(h)),"}")):t[2]}var a,c,l,h;return null}},{key:"addSubscription",value:function(t,e,n,i){if($!==this)throw Error("Cannot add a model subscription from outside model code");i=this.asQFunc(t,i);if("string"!=typeof i)throw Error('Subscription handler for "'.concat(n,'" must be a method name'));if(i.indexOf(".")<0&&"function"!=typeof t[i]&&"{"!==i[0])throw Error('Subscriber method for "'.concat(n,'" not found: ').concat(t,".").concat(i,"()"));var e=e+":"+n,r=(t===this?"_":t.id)+"."+i;if(this.subscriptions[e]){if(-1!==this.subscriptions[e].indexOf(r))throw Error("".concat(t,".").concat(i," already subscribed to ").concat(n))}else this.subscriptions[e]=[];this.subscriptions[e].push(r)}},{key:"removeSubscription",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"*";if($!==this)throw Error("Cannot remove a model subscription from outside model code");var t=t+":"+n,r=this.subscriptions[t];if(r)if("*"===i){var s=r.filter(function(t){return Z(t.split("."),1)[0]!==e.id});0===s.length?delete this.subscriptions[t]:this.subscriptions[t]=s}else{s=this.asQFunc(e,i);if("string"!=typeof s)throw Error('Invalid unsubscribe args for "'.concat(n,'" in ').concat(e,": ").concat(i));n=e.id+"."+s,i=r.indexOf(n);-1!==i&&(r.splice(i,1),0===r.length)&&delete this.subscriptions[t]}}},{key:"removeAllSubscriptionsFor",value:function(t){for(var e="".concat(t.id,":"),n="".concat(t.id,"."),i=0,r=Object.entries(this.subscriptions);i<r.length;i++){var s=Z(r[i],2),o=s[0],a=s[1];if(o.startsWith(e))delete this.subscriptions[o];else{for(var c=a.length-1;0<=c;c--)a[c].startsWith(n)&&a.splice(c,1);0===a.size&&delete this.subscriptions[o]}}}},{key:"publishFromModel",value:function(t,e,n){if($!==this)throw Error("Cannot publish a model event from outside model code");var i=e.endsWith("#reflected"),t=t+":"+(e=i?e.slice(0,e.length-"#reflected".length):e);this.handleModelEventInModel(t,n,i),this.handleModelEventInView(t,n)}},{key:"publishFromModelOnly",value:function(t,e,n){if($!==this)throw Error("Cannot publish a model event from outside model code");this.handleModelEventInModel(t+":"+e,n)}},{key:"publishFromView",value:function(t,e,n){if($)throw Error("Cannot publish a view event from model code");t=t+":"+e;this.handleViewEventInModel(t,n),this.handleViewEventInView(t,n)}},{key:"handleBundledEvents",value:function(t){var e,n=W(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=nt.fromState(i,this);this.verifyExternal(r),r.executeOn(this,!0)}}catch(t){n.e(t)}finally{n.f()}}},{key:"handleModelEventInModel",value:function(t,e){var n,i,r,s,o,a,c=this,l=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if($!==this)throw Error("handleModelEventInModel called from outside model code");if(l)!0===this.controller.synced&&(i=!!j.subscriptions[l=t+"#__vote"],r=!!this.subscriptions[t],s=!!this.subscriptions[n=t+"#divergence"],i&&s&&console.log("divergence subscription for ".concat(t," overridden by vote subscription")),o=r?new nt(this.time,0,"_","handleModelEventInModel",[t,e]):null,a=i?["handleModelEventInView",l]:["handleTuttiDivergence",n],Promise.resolve().then(function(){return c.controller.sendTutti({time:c.time,topic:t,data:e,firstMessage:o,wantsVote:i,tallyTarget:a})}));else if(this.subscriptions[t]){var h,u=W(this.subscriptions[t]);try{for(u.s();!(h=u.n()).done;){var d=X(h.value.split(".")),m=d[0],p=d.slice(1).join("."),f=this.lookUpModel(m);if(f)if("{"!==p[0])if(0<=p.indexOf(".")){var y=p.indexOf("."),b=p.slice(0,y),v=p.slice(y+1);try{f.call(b,v,e)}catch(e){et("event ".concat(t," ").concat(f,".call(").concat(JSON.stringify(b),", ").concat(JSON.stringify(v),")"),e)}}else if("function"==typeof f[p])try{f[p](e)}catch(e){et("event ".concat(t," ").concat(f,".").concat(p,"()"),e)}else et("event ".concat(t," ").concat(f,".").concat(p,"(): method not found"));else{var g=Nc(p,f);try{g(e)}catch(e){et("event ".concat(t," ").concat(f," ").concat(g),e)}}else qe("event ".concat(t," .").concat(p,"(): subscriber not found"))}}catch(t){u.e(t)}finally{u.f()}}}},{key:"handleViewEventInModel",value:function(t,e){this.subscriptions[t]&&(t=[t],void 0!==e&&t.push(e),e=new nt(this.time,0,"_","handleModelEventInModel",t),this.controller.sendMessage(e))}},{key:"handleModelEventInView",value:function(t,e){var n=this;j.handleEvent(t,e,function(t){if(!$)throw Error("VirtualMachine confusion");var e=$;try{xt(n,t,!($=null))}finally{$=e}})}},{key:"handleViewEventInView",value:function(t,e){j.handleEvent(t,e)}},{key:"handleTuttiDivergence",value:function(t,e){this.subscriptions[t]?this.handleModelEventInModel(t,e):(t=t.split(":").slice(-1)[0],console.warn("uncaptured divergence in ".concat(t,":"),e))}},{key:"processModelViewEvents",value:function(t){var e=this;if($)throw Error("cannot process view events in model code");return xt(this,function(){return j.processFrameEvents(t,!!e.controller.synced)})}},{key:"handlePollForSnapshot",value:function(){var t=this.time,e=t-this.lastSnapshotPoll;e<5e3?console.log("rejecting snapshot poll ".concat(e,"ms after previous")):(this.lastSnapshotPoll=t,this.controller.handlePollForSnapshot(t))}},{key:"handleTuttiResult",value:function(t){this.controller.handleTuttiResult(t)}},{key:"handleSnapshotVote",value:function(t){this.controller.handleSnapshotVote(t)}},{key:"handlePersistVote",value:function(t){this.controller.handlePersistVote(t)}},{key:"snapshot",value:function(){return bo.newOrRecycled(this).snapshot(this,"_")}},{key:"getSummaryHash",value:function(){return kt((new yo).getHash(this))}},{key:"persist",value:function(t,e){var i=H.begin("snapshot"),t="function"==typeof e?e.call(t):e;if("object"!==n(t))throw Error("Croquet: persistSession() can only persist objects (got ".concat(n(t),")"));var e=kt(t),t=eo.hash(e),i=H.end("snapshot")-i,r=this.persisted===t,s=this.time;io.snapshot&&console.log("".concat(this.id," persistent data @").concat(s," collected, stringified and hashed in ").concat(Math.ceil(i),"ms").concat(r?" (unchanged, ignoring)":"")),r||(lo.set(this,{persistTime:s,persistentString:e,persistentHash:t,ms:i}),this.persisted=t,this.inPersistenceCoolOff?io.snapshot&&console.log("".concat(this.id," persistence poll postponed by cooloff")):0<(r=this.lastPersistencePoll?this.lastPersistencePoll+25e3-this.time:0)?(io.snapshot&&console.log("".concat(this.id," postponing persistence poll by ").concat(r,"ms")),this.futureSend(r,this.id,"triggerPersistencePoll",[]),this.inPersistenceCoolOff=!0):this.triggerPersistencePoll())}},{key:"triggerPersistencePoll",value:function(){var t=this;this.inPersistenceCoolOff=!1,this.lastPersistencePoll=this.controller?this.time:0;var e,n,i,r,s,o=lo.get(this);o&&(e=o.persistTime,n=o.persistentString,i=o.persistentHash,r=o.ms,jc(this),this.controller)&&this.controller.synced&&(io.snapshot&&console.log("".concat(this.id," asking controller to poll for persistence @").concat(e)),s=this.time,Promise.resolve().then(function(){return t.controller.pollForPersist(s,e,n,i,r)}))}},{key:"random",value:function(){if($!==this)throw Error("replicated random accessed from outside the model");return this._random()}},{key:"randomID",value:function(){if($!==this)throw Error("replicated random accessed from outside the model");for(var t="",e=0;e<4;e++)t+=(this._random.int32()>>>0).toString(16).padStart(8,"0");return t}},{key:"toString",value:function(){return"VirtualMachine[".concat(this.id,"]")}},{key:Symbol.toPrimitive,value:function(){return this.toString()}}],[{key:"current",value:function(){return $||console.warn("VirtualMachine.current() called from outside the vm!"),$}},{key:"hasCurrent",value:function(){return!!$}},{key:"evaluate",value:function(t){if($)return t();Ic();var e=$;try{return $=new ho,t()}finally{$=e}}}]),t}();function Oc(t,e){r=1===t.length||"["===t[1]?(i=parseInt(t[0],36),n="_",i=oo[i],t.slice(1)):(r=t.indexOf(">"),-1===(s=t.indexOf("["))&&(s=t.length),n=t.slice(0,r),i=t.slice(r+1,s),t.slice(s));var n,i,r,s,t=[];return{receiver:n,selector:i,args:t=r?Zo.newOrRecycled(e).decode(JSON.parse(r)):t}}function Dc(t,e){return 0<=(e-t|0)}var po,nt=function(){function t(e,n,i,r,s){o(this,t),this.time=e,this.seq=n,this.receiver=i,this.selector=r,this.args=s}return a(t,[{key:"convertIfNeeded",value:function(t){var e,n;return this.payload&&(e=(t=Oc(this.payload,t)).receiver,n=t.selector,t=t.args,delete this.payload,this.receiver=e,this.selector=n,this.args=t),this}},{key:"before",value:function(t){return this.time!==t.time?this.time<t.time:this.isExternal()!==t.isExternal()?t.isExternal():this.isExternal()?Dc(this.externalSeq,t.externalSeq):Dc(this.internalSeq,t.internalSeq)}},{key:"hasReceiver",value:function(t){return this.receiver===t}},{key:"isExternal",value:function(){return 1&this.seq}},{key:"externalSeq",get:function(){return this.seq/2>>>0},set:function(t){this.seq=2*t+1}},{key:"internalSeq",get:function(){return this.seq/2>>>0},set:function(t){this.seq=2*t}},{key:"asState",value:function(){return[this.time,this.seq,function Qc(t,e,n){var i,r;return void 0===(i="_"===t&&"number"==typeof(r=ao[e])?r.toString(36):i)&&(i="".concat(t,">").concat(e)),0<n.length&&(r=go.newOrRecycled(),i+=JSON.stringify(r.encode(n))),i}(this.receiver,this.selector,this.args)]}},{key:"executeOn",value:function(e){var n,i=this,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?function(t){return t()}:function(t){return Hc(e,function(){Lt(e,t)})},r=this.receiver,s=this.selector,o=this.args,a=e.lookUpModel(r);a?"{"===s[0]?(n=Nc(s,a),t(function(){try{n.apply(void 0,w(o))}catch(t){et("".concat(i.shortString()," ").concat(n),t)}})):0<=s.indexOf(".")?t(function(){var t=s.indexOf("."),e=s.slice(0,t),n=s.slice(t+1);try{a.call.apply(a,[e,n].concat(w(o)))}catch(t){et("".concat(i.shortString()," ").concat(a,".call(").concat(JSON.stringify(e),", ").concat(JSON.stringify(n),")"),t)}}):"function"!=typeof a[s]?qe("".concat(this.shortString()," ").concat(a,".").concat(s,"(): method not found")):t(function(){try{a[s].apply(a,w(o))}catch(t){et("".concat(i.shortString()," ").concat(a,".").concat(s,"()"),t)}}):qe("".concat(this.shortString()," ").concat(s,"(): receiver not found"))}},{key:"shortString",value:function(){return"".concat(this.isExternal()?"External":"Future","Message")}},{key:"toString",value:function(){var t=this.receiver,e=this.selector,n=this.args,i=this.isExternal(),r=i?this.externalSeq:this.internalSeq;return"".concat(i?"External":"Future","Message[").concat(this.time).concat(":#"[+i]).concat(r," ").concat(t,".").concat(e,"(").concat(n.map(JSON.stringify).join(", "),")]")}},{key:Symbol.toPrimitive,value:function(){return this.toString()}}],[{key:"fromState",value:function(e,n){var e=Z(e,3),i=e[0],r=e[1],e=Oc(e[2],n);return new t(i,r,e.receiver,e.selector,e.args)}}]),t}(),fo=(Q=new ArrayBuffer(8),po=new DataView(Q),function(t){return po.setFloat64(0,t,!0),po.getInt32(0,!0)+po.getInt32(4,!0)}),yo=function(){function e(){o(this,e),this.refs=new Map,this.todo=[],this.hashers=new Map,this.addHasher("Teatime:Message",nt),this.addHasher("Teatime:Data",no);var t,n=W(xo.allClassTypes());try{for(n.s();!(t=n.n()).done;){var i=Z(t.value,2),r=i[0],s=i[1];this.addHasher(r,s)}}catch(t){n.e(t)}finally{n.f()}}return a(e,[{key:"addHasher",value:function(e,n){var i=this,n=Object.getPrototypeOf(n)===Object.prototype?n:{cls:n,write:function(e){return t({},e)}},r=n.cls,s=n.write;this.hashers.set(r,function(t){return i.hashStructure(t,s(t))})}},{key:"getHash",value:function(t){this.hashState={oC:0,mC:0,nanC:0,infC:0,zC:0,nC:0,nH:0,sC:0,sL:0,fC:0};for(var e=0,n=Object.entries(t);e<n.length;e++){var i,r=Z(n[e],2),s=r[0],r=r[1];"controller"!==s&&"meta"!==s&&("_random"===s?this.hash(r.state(),!1):"messages"===s?(i=r.asArray(),(this.hashState.fC=i.length)&&this.hash(i,!1)):this.hashEntry(s,r))}return this.hashDeferred(),this.hashState}},{key:"hashDeferred",value:function(){for(;0<this.todo.length;){var t=this.todo.shift(),e=t.key,t=t.value;this.hashEntry(e,t,!1)}}},{key:"hash",value:function(t){var e,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];switch(n(t)){case"number":return void(Number.isNaN(t)?this.hashState.nanC++:Number.isFinite(t)?0===t?this.hashState.zC++:(this.hashState.nC++,this.hashState.nH+=fo(t)):this.hashState.infC++);case"string":return this.hashState.sC++,void(this.hashState.sL+=t.length);case"boolean":case"undefined":return;default:if(this.refs.has(t))return;switch(Object.prototype.toString.call(t).slice(8,-1)){case"Array":return void this.hashArray(t,i);case"ArrayBuffer":return void this.hashArray(new Uint8Array(t),!1);case"Set":case"Map":return void this.hashStructure(t,w(t));case"DataView":return void this.hashArray(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),!1);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":return void this.hashArray(t,!1);case"Object":t instanceof xo?this.hashModel(t):t.constructor===Object?this.hashObject(t,i):(e=this.hashers.get(t.constructor))&&e(t)}}}},{key:"hashModel",value:function(t){this.hashState.mC++,this.refs.set(t,!0);for(var e=0,n=Object.entries(t);e<n.length;e++){var i=Z(n[e],2),r=i[0],i=i[1];"__realm"!==r&&void 0!==i&&this.hashEntry(r,i)}}},{key:"hashObject",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.hashState.oC++,this.refs.set(t,!0);for(var n=0,i=Object.entries(t);n<i.length;n++){var r=Z(i[n],2),s=r[0],r=r[1];void 0!==r&&this.hashEntry(s,r,e)}}},{key:"hashArray",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.refs.set(t,!0);for(var n=0;n<t.length;n++)this.hashEntry(n,t[n],e)}},{key:"hashStructure",value:function(t,e){void 0!==e&&(this.refs.set(t,!0),this.hash(e,!1))}},{key:"hashEntry",value:function(t,e){"$"!==t[0]&&((!(2<arguments.length&&void 0!==arguments[2])||arguments[2])&&"object"===n(e)?this.todo.push({key:t,value:e}):this.hash(e))}}]),e}(),bo=function(){function e(t){o(this,e),this.vm=t,this.nextRef=1,this.refs=new Map,this.todo=[],this.writers=new Map,this.addWriter("Teatime:Message",nt),this.addWriter("Teatime:Data",no);var n,i=W(xo.allClassTypes());try{for(i.s();!(n=i.n()).done;){var r=Z(n.value,2),s=r[0],a=r[1];this.addWriter(s,a)}}catch(t){i.e(t)}finally{i.f()}this.okayToIgnore={};var c,l=W(xo.allClasses());try{for(l.s();!(c=l.n()).done;){var h=c.value;if(Object.prototype.hasOwnProperty.call(h,"okayToIgnore")){var u=h.okayToIgnore();if(!Array.isArray(u))throw new Error("okayToIgnore() must return an array");var d,m=W(u);try{for(m.s();!(d=m.n()).done;){var p=d.value;if("$"!==p[0])throw Error('okayToIgnore: ignored prop "'.concat(p,"\" must start with '$'"));this.okayToIgnore[p]=!0}}catch(t){m.e(t)}finally{m.f()}}}}catch(t){l.e(t)}finally{l.f()}}return a(e,[{key:"addWriter",value:function(n,e){var i=this,e=Object.getPrototypeOf(e)===Object.prototype?e:{cls:e,write:function(e){return t({},e)}},r=e.cls,s=e.write;this.writers.set(r,function(t,e){return i.writeAs(n,t,s(t),e)})}},{key:"snapshot",value:function(t){for(var e={_random:t._random.state(),messages:this.write(t.messages.asArray())},n=0,i=Object.entries(t);n<i.length;n++){var r=Z(i[n],2),s=r[0],r=r[1];"controller"===s||e[s]||this.writeInto(e,s,r,"_")}return this.writeDeferred(),e}},{key:"writeDeferred",value:function(){for(;0<this.todo.length;){var t=this.todo.shift(),e=t.state,n=t.key,i=t.value,t=t.path;this.writeInto(e,n,i,t,!1)}}},{key:"write",value:function(t,e){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];switch(n(t)){case"number":return Object.is(t,-0)?{$class:"NegZero"}:Number.isSafeInteger(t)?t:Number.isNaN(t)?{$class:"NaN"}:Number.isFinite(t)?this.writeFloat(t):{$class:"Infinity",$value:Math.sign(t)};case"string":case"boolean":return t;case"undefined":return{$class:"Undefined"};default:if(this.refs.has(t))return this.writeRef(t);var r=Object.prototype.toString.call(t).slice(8,-1);switch(r){case"Array":return this.writeArray(t,e,i);case"ArrayBuffer":return this.writeArrayBuffer(t);case"Set":return this.writeAs(r,t,w(t),e);case"Map":return this.writeAs(r,t,w(t).flat(),e);case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":return this.writeTypedArray(r,t);case"Object":if(t instanceof xo)return this.writeModel(t,e);if(t.constructor===Object||"function"!=typeof t.constructor)return this.writeObject(t,e,i);var s=this.writers.get(t.constructor);if(s)return s(t,e);throw console.error("Croquet Snapshot: unknown class ".concat(e,":"),t),Error("Croquet Snapshot: class not registered in Model.types(): ".concat(t.constructor.name));case"Null":return t;default:throw console.error("Croquet Snapshot: unsupported property ".concat(e,":"),t),Error("Croquet Snapshot: ".concat(r,"s are not supported as model properties"))}}}},{key:"writeModel",value:function(t,e){var n={};this.refs.set(t,n);try{n.$model=xo.classToID(t.constructor)}catch(n){throw console.error("unregistered model class at ".concat(e,":"),t),n}var i,r=W(Object.keys(t).sort());try{for(r.s();!(i=r.n()).done;){var s,o=i.value;"__realm"!==o&&(s=t[o],this.writeInto(n,o,s,e))}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"writeObject",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i={};this.refs.set(t,i);var r,s=W(Object.keys(t).sort());try{for(s.s();!(r=s.n()).done;){var o=r.value,a=t[o];this.writeInto(i,o,a,e,n)}}catch(t){s.e(t)}finally{s.f()}return i}},{key:"writeArray",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=[];this.refs.set(t,i);for(var r=0;r<t.length;r++)this.writeInto(i,r,t[r],e,n);return i}},{key:"writeArrayBuffer",value:function(t){var e={$class:"ArrayBuffer",$value:function il(t){for(var e=new Uint8Array(t),n=e.byteLength,i="",r=0;r<n;r++)i+=String.fromCharCode(e[r]);return globalThis.btoa(i)}(t)};return this.refs.set(t,e),e}},{key:"writeTypedArray",value:function(t,e){t={$class:t,$value:[this.writeArrayBuffer(e.buffer),e.byteOffset,"DataView"===t?e.byteLength:e.length]};return this.refs.set(e,t),t}},{key:"writeFloat",value:function(t){return t}},{key:"writeAs",value:function(t,e,i,r){return void 0===i?i:(this.refs.set(e,e={$class:t}),"object"!==n(t=this.write(i,r,!1))||t.$class||Array.isArray(t)?e.$value=t:Object.assign(e,t),e)}},{key:"writeRef",value:function(t){var e=this.refs.get(t);if("object"!==n(e))throw Error("Non-object in refs: "+t);return Array.isArray(e)&&(e.toJSON=function(){return{$id:this.$id,$class:"Array",$value:w(this)}}),{$ref:e.$id||(e.$id=this.nextRef++)}}},{key:"writeInto",value:function(t,e,i,r){"$"!==e[0]?(!(4<arguments.length&&void 0!==arguments[4])||arguments[4])&&"object"===n(i)?this.todo.push({state:t,key:e,value:i,path:r}):(r=r+("string"==typeof e&&e.match(/^[_a-z][_a-z0-9]*$/i)?".".concat(e):"[".concat(JSON.stringify(e),"]")),void 0!==(i=this.write(i,r))&&(t[e]=i)):this.okayToIgnore[e]||(qe("snapshot: ignoring property ".concat(e," (declare as okayToIgnore to suppress warning)"),{only:"once"}),this.okayToIgnore[e]=!0)}}],[{key:"newOrRecycled",value:function(t){var e=this.reusableInstance;return e?(e.vm=t,e.nextRef=1,e.refs=new Map,e.todo=[]):e=this.reusableInstance=new this(t),e}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(t){this[this.name+"-instance"]=t}},{key:"resetInstance",value:function(){this.reusableInstance=null}}]),e}(),vo=function(){function e(t){o(this,e),this.vm=t,this.refs=new Map,this.todo=[],this.unresolved=[],this.readers=new Map,this.addReader("Teatime:Message",nt),this.addReader("Teatime:Data",no),this.readers.set("Undefined",function(){}),this.readers.set("NaN",function(){return NaN}),this.readers.set("Infinity",function(t){return t*(1/0)}),this.readers.set("NegZero",function(){return-0}),this.readers.set("ArrayBuffer",function(t){for(var e=globalThis.atob(t),n=e.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.charCodeAt(r);return i.buffer}),this.readers.set("DataView",function(t){return f(DataView,w(t))}),this.readers.set("Int8Array",function(t){return f(Int8Array,w(t))}),this.readers.set("Uint8Array",function(t){return f(Uint8Array,w(t))}),this.readers.set("Uint8ClampedArray",function(t){return f(Uint8ClampedArray,w(t))}),this.readers.set("Int16Array",function(t){return f(Int16Array,w(t))}),this.readers.set("Uint16Array",function(t){return f(Uint16Array,w(t))}),this.readers.set("Int32Array",function(t){return f(Int32Array,w(t))}),this.readers.set("Uint32Array",function(t){return f(Uint32Array,w(t))}),this.readers.set("Float32Array",function(t){return f(Float32Array,w(t))}),this.readers.set("Float64Array",function(t){return f(Float64Array,w(t))});var n,i=W(xo.allClassTypes());try{for(i.s();!(n=i.n()).done;){var r=Z(n.value,2),s=r[0],a=r[1];this.addReader(s,a)}}catch(t){i.e(t)}finally{i.f()}}return a(e,[{key:"addReader",value:function(t,e){var i="object"===n(e)?e.read:function(t){return Object.assign(Object.create(e.prototype),t)};this.readers.set(t,i)}},{key:"readVM",value:function(t,e){if("_"!==e)throw Error("VirtualMachine must be root object");for(var n={_random:new Zt(null,{state:t._random})},i=0,r=Object.entries(t);i<r.length;i++){var s=Z(r[i],2),o=s[0],s=s[1];n[o]||this.readInto(n,o,s,e)}return this.readDeferred(),this.resolveRefs(),n}},{key:"readDeferred",value:function(){for(;0<this.todo.length;){var t=this.todo.shift(),e=t.object,n=t.key,i=t.value,t=t.path;this.readInto(e,n,i,t,!1)}}},{key:"resolveRefs",value:function(){var t,e=W(this.unresolved);try{for(e.s();!(t=e.n()).done;){var n=t.value,i=n.object,r=n.key,s=n.ref,o=n.path;if(!this.refs.has(s))throw Error("Unresolved ref: ".concat(s," at ").concat(o,"[").concat(JSON.stringify(r),"]"));i[r]=this.refs.get(s)}}catch(t){e.e(t)}finally{e.f()}}},{key:"read",value:function(t,e){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];switch(n(t)){case"number":case"string":case"boolean":return t;default:var r=Object.prototype.toString.call(t).slice(8,-1);switch(r){case"Array":return this.readArray(t,e,i);case"Null":return null;case"Object":var s=t.$class,o=t.$model;if(t.$ref)throw Error("refs should have been handled in readInto()");return o?this.readModel(t,e):s?this.readAs(s,t,e):this.readObject(Object,t,e,i);default:throw Error("Don't know how to deserialize ".concat(r," at ").concat(e))}}}},{key:"readModel",value:function(t,e){var n=xo.instantiateClassID(t.$model,t.id);t.$id&&this.refs.set(t.$id,n);for(var i=0,r=Object.entries(t);i<r.length;i++){var s=Z(r[i],2),o=s[0],s=s[1];"id"!==o&&"$"!==o[0]&&this.readInto(n,o,s,e)}return n}},{key:"readObject",value:function(t,e,n){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r=new t;e.$id&&this.refs.set(e.$id,r);for(var s=0,o=Object.entries(e);s<o.length;s++){var a=Z(o[s],2),c=a[0],a=a[1];"$"!==c[0]&&this.readInto(r,c,a,n,i)}return r}},{key:"readArray",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=[];t.$id&&this.refs.set(t.$id,i);for(var r=0;r<t.length;r++)void 0!==t[r]&&this.readInto(i,r,t[r],e,n);return i}},{key:"readAsArray",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=t.$value;return t.$id&&(i.$id=t.$id),this.readArray(i,e,n)}},{key:"readAsSet",value:function(t,e){var n=new Set;t.$id&&this.refs.set(t.$id,n);var i,r=W(this.read(t.$value,e,!1));try{for(r.s();!(i=r.n()).done;){var s=i.value;n.add(s)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"readAsMap",value:function(t,e){var n=new Map;t.$id&&this.refs.set(t.$id,n);for(var i=this.read(t.$value,e,!1),r=0;r<i.length;r+=2)n.set(i[r],i[r+1]);return n}},{key:"readAsClass",value:function(t,e,n){var i={},r=new Map;if("$value"in e)i=this.read(e.$value,n,!1);else for(var s=0,o=Object.entries(e);s<o.length;s++){var a,c=Z(o[s],2),l=c[0],c=c[1];"$"!==l[0]&&((a=c&&c.$ref)?this.refs.has(a)?i[l]=this.refs.get(a):(i[l]="<unresolved>",r.set(a,l)):this.readInto(i,l,c,n,!1))}var h=this.readers.get(t)(i,n);h||"Undefined"===t||"NaN"===t||"NegZero"===t||console.warn('Reading "'.concat(t,'" returned ').concat(h," at ").concat(n)),e.$id&&this.refs.set(e.$id,h);var u,d=W(r.entries());try{for(d.s();!(u=d.n()).done;){var m=Z(u.value,2),p=m[0],f=m[1];this.unresolved.push({object:h,key:f,ref:p,path:n})}}catch(t){d.e(t)}finally{d.f()}return h}},{key:"readAs",value:function(t,e,n){switch(t){case"Array":return this.readAsArray(e,n);case"Set":return this.readAsSet(e,n);case"Map":return this.readAsMap(e,n);default:return this.readAsClass(t,e,n)}}},{key:"readRef",value:function(t,e,n,i){return!(!n||!n.$ref||(n=n.$ref,this.refs.has(n)?t[e]=this.refs.get(n):(t[e]="<unresolved>",this.unresolved.push({object:t,key:e,ref:n,path:i})),0))}},{key:"readInto",value:function(t,e,i,r){var s=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];this.readRef(t,e,i,r)||(s&&"object"===n(i)?this.todo.push({object:t,key:e,value:i,path:r}):(s=r+("string"==typeof e&&e.match(/^[_a-z][_a-z0-9]*$/i)?".".concat(e):"[".concat(JSON.stringify(e),"]")),t[e]=this.read(i,s)))}}],[{key:"newOrRecycled",value:function(t){var e=this.reusableInstance;return e?(e.vm=t,e.refs=new Map,e.todo=[],e.unresolved=[]):e=this.reusableInstance=new this(t),e}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(t){this[this.name+"-instance"]=t}},{key:"resetInstance",value:function(){this.reusableInstance=null}}]),e}(),go=function(){l(n,bo);var t=b(n);function n(){return o(this,n),t.apply(this,arguments)}return a(n,[{key:"encode",value:function(t){t=this.writeArray(t,"$");return this.writeDeferred(),t}},{key:"writeModel",value:function(t){return{$ref:t.id}}}]),n}(),Zo=function(){l(n,vo);var t=b(n);function n(){return o(this,n),t.apply(this,arguments)}return a(n,[{key:"decode",value:function(t){t=this.readArray(t,"$");return this.readDeferred(),this.resolveRefs(),t}},{key:"resolveRefs",value:function(){var t,e=W(this.unresolved);try{for(e.s();!(t=e.n()).done;){var n=t.value,i=n.object,r=n.key,s=n.ref,o=n.path;if(this.refs.has(s))i[r]=this.refs.get(s);else{var a=this.vm.lookUpModel(s);if(!a)throw Error("Unresolved ref: ".concat(s," at ").concat(o,"[").concat(JSON.stringify(r),"]"));i[r]=a}}}catch(t){e.e(t)}finally{e.f()}}}]),n}();var wo=M.has("debug","classes",!1),Xo=Symbol("SECRET"),Lo=new WeakSet,xo=function(){function t(e){if(o(this,t),e!==Xo)throw Error("You must create ".concat(this,' using create() not "new"!'))}return a(t,[{key:"init",value:function(t){Lo.delete(this)}},{key:"destroy",value:function(){wt().unsubscribeAll(this),wt().deregister(this)}},{key:"publish",value:function(t,e,n){this.__realm||this.__realmError(),this.__realm.publish(e,n,t)}},{key:"subscribe",value:function(t,e,n){return this.__realm||this.__realmError(),this.__realm.subscribe(this,t,e,n)}},{key:"unsubscribe",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"*";this.__realm||this.__realmError(),this.__realm.unsubscribe(this,t,e,n)}},{key:"unsubscribeAll",value:function(){this.__realm||this.__realmError(),this.__realm.unsubscribeAll(this)}},{key:"__realmError",value:function(){if(!this.id)throw Error("".concat(this," has no ID, did you call super.init(options)?"))}},{key:"future",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length?arguments[1]:void 0;this.__realm||this.__realmError();for(var n=arguments.length,i=new Array(2<n?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.__realm.future(this,t,e,i)}},{key:"random",value:function(){return wt().random()}},{key:"now",value:function(){return wt().now()}},{key:"beWellKnownAs",value:function(t){wt().vm.set(t,this)}},{key:"getModel",value:function(t){return this.__realm.vm.lookUpModel(t)}},{key:"wellKnownModel",value:function(t){return this.__realm.vm.get(t)}},{key:"modelOnly",value:function(t){if(uo.current()===this.__realm.vm)return!0;t=Error(t||"".concat(this,".modelOnly() called from outside a model!"));throw et("view code",t),t}},{key:"sessionId",get:function(){return this.__realm.vm.id}},{key:"viewCount",get:function(){return Object.keys(this.__realm.vm.views).length}},{key:"persistSession",value:function(t){if(this!==this.wellKnownModel("modelRoot"))throw Error("persistSession() must only be called on the root model");this.__realm.vm.persist(this,t)}},{key:Symbol.toPrimitive,value:function(){var t=this.constructor[Go]||this.constructor.name;return t.includes("Model")?t:"".concat(t,"[Model]")}}],[{key:"create",value:function(e,n,i){var r,s;if(hl(this))return r=wt(),s=new this(Xo),Object.defineProperty(s,"__realm",{value:r}),Object.defineProperty(s,"id",{value:r.register(s),enumerable:!0}),Lo.add(s),"string"==typeof n&&(console.warn('Croquet: Model.create(..., "'.concat(n,'") with a well-known name argument is deprecated!')),s.beWellKnownAs(n),n=void 0),i&&s.beWellKnownAs(i),s.init(e,n),Lo.has(s)&&(Lo.delete(s),Object.getPrototypeOf(this)!==t)&&console.warn("".concat(s," did not call super.init(options)")),s;throw Error('Model class "'.concat(this.name,'" not registered'))}},{key:"createNoInit",value:function(t){var e=wt(),n=new this(Xo);return Object.defineProperty(n,"__realm",{value:e}),Object.defineProperty(n,"id",{value:t,enumerable:!0}),n}},{key:"allowConstructors",value:function(){Xo=void 0,console.warn("disabling error reporting for Model constructors")}},{key:"register",value:function(t){t||(t=this.name,console.warn("Deprecation warning: ".concat(this.name,".register(classId) called without classId. See https://croquet.io/sdk/docs/Model.html#.register"))),vo.resetInstance(),bo.resetInstance(),go.resetInstance(),Zo.resetInstance();var e=this,n=t,e=(e=re(e),e=ue("".concat(n,":").concat(e)),Kt.push(e),ae()&&e.then(function(t){Rt[t].what="Class ".concat(n)}),this),i=ko[t];if(i&&i!==e)throw Error("Registering model class ".concat(e.name,' failed, id "').concat(t,'" already used by ').concat(i.name));return hl(e)?wo&&!i&&console.warn("ignoring re-exported model class ".concat(t)):(wo&&console.log("registering model class ".concat(t)),e[Go]=t),ko[t]=e,this}},{key:"wellKnownModel",value:function(t){if(uo.hasCurrent())return uo.current().get(t);throw Error("static Model.wellKnownModel() called from outside model")}},{key:"evaluate",value:function(t){return uo.evaluate(t)}},{key:"types",value:function(){return{}}},{key:"okayToIgnore",value:function(){return[]}},{key:"classToID",value:function(t){if(hl(t))return t[Go];throw t=t.name||"ClassName",Error("Model class not registered, did you call ".concat(t,'.register("').concat(t,'")?'))}},{key:"classFromID",value:fl},{key:"allClasses",value:dl},{key:"allClassTypes",value:function(){var t,e={},n=W(dl());try{for(n.s();!(t=n.n()).done;){var i=t.value;Object.assign(e,i.types())}}catch(t){n.e(t)}finally{n.f()}return Object.entries(e)}},{key:"instantiateClassID",value:function(t,e){return fl(t).createNoInit(e)}}]),t}(),ko={},Go=Symbol("CLASS_ID");function dl(){return Object.values(ko)}function hl(t){return Object.prototype.hasOwnProperty.call(t,Go)}function fl(t){if(ko[t])return ko[t];throw Error('Model class "'.concat(t,'" in snapshot, but not registered?'))}xo[Go]="Croquet.Model",ko["Croquet.Model"]=xo;var So=function(){function r(t){o(this,r),"object"===n(t)&&"__realm"in t||console.warn("Croquet: argument to View constructor needs to be a Model");var e=wt("");e&&e.isViewRealm()||(e=xt(t.__realm.vm,function(){return wt()},!0)),Object.defineProperty(this,"realm",{value:e}),Object.defineProperty(this,"id",{value:e.register(this),configurable:!0})}return a(r,[{key:"detach",value:function(){this.unsubscribeAll(),this.realm.deregister(this),Object.defineProperty(this,"id",{value:""})}},{key:"reattach",value:function(){Object.defineProperty(this,"id",{value:this.realm.register(this)})}},{key:"publish",value:function(t,e,n){this.realm.publish(e,n,t)}},{key:"subscribe",value:function(t,e,n){var i=n="string"==typeof n?this[n]:n,i=((n=i.bind(this)).unbound=i,e.event?e:{event:e}),e=i.event,i=i.handling;this.realm.subscribe(e,this.id,n,t,i)}},{key:"unsubscribe",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;"string"==typeof n&&(n=this[n]),this.realm.unsubscribe(e,this.id,n,t)}},{key:"unsubscribeAll",value:function(){this.realm.unsubscribeAll(this.id)}},{key:"future",value:function(){return this.realm.future(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}},{key:"random",value:function(){return wt().random()}},{key:"now",value:function(){return this.realm.now()}},{key:"externalNow",value:function(){return this.realm.externalNow()}},{key:"extrapolatedNow",value:function(){return this.realm.extrapolatedNow()}},{key:"update",value:function(t){}},{key:"wellKnownModel",value:function(t){return this.realm.vm.get(t)}},{key:"sessionId",get:function(){return this.realm.vm.id}},{key:"session",get:function(){return this.realm.vm.controller.session}},{key:"viewId",get:function(){return this.realm.vm.controller.viewId}},{key:Symbol.toPrimitive,value:function(){var t=this.constructor.name;return t.includes("View")?t:"".concat(t,"[View]")}}],[{key:"displayStatus",value:function(t,e){return $e(t,e)}},{key:"displayWarning",value:function(t,e){return qe(t,e)}},{key:"displayError",value:function(e,n){return function(e,n){return e&&E.showMessage(e,t(t({},1<arguments.length&&void 0!==n?n:{}),{},{level:"error"}))}(e,n)}}]),r}(),To=new(function(){function e(){o(this,e),this.ready=!1,this.isInIframe=window.top!==window,this.subscriptions={},this.enumerator=null}return a(e,[{key:"setReceiver",value:function(t){this.receiver=t,this.ready=!0}},{key:"setIframeEnumerator",value:function(t){this.enumerator=t}},{key:"on",value:function(t,e){var n=this;if(!this.receiver)throw Error("setReceiver() has not been called");if(!(e="string"==typeof e?this.receiver[e]:e))throw Error("Messenger.on: the second argument must be a method name or a function");if(this.subscriptions[t]){if(0<=this.findIndex(this.subscriptions[t],e))throw Error("".concat(e," is already subscribed"))}else this.subscriptions[t]=[];this.subscriptions[t].push(e),this.listener||(this.listener=function(t){return n.receive(t)},window.addEventListener("message",this.listener))}},{key:"detach",value:function(){this.listener&&(window.removeEventListener("message",this.listener),this.listener=null),this.stopPublishingPointerMove(),this.receiver=null,this.subscriptions={},this.enumerator=null,this.ready=!1}},{key:"removeSubscription",value:function(t,e){"string"==typeof e&&(e=this.receiver[e]);var n=this.subscriptions[t];n&&(e=this.findIndex(n,e),n.splice(e,1),0===n.length)&&delete this.subscriptions[t]}},{key:"removeAllSubscriptions",value:function(){this.subscriptions={}}},{key:"receive",value:function(t){var e=t.data,n=e.event,e=e.data,t=t.source;this.handleEvent(n,e,t)}},{key:"handleEvent",value:function(t,e,n){var i=this,t=this.subscriptions[t];t&&t.forEach(function(t){t.call(i.receiver,e,n)})}},{key:"send",value:function(e,n,t){this.isInIframe?window.top.postMessage({event:e,data:n},"*"):t?t.postMessage({event:e,data:n},"*"):this.enumerator&&this.enumerator().forEach(function(t){t.contentWindow.postMessage({event:e,data:n},"*")})}},{key:"findIndex",value:function(t,n){var i=n.name;return t.findIndex(function(t){var e=t.name;return i||e?i===e:n===t})}},{key:"startPublishingPointerMove",value:function(){var e=this;this._moveHandler||(this._moveHandler=function(t){return e.send("pointerPosition",{x:t.clientX,y:t.clientY,type:t.type})},window.document.addEventListener("pointermove",this._moveHandler,!0))}},{key:"stopPublishingPointerMove",value:function(){this._moveHandler&&(window.document.removeEventListener("pointermove",this._moveHandler,!0),this._moveHandler=null)}}]),e}()),Mo="node"===mt.CROQUET_PLATFORM,Ro=60,Yo=function(){function e(){o(this,e)}var s,c,l;return a(e,null,[{key:"join",value:(l=i(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.join_impl(n);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),E.showMessage(t.t0.message,{level:"fatal"}),t.t0;case 10:case"end":return t.stop()}},e,this,[[0,6]])})),function(t){return l.apply(this,arguments)})},{key:"join_impl",value:(c=i(regeneratorRuntime.mark(function r(s){var o,a,c,l,h,u,d,m,p,f,y,b,v,g,X,L,x,k,G,S,W,T,C;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(C=function(){g.model=null,g.view&&(M.has("debug","session",!1)&&console.log(g.id,"detaching root view"),g.view.detach(),""!==g.view.id&&console.warn("Croquet: ".concat(g.view," did not call super.detach()")),g.view=null),E.clearSessionMoniker(),To.ready&&To.detach()},T=function(){return(T=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(C(),b.leaving)return b.leaving(!0),t.abrupt("return");t.next=4;break;case 4:if(S)return t.abrupt("return");t.next=6;break;case 6:return S=!0,t.next=9,b.establishSession(X);case 9:S=!1,g.model=b.vm.get("modelRoot"),g.id=b.id,g.persistentId=b.persistentId,g.versionId=b.versionId,b.session=g,E.makeSessionWidgets(g.id),b.inViewRealm(function(){M.has("debug","session",!1)&&console.log(g.id,"creating root view"),g.view=new u(g.model)});case 17:case"end":return t.stop()}},e)}))).apply(this,arguments)},W=function(){return T.apply(this,arguments)},l=function(t,e){return t===e||t.prototype instanceof e},"object"!==n(s))throw Error("Croquet: please use new Session.join( {apiKey, ...} ) API. See https://croquet.io/sdk/docs/Session.html#.join");r.next=6;break;case 6:o=0,a=Object.entries(s);case 7:if(o<a.length){if(d=Z(a[o],2),c=d[0],(d=d[1])instanceof Promise)return r.next=12,d;r.next=13}else r.next=16;break;case 12:s[c]=r.sent;case 13:o++,r.next=7;break;case 16:if("string"!=typeof s.apiKey)throw Error("Croquet: no apiKey provided in Session.join()!");r.next=18;break;case 18:if(128<s.apiKey.length)throw Error("Croquet: apiKey > 128 characters in Session.join()!");r.next=20;break;case 20:if("string"!=typeof s.name)throw Error("Croquet: no session name provided in Session.join()!");r.next=22;break;case 22:if(128<s.name.length)throw Error("Croquet: session name > 128 characters in Session.join()!");r.next=24;break;case 24:if("function"==typeof(h=s.model)&&l(h,xo)){r.next=27;break}throw Error("Croquet: bad model class in Session.join()");case 27:if("function"==typeof(u=s.view||So)&&l(u,So)){r.next=30;break}throw Error("Croquet: bad view class in Session.join()");case 30:if("string"!=typeof s.appId)throw Error("Croquet: no appId provided in Session.join()");r.next=32;break;case 32:if(128<!s.appId.length)throw Error("Croquet: appId > 128 characters in Session.join()");r.next=34;break;case 34:if(s.appId.match(/^[a-z](-?[a-z0-9_])*(\.[a-z0-9_](-?[a-z0-9_])*)+$/i)){r.next=36;break}throw Error("Croquet: malformed appId in Session.join()");case 36:if("string"==typeof s.password&&s.password){r.next=38;break}throw Error("Croquet: no password provided in Session.join()");case 38:if((d=M.reflector||s.reflector)&&(d.includes("://")||d.match(/^[-a-z0-9]+$/i)?M.reflector=d:console.warn('Croquet: Not a valid websocket url, ignoring reflector "'.concat(d,'"'))),Mo&&"manual"!==s.step)throw Error("stepping must be manual in a Node.js app");r.next=42;break;case 42:if("rejoinLimit"in s){if("number"!=typeof s.rejoinLimit||s.rejoinLimit<0||6e4<s.rejoinLimit)throw Error("rejoinLimit range: 0-60000");r.next=45}else r.next=47;break;case 45:r.next=48;break;case 47:s.rejoinLimit=1e3;case 48:if("eventRateLimit"in s){if("number"!=typeof s.eventRateLimit||s.eventRateLimit<1||60<s.eventRateLimit)throw Error("eventRateLimit range: 1-60");r.next=51}else r.next=53;break;case 51:r.next=54;break;case 53:s.eventRateLimit=20;case 54:if(s.heraldUrl){if(256<s.heraldUrl.length)throw Error("heraldUrl can only be 256 characters");r.next=57}else r.next=59;break;case 57:if(s.heraldUrl.startsWith("https://")){r.next=59;break}throw Error("heraldUrl needs to be https");case 59:if(s.hashOverride){if(43!==s.hashOverride.length)throw Error("hashOverride must be 43 characters");r.next=62}else r.next=64;break;case 62:if(-1!==s.hashOverride.search(/[^-_a-zA-Z0-9]/))throw Error("hashOverride must be base64url encoded");r.next=64;break;case 64:if(s.debug&&(f=function(t){return(t="string"==typeof t?t.split(","):t)?Array.isArray(t)?t:[t]:[]},M.debug=[].concat(w(f(s.debug)),w(f(M.debug))).join(",")),"autoSleep"in s)if(m=s.autoSleep,"number"!==(p=n(m)))r.next=73;else{if(m<0)throw Error("an autoSleep value must be >= 0");r.next=71}else r.next=80;break;case 71:r.next=78;break;case 73:"boolean"!==p?r.next=77:(s.autoSleep=m?10:0,r.next=78);break;case 77:throw Error("autoSleep must be numeric or boolean");case 78:r.next=81;break;case 80:s.autoSleep=10;case 81:s.flags&&((f=(f=(f="string"==typeof(f=s.flags)?f.split(","):f)?Array.isArray(f)?f:[f]:[]).filter(function(t){return"object"!==n(t)})).length?(s.flags={},f.forEach(function(t){return s.flags[t]=!0})):s.flags=null),"expectedSimFPS"in s&&(Ro=Math.min(s.expectedSimFPS,120)),y=["name","password","apiKey","appId","tps","autoSleep","heraldUrl","rejoinLimit","eventRateLimit","optionsFromUrl","viewIdDebugSuffix","hashOverride","flags"],function Xl(){var t;Object.isFrozen(Ko)||(function Zl(t){if(!Object.isFrozen(t)){Object.freeze(t);for(var e=0,i=Object.values(t);e<i.length;e++){var r=i[e];!r||"object"!==n(r)&&"function"!=typeof r||Zl(r)}}}(Ko),"{}"!==(t=JSON.stringify(Ko,function(t,e){return"function"==typeof e?re(e):e}))&&(t=JSON.parse(t),t=ue(kt(t)),Kt.push(t),ae())&&t.then(function(t){Rt[t].what="Croquet Constants"}))}(),b=new Os,v=JSON.parse(JSON.stringify(t({},s.options))),r.t0=function(t){b.stepSession("animation",{frameTime:t,view:g.view,expectedSimFPS:Ro})},r.t1=function(){return e.leave(g.id)},g={id:"",persistentId:"",versionId:"",model:null,view:null,step:r.t0,leave:r.t1,get latency(){return b.latency},get latencies(){return b.latencies}},X={options:v,initFn:function(t,e){return h.create(t,e,"modelRoot")},rebootModelView:W};for(L=0,x=Object.entries(s);L<x.length;L++)G=Z(x[L],2),k=G[0],G=G[1],y.includes(k)&&(X[k]=G);return r.next=94,b.initFromSessionSpec(X);case 94:return S=!1,r.next=97,W();case 97:return"manual"!==s.step&&b.startStepping(g.step),r.abrupt("return",g);case 99:case"end":return r.stop()}},r)})),function(t){return c.apply(this,arguments)})},{key:"leave",value:(s=i(regeneratorRuntime.mark(function e(n){var i,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=function gc(t){var e,n=W(Ds);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.id===t)return i}}catch(t){n.e(t)}finally{n.f()}return null}(n)){t.next=3;break}return t.abrupt("return",!1);case 3:if(i.reconnectTimeout&&(clearTimeout(i.reconnectTimeout),delete i.reconnectTimeout),r=new Promise(function(t){return i.leaving=t}),(s=i.connection).connected){t.next=8;break}return t.abrupt("return",!1);case 8:return s.closeConnection(1e3),t.abrupt("return",r);case 10:case"end":return t.stop()}},e)})),function(t){return s.apply(this,arguments)})},{key:"thisSession",value:function(){var t=uo.current();return t?t.id:""}}]),e}(),Ko={};rt.App=E,rt.Constants=Ko,rt.Data=eo,rt.Messenger=To,rt.Model=xo,rt.Session=Yo,rt.View=So,rt.gatherInternalClassTypes=function(t,e){var n={};return function rl(t,e,n,i){var r,s=1<arguments.length&&void 0!==e?e:"",o=2<arguments.length&&void 0!==n?n:{},a=3<arguments.length&&void 0!==i?i:new Set,e=Object.values(t).filter(function(t){var e=Object.prototype.toString.call(t).slice(8,-1);return("Object"===e||"Array"===e)&&!a.has(t)}),c=W(e);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=(a.add(l),s+"."+l.constructor.name);if(o[h]){if(o[h]!==l.constructor)throw new Error("Class with name "+h+" already gathered, but new one has different identity")}else o[h]=l.constructor}}catch(t){c.e(t)}finally{c.f()}var u,d=W(e);try{for(d.s();!(u=d.n()).done;)rl(u.value,s,o,a)}catch(t){d.e(t)}finally{d.f()}}({root:t},e,n,new Set),n},rt.startSession=function(){return E.showMessage("Croquet.startSession() is deprecated, please use Croquet.Session.join()",{level:"warning",only:"once"}),Yo.join.apply(Yo,arguments)}},4200:(t,e,n)=>{n.r(e),n.d(e,{AM_Avatar:()=>a.lV,AM_Player:()=>h.fg,AM_Predictive:()=>a.zL,AM_Smoothed:()=>a.Qz,AM_Spatial:()=>a.ZA,Actor:()=>s.v,ActorManager:()=>s.t,CachedObject:()=>c.X,ClearObjectCache:()=>c.n,FocusManager:()=>o.I,GetModelService:()=>d.J0,GetPawn:()=>l.s_,GetViewService:()=>d.ci,InputManager:()=>y.$,IsLoaded:()=>f.M6,KeyDown:()=>y.z,LoadFont:()=>f.dO,LoadImage:()=>f.r6,ModelRoot:()=>d.D9,ModelService:()=>d.b$,PM_Avatar:()=>a.UZ,PM_Camera:()=>u.k6,PM_Driver:()=>a.VL,PM_Focusable:()=>o.v,PM_Player:()=>h.VX,PM_Predictive:()=>a.vq,PM_Smoothed:()=>a.Di,PM_Spatial:()=>a.fC,PM_Visible:()=>u.Tq,Pawn:()=>l.rE,PawnManager:()=>l.wh,PerlinNoise:()=>m.Fc,PlayerManager:()=>h.XM,PriorityQueue:()=>m.Z3,RegisterMixin:()=>a.nl,RenderManager:()=>u.zo,Shuffle:()=>m.gZ,StartWorldcore:()=>d.CP,TAU:()=>p.gc,TO_DEG:()=>p.FO,TO_RAD:()=>p.Z1,TwoWayMap:()=>m.D8,ViewRoot:()=>d.xS,ViewService:()=>d.s1,WorldcoreModel:()=>d.Uq,WorldcoreView:()=>d.sG,clampRad:()=>p.tG,gaussian:()=>p.Um,m2_identity:()=>p.jy,m2_rotation:()=>p.m$,m2_zero:()=>p.er,m4_determinant:()=>p.sv,m4_getRotation:()=>p.ZU,m4_getTranslation:()=>p.eJ,m4_identity:()=>p.id,m4_invert:()=>p.yW,m4_multiply:()=>p.kx,m4_perspective:()=>p.Sn,m4_rotation:()=>p.yf,m4_rotationQ:()=>p.CV,m4_rotationX:()=>p.MO,m4_rotationY:()=>p.ac,m4_rotationZ:()=>p.LV,m4_scale:()=>p.lR,m4_scaleRotationTranslation:()=>p.FJ,m4_toNormal4:()=>p.pt,m4_translation:()=>p.DF,m4_transpose:()=>p.zC,m4_zero:()=>p.AB,mix:()=>a.CD,q_axisAngle:()=>p.Cq,q_conjugate:()=>p.Kc,q_dot:()=>p.JE,q_equals:()=>p._D,q_euler:()=>p.A$,q_identity:()=>p.C8,q_invert:()=>p.kc,q_isZero:()=>p.CF,q_lookAt:()=>p.eT,q_magnitude:()=>p.qf,q_multiply:()=>p.Lj,q_normalize:()=>p.d6,q_pitch:()=>p.gg,q_roll:()=>p.UJ,q_slerp:()=>p.zc,q_yaw:()=>p.ho,rayTriangleIntersect:()=>p.YR,sphericalRandom:()=>p.yF,toDeg:()=>p.TM,toRad:()=>p.vF,v2_abs:()=>p.Nf,v2_add:()=>p.Pf,v2_angle:()=>p.AM,v2_ceil:()=>p.EZ,v2_divide:()=>p.vU,v2_dot:()=>p.xw,v2_equals:()=>p.eD,v2_floor:()=>p.DP,v2_inverse:()=>p.qT,v2_isZero:()=>p.zE,v2_lerp:()=>p.yK,v2_magnitude:()=>p.vr,v2_manhattan:()=>p.WA,v2_max:()=>p.oy,v2_min:()=>p.KE,v2_multiply:()=>p.eq,v2_normalize:()=>p.uq,v2_random:()=>p.yp,v2_rotate:()=>p.KM,v2_scale:()=>p.Jk,v2_sqrMag:()=>p.BU,v2_sub:()=>p.Ar,v2_transform:()=>p.lQ,v2_zero:()=>p.A6,v3_abs:()=>p.Q0,v3_add:()=>p.S,v3_angle:()=>p.E4,v3_ceil:()=>p.gy,v3_cross:()=>p.sC,v3_divide:()=>p.s_,v3_dot:()=>p.wH,v3_equals:()=>p.nY,v3_floor:()=>p.ZV,v3_inverse:()=>p.Bc,v3_isZero:()=>p.wM,v3_lerp:()=>p.xq,v3_magnitude:()=>p.oN,v3_manhattan:()=>p.XD,v3_max:()=>p._2,v3_min:()=>p.iO,v3_multiply:()=>p.$2,v3_normalize:()=>p.P_,v3_random:()=>p.Jo,v3_rotate:()=>p.Wu,v3_rotateX:()=>p.JU,v3_rotateY:()=>p.lZ,v3_rotateZ:()=>p.Mi,v3_scale:()=>p.gI,v3_sqrMag:()=>p.g8,v3_sub:()=>p.aI,v3_transform:()=>p.w_,v3_zero:()=>p.jk,viewRoot:()=>d.YT});var i=n(8011),r={};for(const b in i)"default"!==b&&(r[b]=()=>i[b]);n.d(e,r);var s=n(2982),o=n(5014),a=n(7469),c=n(148),l=n(9570),h=n(9551),u=n(252),d=n(7184),m=n(2419),p=n(439),f=n(2744),y=n(1480)},2982:(t,e,n)=>{n.d(e,{t:()=>ActorManager,v:()=>Actor});n(9570);e=n(7184);class ActorManager extends e.b${init(t){super.init(t||"ActorManager"),this.actors=new Map}add(t){this.actors.set(t.id,t)}has(t){return this.actors.has(t)}get(t){return this.actors.get(t)}delete(t){this.actors.delete(t.id)}}ActorManager.register("ActorManager");class Actor extends e.Uq{get pawn(){return null}get doomed(){return this._doomed}get parent(){return this._parent}init(t){super.init(),this.listen("parentSet",this.onParent),this.listen("_set",this.set),this.set(t),this.service("ActorManager").add(this),this.publish("actor","createActor",this)}destroy(){new Set(this.children).forEach(t=>t.destroy()),this.set({parent:null}),this._doomed=!0,this.say("destroyActor"),this.service("ActorManager").delete(this),super.destroy()}set(t={}){for(const s of Object.entries(t).sort((t,e)=>e[0]<t[0]?1:-1)){var e=s[0]+"Set",n="_"+s[0],i=s[1],r=this[n];this[n]=i,this.say(e,{v:i,o:r})}}addChild(t){this.children||(this.children=new Set),this.children.add(t)}removeChild(t){this.children&&this.children.delete(t)}onParent(t){t.o&&t.o.removeChild(this),t.v&&t.v.addChild(this)}say(t,e){this.publish(this.id,t,e)}listen(t,e){this.subscribe(this.id,t,e)}ignore(t){this.unsubscribe(this.id,t)}actorFromId(t){return this.service("ActorManager").get(t)}}Actor.register("Actor")},5014:(t,e,n)=>{n.d(e,{I:()=>FocusManager,v:()=>i});class FocusManager extends n(7184).s1{constructor(t){super(t||"FocusManager"),this.sets=[]}}const i=t=>class extends t{constructor(...t){super(...t)}destroy(){super.destroy(),this.blurAll()}hasFocus(t=0){return this.service("FocusManager").sets[t]===this}focus(t=0){var e=this.service("FocusManager"),n=e.sets[t];n!==this&&(n&&(e.sets[t]=null,n.onBlur(t)),(e.sets[t]=this).onFocus(t))}blur(t=0){var e=this.service("FocusManager");e.sets[t]===this&&(e.sets[t]=null,this.onBlur(t))}blurAll(){var t=this.service("FocusManager");t&&t.sets.forEach(t=>this.blur(t))}onFocus(t){}onBlur(t){}}},1480:(t,e,n)=>{n.d(e,{$:()=>InputManager,z:()=>KeyDown});var a=n(439),e=n(7184);const i=new Set,r=new Map,s=new Map,o=new Map;function KeyDown(t){return i.has(t)}class InputManager extends e.s1{constructor(t){super(t||"InputManager"),this.listeners=[],this.presses=new Map,this.lastDown={},this.penultimateDown={},document.body.style.touchAction="none",this.addAllListeners(),this.synthesizedModifierKeys=new Map}destroy(){super.destroy(),this.inPointerLock&&document.exitPointerLock(),this.inFullscreen&&document.exitFullscreen(),this.removeAllListeners()}addListener(t,e,n){t.addEventListener(e,n,{passive:!1}),this.listeners.push({element:t,type:e,callback:n})}removeListener(e){var t=this.listeners.filter(t=>t.type!==e);this.listeners.forEach(t=>{t.type===e&&t.element.removeEventListener(t.type,t.callback,{passive:!1})}),this.listeners=t}removeAllListeners(){this.listeners.forEach(t=>t.element.removeEventListener(t.type,t.callback,{passive:!1})),this.listeners=[]}addAllListeners(){this.addListener(document,"contextmenu",t=>t.preventDefault()),this.addListener(window,"resize",t=>this.onResize(t)),this.addListener(window,"focus",t=>this.onFocus(t)),this.addListener(window,"blur",t=>this.onBlur(t)),this.addListener(window,"deviceorientation",t=>this.onOrientation(t)),this.addListener(document,"click",t=>this.onClick(t)),this.addListener(document,"pointerlockchange",t=>this.onPointerLock(t)),this.addListener(document,"pointerdown",t=>this.onPointerDown(t)),this.addListener(document,"pointerup",t=>this.onPointerUp(t)),this.addListener(document,"pointercancel",t=>this.onPointerUp(t)),this.addListener(document,"pointermove",t=>this.onPointerMove(t)),this.addListener(document,"wheel",t=>this.onWheel(t)),this.addListener(document,"keydown",t=>this.onKeyDown(t)),this.addListener(document,"keyup",t=>this.onKeyUp(t))}addChord(e,t=[],n=[]){r.set(e,{down:t,up:n}),t.forEach(t=>{o.has(t)||o.set(t,new Set),o.get(t).add(e)}),n.forEach(t=>{s.has(t)||s.set(t,new Set),s.get(t).add(e)})}onChordDown(t){const e=[],n=[];o.has(t)&&o.get(t).forEach(t=>{this.chordTest(t)&&e.push(t)}),s.has(t)&&s.get(t).forEach(t=>{this.chordTest(t)||n.push(t)}),n.forEach(t=>{KeyDown(t)&&(i.delete(t),this.publish("input",t+"Up"))}),e.forEach(t=>{KeyDown(t)||(i.add(t),this.publish("input",t+"Down"))})}onChordUp(t){const e=[],n=[];o.has(t)&&o.get(t).forEach(t=>{this.chordTest(t)||n.push(t)}),s.has(t)&&s.get(t).forEach(t=>{this.chordTest(t)&&e.push(t)}),n.forEach(t=>{KeyDown(t)&&(i.delete(t),this.publish("input",t+"Up"))}),e.forEach(t=>{KeyDown(t)||(i.add(t),this.publish("input",t+"Down"))})}chordTest(t){t=r.get(t);if(!t)return!1;var e=t.down,t=t.up;let n=!0;return e.forEach(t=>{n&=KeyDown(t)}),t.forEach(t=>{n&=!KeyDown(t)}),n}get inFullscreen(){return document.fullscreenElement}get canFullscreen(){return document.documentElement.requestFullscreen}enterFullscreen(){this.inFullscreen||this.canFullscreen&&document.documentElement.requestFullscreen()}exitFullscreen(){this.inFullscreen&&document.exitFullscreen()}get inPointerLock(){return document.pointerLockElement||document.mozPointerLockElement}get canPointerLock(){return document.documentElement.requestPointerLock||document.documentElement.mozRequestPointerLock}modifierKeysFrom(t){var{altKey:t,ctrlKey:e,metaKey:n,shiftKey:i}=t;return{altKey:!(!t&&!this.synthesizedModifierKeys.get("altKey")),ctrlKey:!(!e&&!this.synthesizedModifierKeys.get("ctrlKey")),metaKey:!(!n&&!this.synthesizedModifierKeys.get("metaKey")),shiftKey:!(!i&&!this.synthesizedModifierKeys.get("shiftKey"))}}setModifierKeys(t){for(var e in t)this.synthesizedModifierKeys.set(e,!!t[e])}modifierEqual(t,e){return!!t.altKey==!!e.altKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.metaKey==!!e.metaKey&&!!t.shiftKey==!!e.shiftKey}enterPointerLock(){this.inPointerLock||this.canPointerLock&&(document.documentElement.requestPointerLock=this.canPointerLock,document.documentElement.requestPointerLock())}exitPointerLock(){this.inPointerLock&&document.exitPointerLock()}onPointerLock(t){this.publish("input","pointerLock",this.inPointerLock)}onResize(t){this.publish("input","beforeResize"),this.future(500).futureResize()}futureResize(){this.publish("input","resize",[window.innerWidth,window.innerHeight])}onFocus(t){this.publish("input","focus")}onBlur(t){this.publish("input","blur")}onKeyDown(t){var e=t.key,n=this.modifierKeysFrom(t);i.add(e),t.repeat?(this.publish("input",e+"Repeat",{key:e,shift:n.shiftKey,alt:n.altKey,ctrl:n.ctrlKey,meta:n.metaKey,...n}),this.publish("input","keyRepeat",{key:e,shift:n.shiftKey,alt:n.altKey,ctrl:n.ctrlKey,meta:n.metaKey,...n})):(this.publish("input",e+"Down",{key:e,shift:n.shiftKey,alt:n.altKey,ctrl:n.ctrlKey,meta:n.metaKey,...n}),this.publish("input","keyDown",{key:e,shift:n.shiftKey,alt:n.altKey,ctrl:n.ctrlKey,meta:n.metaKey,...n}),this.onChordDown(e))}onKeyUp(t){var e=t.key,t=this.modifierKeysFrom(t);KeyDown(e)&&(this.publish("input",e+"Up",{key:e,shift:t.shiftKey,alt:t.altKey,ctrl:t.ctrlKey,meta:t.metaKey,...t}),this.publish("input","keyUp",{key:e,shift:t.shiftKey,alt:t.altKey,ctrl:t.ctrlKey,meta:t.metaKey,modKeys:t}),i.delete(e),this.onChordUp(e))}onClick(t){var e=this.modifierKeysFrom(t);window.focus(),this.publish("input","click",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...e,xy:[t.clientX,t.clientY]})}onPointerDown(t){var e=this.modifierKeysFrom(t);this.presses.set(t.pointerId,{id:t.pointerId,time:t.timeStamp,start:[t.clientX,t.clientY],...e,xy:[t.clientX,t.clientY]}),this.publish("input","pointerDown",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...e,xy:[t.clientX,t.clientY]}),t.button===this.lastDown.button&&t.timeStamp-this.lastDown.time<300&&this.modifierEqual(t,this.lastDown)&&(t.button===this.penultimateDown.button&&t.timeStamp-this.penultimateDown.time<600?this.publish("input","tripleDown",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...e,xy:[t.clientX,t.clientY]}):this.publish("input","doubleDown",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...e,xy:[t.clientX,t.clientY]})),this.penultimateDown=this.lastDown,this.lastDown={id:t.pointerId,button:t.button,buttons:t.buttons,...e,time:t.timeStamp},this.zoomStart()}onPointerUp(t){var e,n,i,r,s=this.presses.get(t.pointerId),o=this.modifierKeysFrom(t);s&&(s.xy=[t.clientX,t.clientY],e=t.timeStamp-s.time,n=t.clientX-s.start[0],s=t.clientY-s.start[1],i=Math.abs(n),r=Math.abs(s),e<300&&i<10&&r<10&&this.publish("input","tap",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...o,xy:[t.clientX,t.clientY]}),e<300&&50<i&&this.publish("input","swipeX",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,distance:n,...o}),e<300)&&50<r&&this.publish("input","swipeY",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,distance:s,...o}),this.presses.delete(t.pointerId),this.publish("input","pointerUp",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...o,xy:[t.clientX,t.clientY]}),this.zoomEnd()}onPointerMove(t){var e,n,i=this.presses.get(t.pointerId),r=this.modifierKeysFrom(t);(!i||(i.xy=[t.clientX,t.clientY],e=t.timeStamp-i.time,n=t.clientX-i.start[0],i=t.clientY-i.start[1],n=Math.abs(n),i=Math.abs(i),300<e)||10<n||10<i)&&(this.publish("input","pointerMove",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...r,xy:[t.clientX,t.clientY]}),this.publish("input","pointerDelta",{id:t.pointerId,type:t.pointerType,button:t.button,buttons:t.buttons,...r,xy:[t.movementX,t.movementY]})),this.zoomUpdate()}zoomStart(){var t,e;2===this.presses.size&&(e=(t=Array.from(this.presses.values()))[0],t=t[1],e=(0,a.Jk)((0,a.Pf)(e.xy,t.xy),.5),this.publish("input","zoomStart",{mid:e,zoom:1,dial:0}))}zoomEnd(){1===this.presses.size&&this.publish("input","zoomEnd")}zoomUpdate(){if(!(this.presses.size<2)){var n=Array.from(this.presses.values()),i=n[0],n=n[1],r=(0,a.Jk)((0,a.Pf)(i.xy,n.xy),.5),s=(0,a.Ar)(n.start,i.start),n=(0,a.Ar)(n.xy,i.xy),i=(0,a.vr)(s),o=(0,a.vr)(n);let t=1;0<i&&(t=o/i);o=Math.atan2(s[0],s[1]);let e=(Math.atan2(n[0],n[1])-o+a.gc)%a.gc;e>Math.PI&&(e-=a.gc),this.publish("input","zoomUpdate",{mid:r,zoom:t,dial:e})}}onWheel(t){var e=this.modifierKeysFrom(t),n=(t.preventDefault(),t.deltaY);this.publish("input","wheel",{deltaY:n,...e,xy:[t.clientX,t.clientY]})}onOrientation(t){var e=t.alpha,n=t.beta,t=(t.gamma,(0,a.vF)(n)),n=(0,a.vF)(e);this.publish("input","orientation",{pitch:t,yaw:n})}}},7469:(t,e,n)=>{n.d(e,{CD:()=>s,Di:()=>h,Qz:()=>l,UZ:()=>f,VL:()=>u,ZA:()=>a,fC:()=>c,lV:()=>p,nl:()=>o,vq:()=>m,zL:()=>d});var i=n(8011),r=(n(4200),n(439));i.Constants.WC_MIXIN_REGISTRY=[],i.Constants.WC_MIXIN_USAGE=[];const s=t=>new MixinFactory(t),o=t=>i.Constants.WC_MIXIN_REGISTRY.push(t);class MixinFactory{constructor(t){this.superclass=t}with(...t){return i.Constants.WC_MIXIN_USAGE.push(t),t.reduce((t,e)=>e(t),this.superclass)}}const a=t=>class extends t{init(t){super.init(t),this.listen("scaleSet",this.localChanged),this.listen("rotationSet",this.localChanged),this.listen("translationSet",this.localChanged)}localChanged(){this.$local=null,this.say("localChanged"),this.globalChanged()}globalChanged(){this.$global=null,this.say("globalChanged"),this.children&&this.children.forEach(t=>t.globalChanged())}get local(){return this.$local||(this.$local=(0,r.FJ)(this.scale,this.rotation,this.translation)),[...this.$local]}get global(){return this.$global||(this.parent?this.$global=(0,r.kx)(this.local,this.parent.global):this.$global=this.local),[...this.$global]}get translation(){return this._translation?[...this._translation]:(0,r.jk)()}set translation(t){this.set({translation:t})}get rotation(){return this._rotation?[...this._rotation]:(0,r.C8)()}set rotation(t){this.set({rotation:t})}get scale(){return this._scale?[...this._scale]:[1,1,1]}set scale(t){this.set({scale:t})}},c=(o(a),t=>class extends t{constructor(...t){super(...t),this.listenOnce("globalChanged",this.onGlobalChanged)}onGlobalChanged(){this.say("viewGlobalChanged")}get scale(){return this.actor.scale}get translation(){return this.actor.translation}get rotation(){return this.actor.rotation}get local(){return this.actor.local}get global(){return this.actor.global}get lookGlobal(){return this.global}}),l=t=>class extends a(t){init(...t){super.init(...t),this.listen("_scaleTo",this.scaleTo),this.listen("_rotateTo",this.rotateTo),this.listen("_translateTo",this.translateTo),this.listen("_positionTo",this.positionTo)}scaleTo(t){this._scale=t,this.$local=null,this.$global=null,this.say("scaleTo",t)}rotateTo(t){this._rotation=t,this.$local=null,this.$global=null,this.say("rotateTo",t)}translateTo(t){this._translation=t,this.$local=null,this.$global=null,this.say("translateTo",t)}positionTo(t){this._translation=t.v,this._rotation=t.q,this.$local=null,this.$global=null,this.say("rotateTo",t.q),this.say("translateTo",t.v)}moveTo(t){this.translateTo(t)}},h=(o(l),t=>class extends c(t){constructor(...t){super(...t),this.tug=.2,this._scale=this.actor.scale,this._rotation=this.actor.rotation,this._translation=this.actor.translation,this._global=this.actor.global,this.listenOnce("scaleSet",this.onScaleSet),this.listenOnce("rotationSet",this.onRotationSet),this.listenOnce("translationSet",this.onTranslationSet),this.listenOnce("scaleTo",this.onScaleTo),this.listenOnce("rotateTo",this.onRotateTo),this.listenOnce("translateTo",this.onTranslateTo)}set tug(t){this._tug=t}get tug(){return this._tug}set localOffset(t){this._localOffset=t,this._local=null,this._global=null}get localOffset(){return this._localOffset}get scale(){return this._scale}get rotation(){return this._rotation}get translation(){return this._translation}onLocalChanged(){this._local=null,this.onGlobalChanged()}onGlobalChanged(){this._global=null}scaleTo(t,e){this.say("_scaleTo",t,e)}rotateTo(t,e){this.say("_rotateTo",t,e)}translateTo(t,e){this.say("_translateTo",t,e)}positionTo(t,e,n){this.say("_positionTo",{v:t,q:e},n)}onScaleSet(){this._scale=this.actor.scale,this.onLocalChanged()}onRotationSet(){this._rotation=this.actor.rotation,this.onLocalChanged()}onTranslationSet(){this._translation=this.actor.translation,this.onLocalChanged()}onScaleTo(t){this.isScaling=!0}onRotateTo(t){this.isRotating=!0}onTranslateTo(t){this.isTranslating=!0}get local(){return this._local||(this._localOffset?this._local=(0,r.kx)(this._localOffset,(0,r.FJ)(this._scale,this._rotation,this._translation)):this._local=(0,r.FJ)(this._scale,this._rotation,this._translation)),this._local}get global(){return this._global||(this.parent&&this.parent.global?this._global=(0,r.kx)(this.local,this.parent.global):this._global=this.local),this._global}update(t,e){super.update(t,e);let n=this.tug;e&&(n=Math.min(1,n*e/15)),this.isScaling&&((0,r.nY)(this._scale,this.actor.scale,1e-4)?(this._scale=this.actor.scale,this.isScaling=!1):this._scale=(0,r.xq)(this._scale,this.actor.scale,n),this.onLocalChanged()),this.isRotating&&((0,r._D)(this._rotation,this.actor.rotation,1e-6)?(this._rotation=this.actor.rotation,this.isRotating=!1):this._rotation=(0,r.zc)(this._rotation,this.actor.rotation,n),this.onLocalChanged()),this.isTranslating&&((0,r.nY)(this._translation,this.actor.translation,1e-4)?(this._translation=this.actor.translation,this.isTranslating=!1):this._translation=(0,r.xq)(this._translation,this.actor.translation,n),this.onLocalChanged()),this._global||(this.say("viewGlobalChanged"),this.children&&this.children.forEach(t=>t.onGlobalChanged()))}}),u=t=>class extends t{constructor(...t){super(...t),this.throttle=100}positionTo(t,e,n){n=n||this.throttle,this._translation=t,this._rotation=e,this.isTranslating=!1,this.isRotating=!1,this.onLocalChanged(),super.positionTo(t,e,n)}scaleTo(t,e){e=e||this.throttle,this._scale=t,this.isScaling=!1,this.onLocalChanged(),super.scaleTo(t,e)}rotateTo(t,e){e=e||this.throttle,this._rotation=t,this.isRotating=!1,this.onLocalChanged(),super.rotateTo(t,e)}translateTo(t,e){e=e||this.throttle,this._translation=t,this.isTranslating=!1,this.onLocalChanged(),super.translateTo(t,e)}},d=t=>class extends l(t){get spin(){return this._spin?[...this._spin]:(0,r.C8)()}get velocity(){return this._velocity?[...this._velocity]:(0,r.jk)()}get tickStep(){return this._tickStep||15}init(...t){super.init(...t),this.future(0).tick(0)}tick(t){(0,r.CF)(this.spin)||this.rotateTo((0,r.d6)((0,r.zc)(this.rotation,(0,r.Lj)(this.rotation,this.spin),t))),(0,r.wM)(this.velocity)||(t=(0,r.gI)(this.velocity,t),t=(0,r.w_)(t,(0,r.CV)(this.rotation)),this.moveTo((0,r.S)(this.translation,t))),this.doomed||this.future(this.tickStep).tick(this.tickStep)}},m=(o(d),t=>class extends h(t){constructor(...t){super(...t),this.spin=this.actor.spin,this.velocity=this.actor.velocity}moveTo(t,e){this.translateTo(t,e)}setVelocity(t,e){this.set({velocity:t},e)}setSpin(t,e){this.set({spin:t},e)}update(t,e){var n;(0,r.CF)(this.spin)||(this._rotation=(0,r.d6)((0,r.zc)(this._rotation,(0,r.Lj)(this._rotation,this.spin),e)),this.onLocalChanged()),(0,r.wM)(this.velocity)||(n=(0,r.gI)(this.velocity,e),n=(0,r.w_)(n,(0,r.CV)(this.rotation)),this._translation=(0,r.S)(this._translation,n),this.onLocalChanged()),super.update(t,e)}}),p=d,f=m},148:(t,e,n)=>{n.d(e,{X:()=>function CachedObject(t,e){if(i.has(t))return i.get(t);e=e();return i.set(t,e),e},n:()=>function ClearObjectCache(){i.forEach(t=>t.destroy()),i.clear()}});const i=new Map},9570:(t,e,n)=>{n.d(e,{rE:()=>Pawn,s_:()=>GetPawn,wh:()=>PawnManager});e=n(7184);let i;class PawnManager extends e.s1{constructor(t){super(t||"PawnManager"),(i=this).pawns=new Map,this.modelService("ActorManager").actors.forEach(t=>this.spawnPawn(t));for(const e of this.pawns.values())e.link();this.subscribe("actor","createActor",this.spawnPawn)}destroy(){new Map(this.pawns).forEach(t=>t.destroy()),i=null,super.destroy()}spawnPawn(t){t.pawn&&new t.pawn(t).link()}add(t){this.pawns.set(t.actor.id,t)}has(t){return this.pawns.has(t)}get(t){return this.pawns.get(t)}delete(t){this.pawns.delete(t.actor.id)}update(t,e){for(const n of this.pawns.values())n.parent||n.fullUpdate(t,e)}}function GetPawn(t){return i.get(t)}class Pawn extends e.sG{constructor(t){super(t),this._sayNext={},this._sayCache={},this._actor=t,i.add(this),this.link(),this.listen("destroyActor",this.destroy),this.listen("parentSet",this.onParent)}link(){this.parent&&this.parent.addChild(this)}get actor(){return this._actor}destroy(){this.doomed=!0,i.delete(this),this.detach()}get parent(){return this.actor.parent&&!this._parent&&(this._parent=GetPawn(this.actor.parent.id)),this._parent}get children(){return this._children}addChild(t){this._children||(this._children=new Set),this._children.add(t)}removeChild(t){this._children&&this._children.delete(t)}onParent(t){t.o&&(this._parent=null,GetPawn(t.o.id).removeChild(this)),this.parent&&this.parent.addChild(this)}say(t,e,n=0){this.time<this._sayNext[t]?this._sayCache[t]={data:e,throttle:n}:(this._sayNext[t]=this.time+n,this._sayCache[t]=null,this.publish(this.actor.id,t,e))}listen(t,e){this.subscribe(this.actor.id,t,e)}listenImmediate(t,e){this.subscribe(this.actor.id,{event:t,handling:"immediate"},e)}ignore(t){this.unsubscribe(this.actor.id,t)}listenOnce(t,e){this.subscribe(this.actor.id,{event:t,handling:"oncePerFrame"},e)}set(t,e=0){this.say("_set",t,e)}preUpdate(t,e){}update(t,e){}postUpdate(t,e){}fullUpdate(e,n){this.preUpdate(e,n),this.update(e,n),this.postUpdate(e,n);for(const r in this._sayCache){var t,i=this._sayCache[r];i&&e>this._sayNext[r]&&({data:i,throttle:t}=i,this._sayNext[r]=e+t,this._sayCache[r]=null,this.publish(this.actor.id,r,i))}this.children&&this.children.forEach(t=>t.fullUpdate(e,n))}}},9551:(t,e,n)=>{n.d(e,{VX:()=>r,XM:()=>PlayerManager,fg:()=>i});n(2982);e=n(7469);class PlayerManager extends n(7184).b${init(t){super.init(t||"PlayerManager"),this.players=new Map,this.subscribe(this.sessionId,"view-join",this.onJoin),this.subscribe(this.sessionId,"view-exit",this.onExit)}onJoin(t){this.players.has(t)&&console.warn("PlayerManager received duplicate view-join for viewId "+t);var e=this.createPlayer({playerId:t});e&&(this.players.set(t,e),this.publish("playerManager","create",e))}createPlayer(t){return null}destroyPlayer(t){this.publish("playerManager","destroy",t),t.destroy()}onExit(t){var e=this.player(t);e&&(this.destroyPlayer(e),this.players.delete(t))}get count(){return this.players.size}player(t){return this.players.get(t)}}PlayerManager.register("PlayerManager");const i=t=>class extends t{get playerId(){return this._playerId}},r=((0,e.nl)(i),t=>class extends t{get isMyPlayerPawn(){let t=this;do{if(t.actor&&t.actor.playerId===t.viewId)return!0}while(t=t.parent);return!1}})},252:(t,e,n)=>{n.d(e,{Tq:()=>i,k6:()=>r,zo:()=>RenderManager});e=n(7184);const i=t=>class extends t{destroy(){super.destroy();var t=this.service("RenderManager");for(const e in t.layers)t.layers[e].has(this)&&t.dirtyLayer(e),t.layers[e].delete(this)}addToLayers(...t){const e=this.service("RenderManager");t.forEach(t=>{e.layers[t]||(e.layers[t]=new Set),e.layers[t].add(this),e.dirtyLayer(t)})}removeFromLayers(...t){const e=this.service("RenderManager");t.forEach(t=>{e.layers[t]&&(e.layers[t].delete(this),0===e.layers[t].size&&delete e.layers[t],e.dirtyLayer(t))})}layers(){var t=[],e=this.service("RenderManager");for(const n in e.layers)e.layers[n].has(this)&&t.push(n);return t}},r=t=>class extends t{};class RenderManager extends e.s1{constructor(t=0,e){super(e),this.registerViewName("RenderManager"),this.layers={}}dirtyLayer(t){}}},7184:(t,e,n)=>{n.d(e,{CP:()=>async function StartWorldcore(t){await Promise.all(t.model.modelServices().map(t=>(t=t.service?t.service:t).asyncStart())),await Promise.all(t.view.viewServices().map(t=>(t=t.service?t.service:t).asyncStart()));t=await i.Session.join(t);return t},D9:()=>ModelRoot,J0:()=>function GetModelService(t){return a.wellKnownModel(t)},Uq:()=>WorldcoreModel,YT:()=>a,b$:()=>ModelService,ci:()=>function GetViewService(t){return h.get(t)},s1:()=>ViewService,sG:()=>WorldcoreView,xS:()=>ViewRoot});var i=n(8011),r=n(2982),s=n(9570),o=n(148);class WorldcoreModel extends i.Model{service(t){return this.wellKnownModel(t)}}WorldcoreModel.register("WorldcoreModel");class ModelRoot extends WorldcoreModel{static modelServices(){return[]}init(){super.init(),this.beWellKnownAs("ModelRoot"),this.services=new Set,this.services.add(r.t.create()),this.constructor.modelServices().forEach(t=>{let e;t.service&&(e=t.options,t=t.service),this.services.add(t.create(e))})}}ModelRoot.register("ModelRoot");class ModelService extends WorldcoreModel{static async asyncStart(){}init(t,e=0){super.init(),(this.name=t)?this.wellKnownModel(t)?console.error("Duplicate service!"):this.beWellKnownAs(t):console.error("All services must have public names!")}}ModelService.register("ModelService");class WorldcoreView extends i.View{service(t){return h.get(t)}modelService(t){return this.wellKnownModel(t)}get time(){return l}get delta(){return l-c}}let a,c=0,l=0;const h=new Map;let u;class ViewRoot extends WorldcoreView{static viewServices(){return[]}constructor(t){super(t),this.model=t,a=this,c=0,l=0,h.clear(),(0,o.n)(),this.constructor.viewServices().forEach(t=>{let e;var n=t.name;t.service&&(e=t.options,t=t.service),new t(e,n)}),u=new s.wh}detach(){[...h.values()].reverse().forEach(t=>t.destroy()),h.clear(),super.detach()}update(e){c=l;const n=(l=e)-c;let i=new Set;u.update(e,n),h.forEach(t=>{i.has(t)||t!==u&&(i.add(t),t.update)&&t.update(e,n)})}}class ViewService extends WorldcoreView{static async asyncStart(){}constructor(t){super(a.model),this.model=a.model,this.registerViewName(t)}registerViewName(t){t?h.has(t)?console.error("Duplicate service!"):h.set(t,this):console.error("All services must have public names!")}destroy(){this.detach(),h.delete(this.name)}}},2419:(t,e,n)=>{n.d(e,{D8:()=>TwoWayMap,Fc:()=>PerlinNoise,Z3:()=>PriorityQueue,gZ:()=>function Shuffle(e){var n=new Array(e);for(let t=0;t<e;t++)n[t]=t;let t=e;for(;t;){var i=Math.floor(Math.random()*t--),r=n[t];n[t]=n[i],n[i]=r}return n}});class PriorityQueue{constructor(t=(t,e)=>t<e){this.items=[],this.comparator=t}get isEmpty(){return 0===this.items.length}get count(){return this.items.length}get top(){return this.items[0]}clear(){this.items.length=0}push(t){let e=this.items.length;for(;0<e&&!this.comparator(this.items[e>>1],t);)this.items[e]=this.items[e>>1],e>>=1;this.items[e]=t}pop(){var t=this.items[0],e=this.items.pop();return 0<this.items.length&&(this.items[0]=e,this.heapify(0)),t}traverse(t){this.items.forEach(t)}heapify(t){let e=t;var n=t<<1,i=1+n;n<this.items.length&&this.comparator(this.items[n],this.items[e])&&(e=n),(e=i<this.items.length&&this.comparator(this.items[i],this.items[e])?i:e)!==t&&(n=this.items[t],this.items[t]=this.items[e],this.items[e]=n,this.heapify(e))}}class PerlinNoise{constructor(){this.generate()}generate(){this.hashTable=this.generateHashTable()}generateHashTable(){var e=[];for(let t=0;t<256;t++)e.push({key:Math.random(),value:t});e.sort((t,e)=>t.key-e.key);var t=e.map(t=>t.value);return t.concat(t)}signedNoise2D(t,e){return this.noise2D(t,e)-.5}noise2D(t,e){var n=this.hashTable,i=Math.floor(t),r=Math.floor(e),t=t-i,e=e-r,s=this.fade(t),o=this.fade(e),i=255&i,r=255&r,a=n[n[i]+r],c=n[n[1+i]+r],l=n[n[i]+r+1],n=n[n[1+i]+r+1],i=this.grad(a,t,e),r=this.grad(c,t-1,e),a=this.grad(l,t,e-1),c=this.grad(n,t-1,e-1),l=this.lerp(i,r,s),n=this.lerp(a,c,s);return(this.lerp(l,n,o)+1)/2}lerp(t,e,n){return t+n*(e-t)}fade(t){return t*t*t*(t*(6*t-15)+10)}grad(t,e,n){switch(3&t){case 0:return e+n;case 1:return e-n;case 2:return-e+n;case 3:return-e-n;default:return 0}}}class TwoWayMap{constructor(t=new Map){this.map=t,this.rev=new Map,this.map.forEach((t,e)=>{this.rev.set(t,e)})}clear(){this.map.clear(),this.rev.clear()}set(t,e){this.map.set(t,e),this.rev.set(e,t)}delete(t){var e;this.map.has(t)&&(e=this.map.get(t),this.map.delete(t),this.rev.delete(e))}get(t){return this.map.get(t)}revGet(t){return this.rev.get(t)}has(t){return this.map.has(t)}revHas(t){return this.rev.has(t)}forEach(t){this.map.forEach(t)}revForEach(t){this.rev.forEach(t)}}},439:(t,e,n)=>{n.d(e,{$2:()=>function v3_multiply(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2]]},A$:()=>function q_euler(t,e,n){t*=.5,e*=.5,n*=.5;var i=Math.sin(t),t=Math.cos(t),r=Math.sin(e),e=Math.cos(e),s=Math.sin(n),n=Math.cos(n);return[i*e*n-t*r*s,t*r*n+i*e*s,t*e*s-i*r*n,t*e*n+i*r*s]},A6:()=>function v2_zero(){return[0,0]},AB:()=>function m4_zero(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},AM:()=>function v2_angle(t,e){return Math.acos(Math.min(1,Math.max(-1,v2_dot(v2_normalize(t),v2_normalize(e)))))},Ar:()=>function v2_sub(t,e){return[t[0]-e[0],t[1]-e[1]]},BU:()=>function v2_sqrMag(t){return t[0]*t[0]+t[1]*t[1]},Bc:()=>function v3_inverse(t){return[1/t[0],1/t[1],1/t[2]]},C8:()=>q_identity,CF:()=>function q_isZero(t){return 0===t[0]&&0===t[1]&&0===t[2]},CV:()=>function m4_rotationQ(t){var e=t[0],n=t[1],i=t[2],t=t[3],r=e+e,s=n+n,o=i+i,e=e*r,a=n*r,n=n*s,c=i*r,l=i*s,i=i*o,r=t*r,s=t*s,t=t*o;return[1-n-i,a+t,c-s,0,a-t,1-e-i,l+r,0,c+s,l-r,1-e-n,0,0,0,0,1]},Cq:()=>q_axisAngle,DF:()=>function m4_translation(t){return[1,0,0,0,0,1,0,0,0,0,1,0,t[0],t[1],t[2],1]},DP:()=>function v2_floor(t){return[Math.floor(t[0]),Math.floor(t[1])]},E4:()=>function v3_angle(t,e){return Math.acos(Math.min(1,Math.max(-1,v3_dot(v3_normalize(t),v3_normalize(e)))))},EZ:()=>function v2_ceil(t){return[Math.ceil(t[0]),Math.ceil(t[1])]},FJ:()=>function m4_scaleRotationTranslation(t,e,n){var i=e[0],r=e[1],s=e[2],e=e[3],o=i+i,a=r+r,c=s+s,l=i*o,h=i*a,i=i*c,u=r*a,r=r*c,s=s*c,o=e*o,a=e*a,e=e*c;let d=1,m=1,p=1;p=t instanceof Array?(d=t[0],m=t[1],t[2]):(d=t,m=t,t);return[(1-(u+s))*d,(h+e)*d,(i-a)*d,0,(h-e)*m,(1-(l+s))*m,(r+o)*m,0,(i+a)*p,(r-o)*p,(1-(l+u))*p,0,n[0],n[1],n[2],1]},FO:()=>r,JE:()=>q_dot,JU:()=>function v3_rotateX(t,e){var n=Math.sin(e),e=Math.cos(e);return[t[0],e*t[1]-n*t[2],n*t[1]+e*t[2]]},Jk:()=>function v2_scale(t,e){return[t[0]*e,t[1]*e]},Jo:()=>function v3_random(){var t=Math.random(),e=Math.random(),n=2*Math.sqrt(t-t*t),e=s*e;return[n*Math.cos(e),n*Math.sin(e),1-2*t]},KE:()=>function v2_min(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]},KM:()=>function v2_rotate(t,e){var n=Math.sin(e),e=Math.cos(e);return[e*t[0]-n*t[1],n*t[0]+e*t[1]]},Kc:()=>q_conjugate,LV:()=>function m4_rotationZ(t){var e=Math.sin(t),t=Math.cos(t);return[t,e,0,0,-e,t,0,0,0,0,1,0,0,0,0,1]},Lj:()=>function q_multiply(t,e){var n=t[0],i=t[1],r=t[2],t=t[3],s=e[0],o=e[1],a=e[2],e=e[3];return[s*t+o*r-a*i+e*n,o*t-s*r+e*i+a*n,a*t+e*r+s*i-o*n,e*t-a*r-o*i-s*n]},MO:()=>function m4_rotationX(t){var e=Math.sin(t),t=Math.cos(t);return[1,0,0,0,0,t,e,0,0,-e,t,0,0,0,0,1]},Mi:()=>function v3_rotateZ(t,e){var n=Math.sin(e),e=Math.cos(e);return[e*t[0]-n*t[1],n*t[0]+e*t[1],t[2]]},Nf:()=>function v2_abs(t){return[Math.abs(t[0]),Math.abs(t[1])]},P_:()=>v3_normalize,Pf:()=>function v2_add(t,e){return[t[0]+e[0],t[1]+e[1]]},Q0:()=>function v3_abs(t){return[Math.abs(t[0]),Math.v3_abs(t[1]),Math.abs(t[2])]},S:()=>v3_add,Sn:()=>function m4_perspective(t,e,n,i){var t=1/Math.tan(t/2),r=1/(n-i);return[t/e,0,0,0,0,t,0,0,0,0,(i+n)*r,-1,0,0,2*i*n*r,0]},TM:()=>function toDeg(t){return t*r},UJ:()=>function q_roll(t){var e=t[0],n=t[1],i=t[2],t=t[3];return Math.asin(2*e*n+2*i*t)},Um:()=>function gaussian(e,n=1,t=1){var t=2*t*t,i=1/Math.sqrt(Math.PI*t),r=1/t,s=[i];for(let t=1;t<e;t++){var o=n*t;s.push(i*Math.E**(-r*o*o))}return s},WA:()=>function v2_manhattan(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])},Wu:()=>function v3_rotate(t,e){var n=e[0],i=e[1],r=e[2],e=e[3],s=t[0],o=t[1],t=t[2];var a=i*t-r*o,c=r*s-n*t,l=n*o-i*s,h=i*l-r*c,r=r*a-n*l,n=n*c-i*a,i=2*e;return a*=i,c*=i,l*=i,h*=2,r*=2,n*=2,[s+a+h,o+c+r,t+l+n]},XD:()=>function v3_manhattan(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2])},YR:()=>function rayTriangleIntersect(t,e,n){var i=n[0],r=n[1],n=n[2],r=v3_sub(r,i),n=v3_sub(n,i),s=v3_cross(e,n),o=v3_dot(r,s);if(-1e-5<o&&o<1e-5)return null;o=1/o,i=v3_sub(t,i),s=o*v3_dot(i,s);if(s<0||1<s)return null;i=v3_cross(i,r),r=o*v3_dot(e,i);if(r<0||1<s+r)return null;s=o*v3_dot(n,i);return s<1e-5||1/1e-5<s?null:v3_add(t,v3_scale(e,s))},Z1:()=>i,ZU:()=>function m4_getRotation(t){var e=t[0]+t[5]+t[10];let n=0;var i=[0,0,0,0];0<e?(n=2*Math.sqrt(e+1),i[3]=.25*n,i[0]=(t[6]-t[9])/n,i[1]=(t[8]-t[2])/n,i[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),i[3]=(t[6]-t[9])/n,i[0]=.25*n,i[1]=(t[1]+t[4])/n,i[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),i[3]=(t[8]-t[2])/n,i[0]=(t[1]+t[4])/n,i[1]=.25*n,i[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),i[3]=(t[1]-t[4])/n,i[0]=(t[8]+t[2])/n,i[1]=(t[6]+t[9])/n,i[2]=.25*n);return i},ZV:()=>function v3_floor(t){return[Math.floor(t[0]),Math.floor(t[1]),Math.floor(t[2])]},_2:()=>function v3_max(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1]),Math.max(t[2],e[2])]},_D:()=>function q_equals(t,e,n=0){return n?1<=Math.abs(q_dot(t,e))+n:t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},aI:()=>v3_sub,ac:()=>function m4_rotationY(t){var e=Math.sin(t),t=Math.cos(t);return[t,0,-e,0,0,1,0,0,e,0,t,0,0,0,0,1]},d6:()=>function q_normalize(t){var e=1/q_magnitude(t);return[t[0]*e,t[1]*e,t[2]*e,t[3]*e]},eD:()=>function v2_equals(t,e,n=0){return n?n>Math.abs(t[0]-e[0])&&n>Math.abs(t[1]-e[1]):t[0]===e[0]&&t[1]===e[1]},eJ:()=>function m4_getTranslation(t){return[t[12],t[13],t[14]]},eT:()=>function q_lookAt(t,e,n){var i=v3_dot(t,n);if(Math.abs(i+1)<1e-5)return q_axisAngle(e,Math.PI);if(Math.abs(i-1)<1e-5)return[0,0,0,1];e=Math.acos(i),i=v3_normalize(v3_cross(t,n));return q_axisAngle(i,e)},eq:()=>function v2_multiply(t,e){return[t[0]*e[0],t[1]*e[1]]},er:()=>function m2_zero(){return[0,0,0,0]},g8:()=>function v3_sqrMag(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},gI:()=>v3_scale,gc:()=>s,gg:()=>function q_pitch(t){var e=t[0],n=t[1],i=t[2],t=t[3];return Math.atan2(2*e*t-2*n*i,1-2*e*e-2*i*i)},gy:()=>function v3_ceil(t){return[Math.ceil(t[0]),Math.v3_ceil(t[1]),Math.ceil(t[2])]},ho:()=>function q_yaw(t){var e=t[0],n=t[1],i=t[2],t=t[3];return Math.atan2(2*n*t-2*e*i,1-2*n*n-2*i*i)},iO:()=>function v3_min(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.min(t[2],e[2])]},id:()=>function m4_identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},jk:()=>function v3_zero(){return[0,0,0]},jy:()=>function m2_identity(){return[1,0,0,1]},kc:()=>q_conjugate,kx:()=>function m4_multiply(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],o=t[4],a=t[5],c=t[6],l=t[7],h=t[8],u=t[9],d=t[10],m=t[11],p=t[12],f=t[13],y=t[14],t=t[15],b=e[0],v=e[1],g=e[2],Z=e[3],w=e[4],X=e[5],L=e[6],x=e[7],k=e[8],G=e[9],S=e[10],W=e[11],T=e[12],C=e[13],M=e[14],e=e[15];return[n*b+i*w+r*k+s*T,n*v+i*X+r*G+s*C,n*g+i*L+r*S+s*M,n*Z+i*x+r*W+s*e,o*b+a*w+c*k+l*T,o*v+a*X+c*G+l*C,o*g+a*L+c*S+l*M,o*Z+a*x+c*W+l*e,h*b+u*w+d*k+m*T,h*v+u*X+d*G+m*C,h*g+u*L+d*S+m*M,h*Z+u*x+d*W+m*e,p*b+f*w+y*k+t*T,p*v+f*X+y*G+t*C,p*g+f*L+y*S+t*M,p*Z+f*x+y*W+t*e]},lQ:()=>function v2_transform(t,e){var n=t[0],t=t[1];return[e[0]*n+e[2]*t,e[1]*n+e[3]*t]},lR:()=>function m4_scale(t){if(t instanceof Array)return[t[0],0,0,0,0,t[1],0,0,0,0,t[2],0,0,0,0,1];return[t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1]},lZ:()=>function v3_rotateY(t,e){var n=Math.sin(e),e=Math.cos(e);return[n*t[2]+e*t[0],t[1],e*t[2]-n*t[0]]},m$:()=>function m2_rotation(t){var e=Math.sin(t),t=Math.cos(t);return[t,-e,e,t]},nY:()=>function v3_equals(t,e,n=0){return n?n>Math.abs(t[0]-e[0])&&n>Math.abs(t[1]-e[1])&&n>Math.abs(t[2]-e[2]):t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},oN:()=>v3_magnitude,oy:()=>function v2_max(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]},pt:()=>function m4_toNormal4(t){var e=t[0],n=t[1],i=t[2],r=t[4],s=t[5],o=t[6],a=t[8],c=t[9],t=t[10],l=s*t-c*o,h=n*t-c*i,u=n*o-s*i,d=r*t-a*o,t=e*t-a*i,o=e*o-r*i,m=r*c-a*s,c=e*c-a*n,a=e*s-r*n,s=e*l+n*-d+i*m;return[l/s,-d/s,m/s,0,-h/s,t/s,-c/s,0,u/s,-o/s,a/s,0,0,0,0,1]},qT:()=>function v2_inverse(t){return[1/t[0],1/t[1]]},qf:()=>q_magnitude,sC:()=>v3_cross,s_:()=>function v3_divide(t,e){return[t[0]/e[0],t[1]/e[1],t[2]/e[2]]},sv:()=>function m4_determinant(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],h=t[9],u=t[10],d=t[11],m=t[12],p=t[13],f=t[14],t=t[15],y=e*o-n*s,b=e*a-i*s,e=e*c-r*s,s=n*a-i*o,n=n*c-r*o,o=i*c-r*a,i=l*p-h*m,c=l*f-u*m,r=l*t-d*m,a=h*f-u*p,l=h*t-d*p,m=u*t-d*f;return y*m-b*l+e*a+s*r-n*c+o*i},tG:()=>function clampRad(t){for(;t<0;)t+=s;return t%s},uq:()=>v2_normalize,vF:()=>function toRad(t){return t*i},vU:()=>function v2_divide(t,e){return[t[0]/e[0],t[1]/e[1]]},vr:()=>v2_magnitude,wH:()=>v3_dot,wM:()=>function v3_isZero(t){return 0===t[0]&&0===t[1]&&0===t[2]},w_:()=>function v3_transform(t,e){var n=t[0],i=t[1],t=t[2],r=e[3]*n+e[7]*i+e[11]*t+e[15];return[(e[0]*n+e[4]*i+e[8]*t+e[12])/r,(e[1]*n+e[5]*i+e[9]*t+e[13])/r,(e[2]*n+e[6]*i+e[10]*t+e[14])/r]},xq:()=>function v3_lerp(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n,t[2]+(e[2]-t[2])*n]},xw:()=>v2_dot,yF:()=>function sphericalRandom(){var t=Math.random(),e=Math.random(),n=2*Math.sqrt(t-t*t),e=s*e;return[n*Math.cos(e),n*Math.sin(e),1-2*t]},yK:()=>function v2_lerp(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]},yW:()=>function m4_invert(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],h=t[9],u=t[10],d=t[11],m=t[12],p=t[13],f=t[14],t=t[15],y=e*o-n*s,b=e*a-i*s,v=e*c-r*s,g=n*a-i*o,Z=n*c-r*o,w=i*c-r*a,X=l*p-h*m,L=l*f-u*m,x=l*t-d*m,k=h*f-u*p,G=h*t-d*p,S=u*t-d*f,W=y*S-b*G+v*k+g*x-Z*L+w*X;return[(o*S-a*G+c*k)/W,(i*G-n*S-r*k)/W,(p*w-f*Z+t*g)/W,(u*Z-h*w-d*g)/W,(a*x-s*S-c*L)/W,(e*S-i*x+r*L)/W,(f*v-m*w-t*b)/W,(l*w-u*v+d*b)/W,(s*G-o*x+c*X)/W,(n*x-e*G-r*X)/W,(m*Z-p*v+t*y)/W,(h*v-l*Z-d*y)/W,(o*L-s*k-a*X)/W,(e*k-n*L+i*X)/W,(p*b-m*g-f*y)/W,(l*g-h*b+u*y)/W]},yf:()=>function m4_rotation(t,e){var t=v3_normalize(t),n=Math.sin(e),e=Math.cos(e),i=1-e;return[t[0]*t[0]*i+e,t[1]*t[0]*i+t[2]*n,t[2]*t[0]*i-t[1]*n,0,t[0]*t[1]*i-t[2]*n,t[1]*t[1]*i+e,t[2]*t[1]*i+t[0]*n,0,t[0]*t[2]*i+t[1]*n,t[1]*t[2]*i-t[0]*n,t[2]*t[2]*i+e,0,0,0,0,1]},yp:()=>function v2_random(){var t=2*Math.random()*Math.PI;return[Math.cos(t),Math.sin(t)]},zC:()=>function m4_transpose(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},zE:()=>function v2_isZero(t){return 0===t[0]&&0===t[1]},zc:()=>function q_slerp(t,e,n){var i=t[0],r=t[1],s=t[2],t=t[3];let o=e[0],a=e[1],c=e[2],l=e[3],h,u,d,m,p;(u=i*o+r*a+s*c+t*l)<0&&(u=-u,o=-o,a=-a,c=-c,l=-l);p=1e-5<1-u?(h=Math.acos(u),d=Math.sin(h),m=Math.sin((1-n)*h)/d,Math.sin(n*h)/d):(m=1-n,n);e=m*i+p*o,n=m*r+p*a,i=m*s+p*c,r=m*t+p*l;return[e,n,i,r]}});const i=Math.PI/180,r=1/i,s=2*Math.PI;function v2_magnitude(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function v2_normalize(t){var e=1/v2_magnitude(t);return[t[0]*e,t[1]*e]}function v2_dot(t,e){return t[0]*e[0]+t[1]*e[1]}function v3_magnitude(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function v3_normalize(t){var e=1/v3_magnitude(t);return[t[0]*e,t[1]*e,t[2]*e]}function v3_scale(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function v3_add(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}function v3_sub(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function v3_dot(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function v3_cross(t,e){var n=t[0],i=t[1],t=t[2],r=e[0],s=e[1],e=e[2];return[i*e-t*s,t*r-n*e,n*s-i*r]}function q_identity(){return[0,0,0,1]}function q_magnitude(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3])}function q_conjugate(t){return[-t[0],-t[1],-t[2],t[3]]}function q_axisAngle(t,e){var e=.5*e,n=Math.sin(e),e=Math.cos(e);return[n*t[0],n*t[1],n*t[2],e]}function q_dot(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}},2744:(t,e,n)=>{n.d(e,{M6:()=>function IsLoaded(t){t=r.get(t);return t&&t.isLoaded},dO:()=>function LoadFont(t,e){let n;{var i;r.has(t)?n=r.get(t):(i="font"+s++,n={name:i,element:new FontFace(i,"url("+t+")"),isLoaded:!1,callbacks:[]},r.set(t,n),n.element.load().then(()=>{document.fonts.add(n.element),n.isLoaded=!0,n.callbacks.forEach(t=>t()),n.callbacks=[]},()=>console.log("Font "+t+" not found!")))}e&&!n.isLoaded&&n.callbacks.push(e);return n.name},r6:()=>function LoadImage(t,e){let n;if(r.has(t))return n=r.get(t),e&&!n.isLoaded?(n.callbacks.push(e),null):n.element;n={element:new Image,isLoaded:!1,callbacks:[]},r.set(t,n),n.element.onload=()=>{n.isLoaded=!0,n.callbacks.forEach(t=>t(n.element)),n.callbacks=[]},n.element.onerror=()=>console.log("Image "+t+" not found!"),n.element.src=t,e&&!n.isLoaded&&n.callbacks.push(e);return null}});const r=new Map;let s=0}}]);